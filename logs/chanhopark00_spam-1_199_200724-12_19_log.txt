Downloading: "https://download.pytorch.org/models/vgg16-397923af.pth" to /home/nsml/.cache/torch/checkpoints/vgg16-397923af.pth

  0%|          | 0.00/528M [00:00<?, ?B/s]
  2%|▏         | 10.0M/528M [00:00<00:05, 105MB/s]
  4%|▍         | 20.2M/528M [00:00<00:05, 106MB/s]
  5%|▌         | 26.4M/528M [00:00<00:05, 88.8MB/s]
  7%|▋         | 36.4M/528M [00:00<00:05, 93.0MB/s]
  9%|▉         | 46.4M/528M [00:00<00:05, 96.3MB/s]
 11%|█         | 55.8M/528M [00:00<00:05, 96.6MB/s]
 12%|█▏        | 64.0M/528M [00:00<00:06, 74.8MB/s]
 14%|█▍        | 73.0M/528M [00:00<00:05, 79.6MB/s]
 16%|█▌        | 83.0M/528M [00:00<00:05, 85.7MB/s]
 18%|█▊        | 93.0M/528M [00:01<00:05, 90.7MB/s]
 20%|█▉        | 103M/528M [00:01<00:04, 94.6MB/s] 
 21%|██▏       | 113M/528M [00:01<00:04, 97.8MB/s]
 23%|██▎       | 123M/528M [00:01<00:04, 95.6MB/s]
 25%|██▍       | 132M/528M [00:01<00:04, 88.6MB/s]
 27%|██▋       | 141M/528M [00:01<00:04, 87.7MB/s]
 28%|██▊       | 149M/528M [00:01<00:04, 85.6MB/s]
 30%|██▉       | 158M/528M [00:01<00:04, 86.0MB/s]
 32%|███▏      | 168M/528M [00:01<00:04, 90.9MB/s]
 33%|███▎      | 176M/528M [00:02<00:04, 84.1MB/s]
 35%|███▍      | 185M/528M [00:02<00:04, 83.6MB/s]
 37%|███▋      | 193M/528M [00:02<00:04, 85.2MB/s]
 39%|███▊      | 203M/528M [00:02<00:03, 90.9MB/s]
 40%|████      | 212M/528M [00:02<00:03, 88.3MB/s]
 42%|████▏     | 222M/528M [00:02<00:03, 91.6MB/s]
 44%|████▎     | 231M/528M [00:02<00:03, 90.5MB/s]
 46%|████▌     | 241M/528M [00:02<00:03, 94.9MB/s]
 48%|████▊     | 251M/528M [00:02<00:02, 98.0MB/s]
 49%|████▉     | 261M/528M [00:03<00:03, 90.0MB/s]
 51%|█████     | 269M/528M [00:03<00:03, 89.3MB/s]
 53%|█████▎    | 279M/528M [00:03<00:02, 93.7MB/s]
 55%|█████▍    | 290M/528M [00:03<00:02, 97.5MB/s]
 57%|█████▋    | 300M/528M [00:03<00:02, 98.9MB/s]
 59%|█████▉    | 310M/528M [00:03<00:02, 102MB/s] 
 61%|██████    | 320M/528M [00:03<00:02, 101MB/s]
 62%|██████▏   | 330M/528M [00:03<00:02, 97.4MB/s]
 65%|██████▍   | 340M/528M [00:03<00:01, 102MB/s] 
 66%|██████▋   | 351M/528M [00:03<00:01, 104MB/s]
 68%|██████▊   | 361M/528M [00:04<00:01, 104MB/s]
 70%|███████   | 371M/528M [00:04<00:01, 104MB/s]
 72%|███████▏  | 381M/528M [00:04<00:01, 98.0MB/s]
 74%|███████▍  | 390M/528M [00:04<00:01, 96.9MB/s]
 76%|███████▌  | 400M/528M [00:04<00:01, 99.2MB/s]
 78%|███████▊  | 410M/528M [00:04<00:01, 100MB/s] 
 80%|███████▉  | 420M/528M [00:04<00:01, 99.8MB/s]
 81%|████████▏ | 430M/528M [00:04<00:01, 102MB/s] 
 83%|████████▎ | 440M/528M [00:04<00:00, 104MB/s]
 85%|████████▌ | 451M/528M [00:04<00:00, 106MB/s]
 87%|████████▋ | 461M/528M [00:05<00:00, 106MB/s]
 89%|████████▉ | 471M/528M [00:05<00:00, 106MB/s]
 91%|█████████ | 481M/528M [00:05<00:00, 105MB/s]
 93%|█████████▎| 491M/528M [00:05<00:00, 101MB/s]
 95%|█████████▍| 501M/528M [00:05<00:00, 94.8MB/s]
 97%|█████████▋| 510M/528M [00:05<00:00, 84.1MB/s]
 98%|█████████▊| 518M/528M [00:05<00:00, 77.1MB/s]
100%|██████████| 528M/528M [00:05<00:00, 94.0MB/s]
/opt/conda/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1221: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
VGG16 Loaded!
{'batch_size': 64,
 'class_ratio': [0.3, 0.2, 0.2, 0.3],
 'epoch': [3, 1],
 'gamma': 0.1,
 'learning_rate': 0.0001,
 'loss_cls_weight': tensor([1., 1., 1., 1.]),
 'optimizer': 'Adamax',
 'step_size': 10,
 'transforms': [1,
                Compose(
    ColorJitter(brightness=None, contrast=None, saturation=[0.95, 1.05], hue=[-0.05, 0.05])
    RandomHorizontalFlip(p=0.5)
    RandomRotation(degrees=(-20, 20), resample=2, expand=False)
    ToTensor()
    Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])
)],
 'weight_decay': 0}
Dataloader constructed!
Epoch: 0, batch loss: 0.13325 Loss Sum: 68.78595, accuracy : 0.89800, val loss: 4.19771, val accuracy: 0.91954
Final : 0.9364790124218592 [('val/VGG16/monotone/f1-score', 0.9481481481481482), ('val/VGG16/screenshot/f1-score', 0.9200779727095517), ('val/VGG16/unknown/f1-score', 0.9414414414414415)]
Epoch: 1, batch loss: 0.10042 Loss Sum: 37.64540, accuracy : 0.94736, val loss: 7.05263, val accuracy: 0.88276
Final : 0.930679468424372 [('val/VGG16/monotone/f1-score', 0.9552238805970149), ('val/VGG16/screenshot/f1-score', 0.9271028037383177), ('val/VGG16/unknown/f1-score', 0.9102639296187683)]
Epoch: 2, batch loss: 0.10392 Loss Sum: 25.32940, accuracy : 0.96549, val loss: 5.65087, val accuracy: 0.90651
Final : 0.9401977527639288 [('val/VGG16/monotone/f1-score', 0.9516728624535317), ('val/VGG16/screenshot/f1-score', 0.9384615384615383), ('val/VGG16/unknown/f1-score', 0.9305794606999427)]
Epoch: 3, batch loss: 0.01552 Loss Sum: 18.48501, accuracy : 0.97456, val loss: 6.32730, val accuracy: 0.91724
Final : 0.9518341146745389 [('val/VGG16/monotone/f1-score', 0.9769230769230769), ('val/VGG16/screenshot/f1-score', 0.9404990403071017), ('val/VGG16/unknown/f1-score', 0.9385665529010238)]
---train finished---
Trying to save to /tmp/tmpn2brrcfv/model
Too long checkpoint name: VGG16_64_[0.3, 0.2, 0.2, 0.3]_[3, 1]_1.0_0.01_[1.0, 1.0, 1.0, 1.0]_Adamax_10_1_0 not saved
Done
VGG16 Loaded!
{'batch_size': 64,
 'class_ratio': [0.3, 0.2, 0.2, 0.3],
 'epoch': [3, 1],
 'gamma': 0.1,
 'learning_rate': 0.0001,
 'loss_cls_weight': tensor([1., 1., 1., 1.]),
 'optimizer': 'Adamax',
 'step_size': 10,
 'transforms': [1,
                Compose(
    ColorJitter(brightness=None, contrast=None, saturation=[0.95, 1.05], hue=[-0.05, 0.05])
    RandomHorizontalFlip(p=0.5)
    RandomRotation(degrees=(-20, 20), resample=2, expand=False)
    ToTensor()
    Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])
)],
 'weight_decay': 0.001}
Dataloader constructed!
Epoch: 0, batch loss: 0.16657 Loss Sum: 70.72896, accuracy : 0.89417, val loss: 6.98063, val accuracy: 0.87126
Final : 0.9258172903362646 [('val/VGG16/monotone/f1-score', 0.9481481481481482), ('val/VGG16/screenshot/f1-score', 0.9277566539923955), ('val/VGG16/unknown/f1-score', 0.902122641509434)]
Epoch: 1, batch loss: 0.14805 Loss Sum: 35.84025, accuracy : 0.94943, val loss: 5.43722, val accuracy: 0.91264
Final : 0.9404426643945593 [('val/VGG16/monotone/f1-score', 0.9481481481481482), ('val/VGG16/screenshot/f1-score', 0.9382239382239382), ('val/VGG16/unknown/f1-score', 0.9350057012542758)]
Epoch: 2, batch loss: 0.12241 Loss Sum: 23.25188, accuracy : 0.96890, val loss: 6.49102, val accuracy: 0.90651
Final : 0.9402172216235322 [('val/VGG16/monotone/f1-score', 0.9581749049429658), ('val/VGG16/screenshot/f1-score', 0.9307692307692308), ('val/VGG16/unknown/f1-score', 0.9319611206403661)]
Epoch: 3, batch loss: 0.02068 Loss Sum: 15.27180, accuracy : 0.97961, val loss: 9.50939, val accuracy: 0.87893
Final : 0.9296652191860083 [('val/VGG16/monotone/f1-score', 0.9660377358490566), ('val/VGG16/screenshot/f1-score', 0.9162011173184357), ('val/VGG16/unknown/f1-score', 0.9078097475044039)]
---train finished---
Trying to save to /tmp/tmp0qv6oe15/model
Too long checkpoint name: VGG16_64_[0.3, 0.2, 0.2, 0.3]_[3, 1]_1.0_0.01_[1.0, 1.0, 1.0, 1.0]_Adamax_10_1_100.0 not saved
Done
VGG16 Loaded!
{'batch_size': 64,
 'class_ratio': [0.3, 0.2, 0.2, 0.3],
 'epoch': [3, 1],
 'gamma': 0.1,
 'learning_rate': 0.0001,
 'loss_cls_weight': tensor([1., 1., 1., 1.]),
 'optimizer': 'Adamax',
 'step_size': 10,
 'transforms': [2,
                Compose(
    RandomAffine(degrees=(0, 0), scale=(0.75, 1.25))
    RandomPerspective(p=0.4)
    RandomHorizontalFlip(p=0.5)
    ToTensor()
    Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])
)],
 'weight_decay': 0}
Dataloader constructed!
Epoch: 0, batch loss: 0.19981 Loss Sum: 77.57198, accuracy : 0.88528, val loss: 7.61836, val accuracy: 0.85211
Final : 0.920774851702904 [('val/VGG16/monotone/f1-score', 0.9541984732824427), ('val/VGG16/screenshot/f1-score', 0.9219047619047619), ('val/VGG16/unknown/f1-score', 0.8874329958308517)]
Epoch: 1, batch loss: 0.08462 Loss Sum: 45.27966, accuracy : 0.93507, val loss: 8.56761, val accuracy: 0.85900
Final : 0.9216644391527132 [('val/VGG16/monotone/f1-score', 0.9548872180451128), ('val/VGG16/screenshot/f1-score', 0.9187145557655954), ('val/VGG16/unknown/f1-score', 0.8924539512774808)]
Epoch: 2, batch loss: 0.08101 Loss Sum: 33.80972, accuracy : 0.95229, val loss: 7.72055, val accuracy: 0.87203
Final : 0.9252447081309204 [('val/VGG16/monotone/f1-score', 0.9584905660377359), ('val/VGG16/screenshot/f1-score', 0.9168207024029575), ('val/VGG16/unknown/f1-score', 0.9013585351447135)]
Epoch: 3, batch loss: 0.03858 Loss Sum: 27.94890, accuracy : 0.95941, val loss: 8.70829, val accuracy: 0.87969
Final : 0.9333963344229053 [('val/VGG16/monotone/f1-score', 0.9498069498069497), ('val/VGG16/screenshot/f1-score', 0.9388560157790927), ('val/VGG16/unknown/f1-score', 0.9119351100811125)]
---train finished---
Trying to save to /tmp/tmpp5_a8y6x/model
Too long checkpoint name: VGG16_64_[0.3, 0.2, 0.2, 0.3]_[3, 1]_1.0_0.01_[1.0, 1.0, 1.0, 1.0]_Adamax_10_2_0 not saved
Done
VGG16 Loaded!
{'batch_size': 64,
 'class_ratio': [0.3, 0.2, 0.2, 0.3],
 'epoch': [3, 1],
 'gamma': 0.1,
 'learning_rate': 0.0001,
 'loss_cls_weight': tensor([1., 1., 1., 1.]),
 'optimizer': 'Adamax',
 'step_size': 10,
 'transforms': [2,
                Compose(
    RandomAffine(degrees=(0, 0), scale=(0.75, 1.25))
    RandomPerspective(p=0.4)
    RandomHorizontalFlip(p=0.5)
    ToTensor()
    Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])
)],
 'weight_decay': 0.001}
Dataloader constructed!
Epoch: 0, batch loss: 0.18064 Loss Sum: 76.72384, accuracy : 0.88796, val loss: 8.03510, val accuracy: 0.85824
Final : 0.9243351606704668 [('val/VGG16/monotone/f1-score', 0.9649805447470817), ('val/VGG16/screenshot/f1-score', 0.9157088122605364), ('val/VGG16/unknown/f1-score', 0.8937426210153482)]
Epoch: 1, batch loss: 0.10771 Loss Sum: 44.70525, accuracy : 0.93561, val loss: 6.45011, val accuracy: 0.89425
Final : 0.9208588631827721 [('val/VGG16/monotone/f1-score', 0.9442379182156134), ('val/VGG16/screenshot/f1-score', 0.8978102189781023), ('val/VGG16/unknown/f1-score', 0.9211136890951276)]
Epoch: 2, batch loss: 0.18634 Loss Sum: 34.86455, accuracy : 0.95083, val loss: 6.33436, val accuracy: 0.89732
Final : 0.9199137154297101 [('val/VGG16/monotone/f1-score', 0.9407407407407407), ('val/VGG16/screenshot/f1-score', 0.896551724137931), ('val/VGG16/unknown/f1-score', 0.9229878401852925)]
Epoch: 3, batch loss: 0.11910 Loss Sum: 26.21506, accuracy : 0.96294, val loss: 6.34221, val accuracy: 0.89502
Final : 0.9307999576987035 [('val/VGG16/monotone/f1-score', 0.9416058394160584), ('val/VGG16/screenshot/f1-score', 0.9296875), ('val/VGG16/unknown/f1-score', 0.9212190914318574)]
---train finished---
Trying to save to /tmp/tmpvukcomrn/model
Too long checkpoint name: VGG16_64_[0.3, 0.2, 0.2, 0.3]_[3, 1]_1.0_0.01_[1.0, 1.0, 1.0, 1.0]_Adamax_10_2_100.0 not saved
Done
VGG16 Loaded!
{'batch_size': 64,
 'class_ratio': [0.3, 0.2, 0.2, 0.3],
 'epoch': [3, 1],
 'gamma': 0.1,
 'learning_rate': 0.0001,
 'loss_cls_weight': tensor([1., 1., 1., 1.]),
 'optimizer': 'Adamax',
 'step_size': 2,
 'transforms': [1,
                Compose(
    ColorJitter(brightness=None, contrast=None, saturation=[0.95, 1.05], hue=[-0.05, 0.05])
    RandomHorizontalFlip(p=0.5)
    RandomRotation(degrees=(-20, 20), resample=2, expand=False)
    ToTensor()
    Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])
)],
 'weight_decay': 0}
Dataloader constructed!
Epoch: 0, batch loss: 0.18056 Loss Sum: 68.81895, accuracy : 0.89892, val loss: 5.43916, val accuracy: 0.89885
Final : 0.9299275512522603 [('val/VGG16/monotone/f1-score', 0.9516728624535317), ('val/VGG16/screenshot/f1-score', 0.9142857142857144), ('val/VGG16/unknown/f1-score', 0.9242250287026407)]
Epoch: 1, batch loss: 0.11334 Loss Sum: 36.05317, accuracy : 0.94973, val loss: 8.42539, val accuracy: 0.85441
Final : 0.9232765366978385 [('val/VGG16/monotone/f1-score', 0.9433962264150944), ('val/VGG16/screenshot/f1-score', 0.937984496124031), ('val/VGG16/unknown/f1-score', 0.8894173602853745)]
Epoch: 2, batch loss: 0.03025 Loss Sum: 21.54463, accuracy : 0.97164, val loss: 6.32019, val accuracy: 0.90575
Final : 0.9408328553911618 [('val/VGG16/monotone/f1-score', 0.9588014981273408), ('val/VGG16/screenshot/f1-score', 0.9343629343629344), ('val/VGG16/unknown/f1-score', 0.929593589009731)]
Epoch: 3, batch loss: 0.08776 Loss Sum: 19.00940, accuracy : 0.97535, val loss: 7.50642, val accuracy: 0.88966
Final : 0.9323309650105788 [('val/VGG16/monotone/f1-score', 0.9513108614232209), ('val/VGG16/screenshot/f1-score', 0.928709055876686), ('val/VGG16/unknown/f1-score', 0.9172932330827067)]
---train finished---
Trying to save to /tmp/tmptwwqsyzr/model
Too long checkpoint name: VGG16_64_[0.3, 0.2, 0.2, 0.3]_[3, 1]_1.0_0.01_[1.0, 1.0, 1.0, 1.0]_Adamax_2_1_0 not saved
Done
VGG16 Loaded!
{'batch_size': 64,
 'class_ratio': [0.3, 0.2, 0.2, 0.3],
 'epoch': [3, 1],
 'gamma': 0.1,
 'learning_rate': 0.0001,
 'loss_cls_weight': tensor([1., 1., 1., 1.]),
 'optimizer': 'Adamax',
 'step_size': 2,
 'transforms': [1,
                Compose(
    ColorJitter(brightness=None, contrast=None, saturation=[0.95, 1.05], hue=[-0.05, 0.05])
    RandomHorizontalFlip(p=0.5)
    RandomRotation(degrees=(-20, 20), resample=2, expand=False)
    ToTensor()
    Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])
)],
 'weight_decay': 0.001}
Dataloader constructed!
Epoch: 0, batch loss: 0.21056 Loss Sum: 70.71294, accuracy : 0.89271, val loss: 7.32617, val accuracy: 0.85441
Final : 0.9208209875102793 [('val/VGG16/monotone/f1-score', 0.9494163424124514), ('val/VGG16/screenshot/f1-score', 0.9236641221374047), ('val/VGG16/unknown/f1-score', 0.8903378778897452)]
Epoch: 1, batch loss: 0.13301 Loss Sum: 36.78926, accuracy : 0.94888, val loss: 5.29890, val accuracy: 0.91648
Final : 0.9336052532651219 [('val/VGG16/monotone/f1-score', 0.9584905660377359), ('val/VGG16/screenshot/f1-score', 0.9047619047619048), ('val/VGG16/unknown/f1-score', 0.9383561643835616)]
Epoch: 2, batch loss: 0.02491 Loss Sum: 22.40969, accuracy : 0.96963, val loss: 6.21328, val accuracy: 0.89502
Final : 0.9334878496621087 [('val/VGG16/monotone/f1-score', 0.9584905660377359), ('val/VGG16/screenshot/f1-score', 0.9204545454545454), ('val/VGG16/unknown/f1-score', 0.9220103986135182)]
Epoch: 3, batch loss: 0.01427 Loss Sum: 19.12728, accuracy : 0.97462, val loss: 6.12642, val accuracy: 0.91111
Final : 0.9459462364367125 [('val/VGG16/monotone/f1-score', 0.9696969696969696), ('val/VGG16/screenshot/f1-score', 0.9348659003831417), ('val/VGG16/unknown/f1-score', 0.9337142857142856)]
---train finished---
Trying to save to /tmp/tmpad7tnh06/model
Too long checkpoint name: VGG16_64_[0.3, 0.2, 0.2, 0.3]_[3, 1]_1.0_0.01_[1.0, 1.0, 1.0, 1.0]_Adamax_2_1_100.0 not saved
Done
VGG16 Loaded!
{'batch_size': 64,
 'class_ratio': [0.3, 0.2, 0.2, 0.3],
 'epoch': [3, 1],
 'gamma': 0.1,
 'learning_rate': 0.0001,
 'loss_cls_weight': tensor([1., 1., 1., 1.]),
 'optimizer': 'Adamax',
 'step_size': 2,
 'transforms': [2,
                Compose(
    RandomAffine(degrees=(0, 0), scale=(0.75, 1.25))
    RandomPerspective(p=0.4)
    RandomHorizontalFlip(p=0.5)
    ToTensor()
    Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])
)],
 'weight_decay': 0}
Dataloader constructed!
Epoch: 0, batch loss: 0.22455 Loss Sum: 76.83332, accuracy : 0.88547, val loss: 6.16725, val accuracy: 0.89502
Final : 0.9287662430064345 [('val/VGG16/monotone/f1-score', 0.9442379182156134), ('val/VGG16/screenshot/f1-score', 0.9201520912547527), ('val/VGG16/unknown/f1-score', 0.9221004039238315)]
Epoch: 1, batch loss: 0.25628 Loss Sum: 44.83308, accuracy : 0.93549, val loss: 8.72371, val accuracy: 0.85824
Final : 0.9183134991236491 [('val/VGG16/monotone/f1-score', 0.9314079422382672), ('val/VGG16/screenshot/f1-score', 0.933852140077821), ('val/VGG16/unknown/f1-score', 0.8903378778897452)]
Epoch: 2, batch loss: 0.12630 Loss Sum: 30.51038, accuracy : 0.95752, val loss: 6.60583, val accuracy: 0.89195
Final : 0.932609456862822 [('val/VGG16/monotone/f1-score', 0.9513108614232209), ('val/VGG16/screenshot/f1-score', 0.9272030651340997), ('val/VGG16/unknown/f1-score', 0.9196067090803933)]
Epoch: 3, batch loss: 0.08095 Loss Sum: 26.98272, accuracy : 0.96282, val loss: 7.20983, val accuracy: 0.88582
Final : 0.9371940373959802 [('val/VGG16/monotone/f1-score', 0.9621212121212122), ('val/VGG16/screenshot/f1-score', 0.9359223300970874), ('val/VGG16/unknown/f1-score', 0.91415313225058)]
---train finished---
Trying to save to /tmp/tmp1r30ewef/model
Too long checkpoint name: VGG16_64_[0.3, 0.2, 0.2, 0.3]_[3, 1]_1.0_0.01_[1.0, 1.0, 1.0, 1.0]_Adamax_2_2_0 not saved
Done
VGG16 Loaded!
{'batch_size': 64,
 'class_ratio': [0.3, 0.2, 0.2, 0.3],
 'epoch': [3, 1],
 'gamma': 0.1,
 'learning_rate': 0.0001,
 'loss_cls_weight': tensor([1., 1., 1., 1.]),
 'optimizer': 'Adamax',
 'step_size': 2,
 'transforms': [2,
                Compose(
    RandomAffine(degrees=(0, 0), scale=(0.75, 1.25))
    RandomPerspective(p=0.4)
    RandomHorizontalFlip(p=0.5)
    ToTensor()
    Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])
)],
 'weight_decay': 0.001}
Dataloader constructed!
Epoch: 0, batch loss: 0.26649 Loss Sum: 77.54856, accuracy : 0.88169, val loss: 8.87633, val accuracy: 0.84521
Final : 0.9081198683842517 [('val/VGG16/monotone/f1-score', 0.9343065693430657), ('val/VGG16/screenshot/f1-score', 0.9104761904761905), ('val/VGG16/unknown/f1-score', 0.8803827751196172)]
Epoch: 1, batch loss: 0.14150 Loss Sum: 43.64563, accuracy : 0.93555, val loss: 5.95112, val accuracy: 0.89808
Final : 0.9401739850409062 [('val/VGG16/monotone/f1-score', 0.9770992366412213), ('val/VGG16/screenshot/f1-score', 0.920696324951644), ('val/VGG16/unknown/f1-score', 0.92378223495702)]
Epoch: 2, batch loss: 0.11793 Loss Sum: 29.47052, accuracy : 0.95892, val loss: 7.17074, val accuracy: 0.89042
Final : 0.9360981594685943 [('val/VGG16/monotone/f1-score', 0.9731800766283525), ('val/VGG16/screenshot/f1-score', 0.9168278529980657), ('val/VGG16/unknown/f1-score', 0.9193548387096774)]
Epoch: 3, batch loss: 0.22071 Loss Sum: 26.19021, accuracy : 0.96294, val loss: 7.06894, val accuracy: 0.88966
Final : 0.9345199311081414 [('val/VGG16/monotone/f1-score', 0.9621212121212122), ('val/VGG16/screenshot/f1-score', 0.9245647969052224), ('val/VGG16/unknown/f1-score', 0.9174841315637622)]
---train finished---
Trying to save to /tmp/tmp719m3y77/model
Too long checkpoint name: VGG16_64_[0.3, 0.2, 0.2, 0.3]_[3, 1]_1.0_0.01_[1.0, 1.0, 1.0, 1.0]_Adamax_2_2_100.0 not saved
Done
VGG16 Loaded!
{'batch_size': 64,
 'class_ratio': [0.3, 0.2, 0.2, 0.3],
 'epoch': [3, 1],
 'gamma': 0.1,
 'learning_rate': 0.0001,
 'loss_cls_weight': tensor([1., 1., 1., 1.]),
 'optimizer': 'Adam',
 'step_size': 10,
 'transforms': [1,
                Compose(
    ColorJitter(brightness=None, contrast=None, saturation=[0.95, 1.05], hue=[-0.05, 0.05])
    RandomHorizontalFlip(p=0.5)
    RandomRotation(degrees=(-20, 20), resample=2, expand=False)
    ToTensor()
    Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])
)],
 'weight_decay': 0}
Dataloader constructed!
Epoch: 0, batch loss: 0.06552 Loss Sum: 71.70765, accuracy : 0.89667, val loss: 12.22464, val accuracy: 0.83602
Final : 0.8973717484009659 [('val/VGG16/monotone/f1-score', 0.9477611940298507), ('val/VGG16/screenshot/f1-score', 0.8756567425569177), ('val/VGG16/unknown/f1-score', 0.8707317073170732)]
Epoch: 1, batch loss: 0.06831 Loss Sum: 41.53455, accuracy : 0.94225, val loss: 8.93569, val accuracy: 0.86130
Final : 0.917653357429676 [('val/VGG16/monotone/f1-score', 0.9446494464944649), ('val/VGG16/screenshot/f1-score', 0.9171270718232044), ('val/VGG16/unknown/f1-score', 0.8919402985074627)]
Epoch: 2, batch loss: 0.04991 Loss Sum: 30.70764, accuracy : 0.95557, val loss: 6.70890, val accuracy: 0.89502
Final : 0.9359922169574536 [('val/VGG16/monotone/f1-score', 0.9621212121212122), ('val/VGG16/screenshot/f1-score', 0.9253731343283582), ('val/VGG16/unknown/f1-score', 0.9210220673635308)]
Epoch: 3, batch loss: 0.10637 Loss Sum: 21.62748, accuracy : 0.97048, val loss: 8.97288, val accuracy: 0.86973
Final : 0.9211977982974161 [('val/VGG16/monotone/f1-score', 0.9581749049429658), ('val/VGG16/screenshot/f1-score', 0.907103825136612), ('val/VGG16/unknown/f1-score', 0.8994082840236687)]
---train finished---
Trying to save to /tmp/tmpqflee5ic/model
Too long checkpoint name: VGG16_64_[0.3, 0.2, 0.2, 0.3]_[3, 1]_1.0_0.01_[1.0, 1.0, 1.0, 1.0]_Adam_10_1_0 not saved
Done
VGG16 Loaded!
{'batch_size': 64,
 'class_ratio': [0.3, 0.2, 0.2, 0.3],
 'epoch': [3, 1],
 'gamma': 0.1,
 'learning_rate': 0.0001,
 'loss_cls_weight': tensor([1., 1., 1., 1.]),
 'optimizer': 'Adam',
 'step_size': 10,
 'transforms': [1,
                Compose(
    ColorJitter(brightness=None, contrast=None, saturation=[0.95, 1.05], hue=[-0.05, 0.05])
    RandomHorizontalFlip(p=0.5)
    RandomRotation(degrees=(-20, 20), resample=2, expand=False)
    ToTensor()
    Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])
)],
 'weight_decay': 0.001}
Dataloader constructed!
Epoch: 0, batch loss: 0.12466 Loss Sum: 70.91801, accuracy : 0.89630, val loss: 4.62450, val accuracy: 0.92107
Final : 0.9411627094955273 [('val/VGG16/monotone/f1-score', 0.9552238805970149), ('val/VGG16/screenshot/f1-score', 0.9266409266409266), ('val/VGG16/unknown/f1-score', 0.9418407679277244)]
Epoch: 1, batch loss: 0.28033 Loss Sum: 43.21684, accuracy : 0.93945, val loss: 8.33404, val accuracy: 0.84061
Final : 0.9151536430834646 [('val/VGG16/monotone/f1-score', 0.9381818181818181), ('val/VGG16/screenshot/f1-score', 0.9333333333333332), ('val/VGG16/unknown/f1-score', 0.8753026634382568)]
Epoch: 2, batch loss: 0.03299 Loss Sum: 33.20394, accuracy : 0.95478, val loss: 10.02264, val accuracy: 0.85364
Final : 0.9168169525324144 [('val/VGG16/monotone/f1-score', 0.9338235294117646), ('val/VGG16/screenshot/f1-score', 0.9297912713472486), ('val/VGG16/unknown/f1-score', 0.8875598086124401)]
Epoch: 3, batch loss: 0.03289 Loss Sum: 27.77168, accuracy : 0.96269, val loss: 6.96303, val accuracy: 0.91418
Final : 0.9384150960928817 [('val/VGG16/monotone/f1-score', 0.945054945054945), ('val/VGG16/screenshot/f1-score', 0.9338374291115312), ('val/VGG16/unknown/f1-score', 0.9363896848137537)]
---train finished---
Trying to save to /tmp/tmpigx1mv_a/model
Too long checkpoint name: VGG16_64_[0.3, 0.2, 0.2, 0.3]_[3, 1]_1.0_0.01_[1.0, 1.0, 1.0, 1.0]_Adam_10_1_100.0 not saved
Done
VGG16 Loaded!
{'batch_size': 64,
 'class_ratio': [0.3, 0.2, 0.2, 0.3],
 'epoch': [3, 1],
 'gamma': 0.1,
 'learning_rate': 0.0001,
 'loss_cls_weight': tensor([1., 1., 1., 1.]),
 'optimizer': 'Adam',
 'step_size': 10,
 'transforms': [2,
                Compose(
    RandomAffine(degrees=(0, 0), scale=(0.75, 1.25))
    RandomPerspective(p=0.4)
    RandomHorizontalFlip(p=0.5)
    ToTensor()
    Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])
)],
 'weight_decay': 0}
Dataloader constructed!
Epoch: 0, batch loss: 0.19369 Loss Sum: 81.07450, accuracy : 0.87853, val loss: 6.58429, val accuracy: 0.87050
Final : 0.9120867100631257 [('val/VGG16/monotone/f1-score', 0.9516728624535317), ('val/VGG16/screenshot/f1-score', 0.8853046594982079), ('val/VGG16/unknown/f1-score', 0.9005917159763314)]
Epoch: 1, batch loss: 0.06197 Loss Sum: 48.46338, accuracy : 0.93008, val loss: 8.74826, val accuracy: 0.85594
Final : 0.910928771915278 [('val/VGG16/monotone/f1-score', 0.9615384615384615), ('val/VGG16/screenshot/f1-score', 0.8837209302325582), ('val/VGG16/unknown/f1-score', 0.8895522388059702)]
Epoch: 2, batch loss: 0.22404 Loss Sum: 38.00378, accuracy : 0.94681, val loss: 6.22152, val accuracy: 0.89502
Final : 0.936979813333073 [('val/VGG16/monotone/f1-score', 0.9603174603174603), ('val/VGG16/screenshot/f1-score', 0.9281553398058252), ('val/VGG16/unknown/f1-score', 0.9229011993146773)]
Epoch: 3, batch loss: 0.31035 Loss Sum: 33.94278, accuracy : 0.95314, val loss: 8.02381, val accuracy: 0.87663
Final : 0.924272539395886 [('val/VGG16/monotone/f1-score', 0.9696969696969696), ('val/VGG16/screenshot/f1-score', 0.8985507246376812), ('val/VGG16/unknown/f1-score', 0.9061946902654867)]
---train finished---
Trying to save to /tmp/tmpygu28mx6/model
Too long checkpoint name: VGG16_64_[0.3, 0.2, 0.2, 0.3]_[3, 1]_1.0_0.01_[1.0, 1.0, 1.0, 1.0]_Adam_10_2_0 not saved
Done
VGG16 Loaded!
{'batch_size': 64,
 'class_ratio': [0.3, 0.2, 0.2, 0.3],
 'epoch': [3, 1],
 'gamma': 0.1,
 'learning_rate': 0.0001,
 'loss_cls_weight': tensor([1., 1., 1., 1.]),
 'optimizer': 'Adam',
 'step_size': 10,
 'transforms': [2,
                Compose(
    RandomAffine(degrees=(0, 0), scale=(0.75, 1.25))
    RandomPerspective(p=0.4)
    RandomHorizontalFlip(p=0.5)
    ToTensor()
    Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])
)],
 'weight_decay': 0.001}
Dataloader constructed!
Epoch: 0, batch loss: 0.46728 Loss Sum: 80.06836, accuracy : 0.88401, val loss: 5.78136, val accuracy: 0.88276
Final : 0.929462652775945 [('val/VGG16/monotone/f1-score', 0.9552238805970149), ('val/VGG16/screenshot/f1-score', 0.9233644859813084), ('val/VGG16/unknown/f1-score', 0.9103690685413004)]
Epoch: 1, batch loss: 0.13395 Loss Sum: 52.37809, accuracy : 0.92685, val loss: 7.75986, val accuracy: 0.85594
Final : 0.9194138232393884 [('val/VGG16/monotone/f1-score', 0.9446494464944649), ('val/VGG16/screenshot/f1-score', 0.9259962049335863), ('val/VGG16/unknown/f1-score', 0.8884913536076328)]
Epoch: 2, batch loss: 0.29393 Loss Sum: 44.04861, accuracy : 0.93689, val loss: 4.92471, val accuracy: 0.91571
Final : 0.9433762203727816 [('val/VGG16/monotone/f1-score', 0.9694656488549618), ('val/VGG16/screenshot/f1-score', 0.9224652087475149), ('val/VGG16/unknown/f1-score', 0.9387984278495228)]
Epoch: 3, batch loss: 0.10941 Loss Sum: 39.77511, accuracy : 0.94419, val loss: 10.89652, val accuracy: 0.81762
Final : 0.9146261846200399 [('val/VGG16/monotone/f1-score', 0.9494163424124514), ('val/VGG16/screenshot/f1-score', 0.939622641509434), ('val/VGG16/unknown/f1-score', 0.8576709796672828)]
---train finished---
Trying to save to /tmp/tmpz5dqgruu/model
Too long checkpoint name: VGG16_64_[0.3, 0.2, 0.2, 0.3]_[3, 1]_1.0_0.01_[1.0, 1.0, 1.0, 1.0]_Adam_10_2_100.0 not saved
Done
VGG16 Loaded!
{'batch_size': 64,
 'class_ratio': [0.3, 0.2, 0.2, 0.3],
 'epoch': [3, 1],
 'gamma': 0.1,
 'learning_rate': 0.0001,
 'loss_cls_weight': tensor([1., 1., 1., 1.]),
 'optimizer': 'Adam',
 'step_size': 2,
 'transforms': [1,
                Compose(
    ColorJitter(brightness=None, contrast=None, saturation=[0.95, 1.05], hue=[-0.05, 0.05])
    RandomHorizontalFlip(p=0.5)
    RandomRotation(degrees=(-20, 20), resample=2, expand=False)
    ToTensor()
    Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])
)],
 'weight_decay': 0}
Dataloader constructed!
Epoch: 0, batch loss: 0.21261 Loss Sum: 72.59733, accuracy : 0.89520, val loss: 6.92962, val accuracy: 0.87586
Final : 0.9179816524024388 [('val/VGG16/monotone/f1-score', 0.9398496240601503), ('val/VGG16/screenshot/f1-score', 0.907103825136612), ('val/VGG16/unknown/f1-score', 0.9073746312684366)]
Epoch: 1, batch loss: 0.07227 Loss Sum: 37.60621, accuracy : 0.94748, val loss: 5.58326, val accuracy: 0.90421
Final : 0.9343233281686564 [('val/VGG16/monotone/f1-score', 0.9481481481481482), ('val/VGG16/screenshot/f1-score', 0.9271028037383177), ('val/VGG16/unknown/f1-score', 0.927870744373918)]
Epoch: 2, batch loss: 0.09108 Loss Sum: 18.74070, accuracy : 0.97401, val loss: 6.42175, val accuracy: 0.90728
Final : 0.9413878636366253 [('val/VGG16/monotone/f1-score', 0.9513108614232209), ('val/VGG16/screenshot/f1-score', 0.9423076923076923), ('val/VGG16/unknown/f1-score', 0.9306590257879656)]
Epoch: 3, batch loss: 0.06899 Loss Sum: 13.23690, accuracy : 0.98290, val loss: 5.92812, val accuracy: 0.91648
Final : 0.948167239295497 [('val/VGG16/monotone/f1-score', 0.9584905660377359), ('val/VGG16/screenshot/f1-score', 0.9483747609942639), ('val/VGG16/unknown/f1-score', 0.9377498572244432)]
---train finished---
Trying to save to /tmp/tmp4i4xu46f/model
Too long checkpoint name: VGG16_64_[0.3, 0.2, 0.2, 0.3]_[3, 1]_1.0_0.01_[1.0, 1.0, 1.0, 1.0]_Adam_2_1_0 not saved
Done
VGG16 Loaded!
{'batch_size': 64,
 'class_ratio': [0.3, 0.2, 0.2, 0.3],
 'epoch': [3, 1],
 'gamma': 0.1,
 'learning_rate': 0.0001,
 'loss_cls_weight': tensor([1., 1., 1., 1.]),
 'optimizer': 'Adam',
 'step_size': 2,
 'transforms': [1,
                Compose(
    ColorJitter(brightness=None, contrast=None, saturation=[0.95, 1.05], hue=[-0.05, 0.05])
    RandomHorizontalFlip(p=0.5)
    RandomRotation(degrees=(-20, 20), resample=2, expand=False)
    ToTensor()
    Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])
)],
 'weight_decay': 0.001}
Dataloader constructed!
Epoch: 0, batch loss: 0.25650 Loss Sum: 75.19562, accuracy : 0.88961, val loss: 7.13281, val accuracy: 0.85747
Final : 0.9198019190983387 [('val/VGG16/monotone/f1-score', 0.9772727272727273), ('val/VGG16/screenshot/f1-score', 0.8956834532374099), ('val/VGG16/unknown/f1-score', 0.8890221955608879)]
Epoch: 1, batch loss: 0.22239 Loss Sum: 42.51650, accuracy : 0.94097, val loss: 5.11925, val accuracy: 0.89962
Final : 0.9453040838135768 [('val/VGG16/monotone/f1-score', 0.9652509652509652), ('val/VGG16/screenshot/f1-score', 0.944337811900192), ('val/VGG16/unknown/f1-score', 0.9267166762839008)]
Epoch: 2, batch loss: 0.01429 Loss Sum: 22.13179, accuracy : 0.96799, val loss: 6.35351, val accuracy: 0.90728
Final : 0.9460101132716731 [('val/VGG16/monotone/f1-score', 0.9541984732824427), ('val/VGG16/screenshot/f1-score', 0.9516441005802708), ('val/VGG16/unknown/f1-score', 0.9323394495412843)]
Epoch: 3, batch loss: 0.13323 Loss Sum: 16.26104, accuracy : 0.97785, val loss: 6.71052, val accuracy: 0.90115
Final : 0.9432384937231556 [('val/VGG16/monotone/f1-score', 0.9618320610687022), ('val/VGG16/screenshot/f1-score', 0.940952380952381), ('val/VGG16/unknown/f1-score', 0.9272517321016166)]
---train finished---
Trying to save to /tmp/tmp5ioexf8z/model
Too long checkpoint name: VGG16_64_[0.3, 0.2, 0.2, 0.3]_[3, 1]_1.0_0.01_[1.0, 1.0, 1.0, 1.0]_Adam_2_1_100.0 not saved
Done
VGG16 Loaded!
{'batch_size': 64,
 'class_ratio': [0.3, 0.2, 0.2, 0.3],
 'epoch': [3, 1],
 'gamma': 0.1,
 'learning_rate': 0.0001,
 'loss_cls_weight': tensor([1., 1., 1., 1.]),
 'optimizer': 'Adam',
 'step_size': 2,
 'transforms': [2,
                Compose(
    RandomAffine(degrees=(0, 0), scale=(0.75, 1.25))
    RandomPerspective(p=0.4)
    RandomHorizontalFlip(p=0.5)
    ToTensor()
    Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])
)],
 'weight_decay': 0}
Dataloader constructed!
Epoch: 0, batch loss: 0.12561 Loss Sum: 80.71324, accuracy : 0.87993, val loss: 5.75265, val accuracy: 0.89425
Final : 0.9409042380480191 [('val/VGG16/monotone/f1-score', 0.9662921348314606), ('val/VGG16/screenshot/f1-score', 0.937142857142857), ('val/VGG16/unknown/f1-score', 0.9198606271777002)]
Epoch: 1, batch loss: 0.24244 Loss Sum: 48.98946, accuracy : 0.93233, val loss: 4.28190, val accuracy: 0.93103
Final : 0.9366486907653744 [('val/VGG16/monotone/f1-score', 0.9333333333333332), ('val/VGG16/screenshot/f1-score', 0.9272030651340997), ('val/VGG16/unknown/f1-score', 0.9495515695067264)]
Epoch: 2, batch loss: 0.14154 Loss Sum: 26.53330, accuracy : 0.96367, val loss: 6.83320, val accuracy: 0.89502
Final : 0.9357841962936198 [('val/VGG16/monotone/f1-score', 0.9545454545454545), ('val/VGG16/screenshot/f1-score', 0.9318181818181819), ('val/VGG16/unknown/f1-score', 0.9212962962962962)]
Epoch: 3, batch loss: 0.07865 Loss Sum: 21.24702, accuracy : 0.97121, val loss: 7.18470, val accuracy: 0.89272
Final : 0.9353539018911826 [('val/VGG16/monotone/f1-score', 0.9621212121212122), ('val/VGG16/screenshot/f1-score', 0.9253731343283582), ('val/VGG16/unknown/f1-score', 0.9191390343222805)]
---train finished---
Trying to save to /tmp/tmpx1cz4w_t/model
Too long checkpoint name: VGG16_64_[0.3, 0.2, 0.2, 0.3]_[3, 1]_1.0_0.01_[1.0, 1.0, 1.0, 1.0]_Adam_2_2_0 not saved
Done
VGG16 Loaded!
{'batch_size': 64,
 'class_ratio': [0.3, 0.2, 0.2, 0.3],
 'epoch': [3, 1],
 'gamma': 0.1,
 'learning_rate': 0.0001,
 'loss_cls_weight': tensor([1., 1., 1., 1.]),
 'optimizer': 'Adam',
 'step_size': 2,
 'transforms': [2,
                Compose(
    RandomAffine(degrees=(0, 0), scale=(0.75, 1.25))
    RandomPerspective(p=0.4)
    RandomHorizontalFlip(p=0.5)
    ToTensor()
    Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])
)],
 'weight_decay': 0.001}
Dataloader constructed!
Epoch: 0, batch loss: 0.19280 Loss Sum: 81.21054, accuracy : 0.87932, val loss: 8.36687, val accuracy: 0.84751
Final : 0.9212178059042126 [('val/VGG16/monotone/f1-score', 0.9621212121212122), ('val/VGG16/screenshot/f1-score', 0.9210526315789473), ('val/VGG16/unknown/f1-score', 0.8822115384615384)]
Epoch: 1, batch loss: 0.32521 Loss Sum: 50.42094, accuracy : 0.92807, val loss: 10.01686, val accuracy: 0.85517
Final : 0.9027919546154126 [('val/VGG16/monotone/f1-score', 0.9280575539568345), ('val/VGG16/screenshot/f1-score', 0.8936936936936937), ('val/VGG16/unknown/f1-score', 0.8871548619447779)]
Epoch: 2, batch loss: 0.04661 Loss Sum: 30.75222, accuracy : 0.95606, val loss: 6.44131, val accuracy: 0.90038
Final : 0.9479258787752066 [('val/VGG16/monotone/f1-score', 0.9772727272727273), ('val/VGG16/screenshot/f1-score', 0.9423076923076923), ('val/VGG16/unknown/f1-score', 0.9249422632794458)]
Epoch: 3, batch loss: 0.06533 Loss Sum: 23.25752, accuracy : 0.96890, val loss: 6.30223, val accuracy: 0.90115
Final : 0.9403729328452929 [('val/VGG16/monotone/f1-score', 0.9652509652509652), ('val/VGG16/screenshot/f1-score', 0.9284332688588007), ('val/VGG16/unknown/f1-score', 0.9279176201372997)]
---train finished---
Trying to save to /tmp/tmpwoy7dsuq/model
Too long checkpoint name: VGG16_64_[0.3, 0.2, 0.2, 0.3]_[3, 1]_1.0_0.01_[1.0, 1.0, 1.0, 1.0]_Adam_2_2_100.0 not saved
Done
VGG16 Loaded!
{'batch_size': 64,
 'class_ratio': [0.3, 0.2, 0.2, 0.3],
 'epoch': [3, 1],
 'gamma': 0.1,
 'learning_rate': 0.0001,
 'loss_cls_weight': tensor([1., 1., 1., 1.]),
 'optimizer': 'SGD',
 'step_size': 10,
 'transforms': [1,
                Compose(
    ColorJitter(brightness=None, contrast=None, saturation=[0.95, 1.05], hue=[-0.05, 0.05])
    RandomHorizontalFlip(p=0.5)
    RandomRotation(degrees=(-20, 20), resample=2, expand=False)
    ToTensor()
    Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])
)],
 'weight_decay': 0}
Dataloader constructed!
Epoch: 0, batch loss: 0.48607 Loss Sum: 242.98462, accuracy : 0.58033, val loss: 12.77619, val accuracy: 0.76169
Final : 0.8237319830129259 [('val/VGG16/monotone/f1-score', 0.8172757475083057), ('val/VGG16/screenshot/f1-score', 0.847457627118644), ('val/VGG16/unknown/f1-score', 0.8069956277326671)]
Epoch: 1, batch loss: 0.30312 Loss Sum: 109.11833, accuracy : 0.84512, val loss: 9.59572, val accuracy: 0.82222
Final : 0.8826650572543914 [('val/VGG16/monotone/f1-score', 0.907142857142857), ('val/VGG16/screenshot/f1-score', 0.8819188191881918), ('val/VGG16/unknown/f1-score', 0.8595744680851064)]
Epoch: 2, batch loss: 0.20953 Loss Sum: 76.13103, accuracy : 0.89046, val loss: 9.96308, val accuracy: 0.80996
Final : 0.8778153858172075 [('val/VGG16/monotone/f1-score', 0.9039145907473309), ('val/VGG16/screenshot/f1-score', 0.8790786948176583), ('val/VGG16/unknown/f1-score', 0.851244687310261)]
Epoch: 3, batch loss: 0.40486 Loss Sum: 64.89193, accuracy : 0.90604, val loss: 8.69740, val accuracy: 0.84981
Final : 0.8977550171802995 [('val/VGG16/monotone/f1-score', 0.9142857142857144), ('val/VGG16/screenshot/f1-score', 0.8955223880597014), ('val/VGG16/unknown/f1-score', 0.883720930232558)]
---train finished---
Trying to save to /tmp/tmpkmr7wsfe/model
Too long checkpoint name: VGG16_64_[0.3, 0.2, 0.2, 0.3]_[3, 1]_1.0_0.01_[1.0, 1.0, 1.0, 1.0]_SGD_10_1_0 not saved
Done
VGG16 Loaded!
{'batch_size': 64,
 'class_ratio': [0.3, 0.2, 0.2, 0.3],
 'epoch': [3, 1],
 'gamma': 0.1,
 'learning_rate': 0.0001,
 'loss_cls_weight': tensor([1., 1., 1., 1.]),
 'optimizer': 'SGD',
 'step_size': 10,
 'transforms': [1,
                Compose(
    ColorJitter(brightness=None, contrast=None, saturation=[0.95, 1.05], hue=[-0.05, 0.05])
    RandomHorizontalFlip(p=0.5)
    RandomRotation(degrees=(-20, 20), resample=2, expand=False)
    ToTensor()
    Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])
)],
 'weight_decay': 0.001}
Dataloader constructed!
Epoch: 0, batch loss: 1.13129 Loss Sum: 328.81202, accuracy : 0.37238, val loss: 24.33566, val accuracy: 0.46667
Final : 0.18522660651107273 [('val/VGG16/monotone/f1-score', 0.015384615384615384), ('val/VGG16/screenshot/f1-score', 0.6991869918699187), ('val/VGG16/unknown/f1-score', 0.5907859078590786)]
Epoch: 1, batch loss: 0.94802 Loss Sum: 272.49348, accuracy : 0.50785, val loss: 19.86723, val accuracy: 0.57241
Final : 0.3959937217305867 [('val/VGG16/monotone/f1-score', 0.11594202898550723), ('val/VGG16/screenshot/f1-score', 0.7911275415896487), ('val/VGG16/unknown/f1-score', 0.6769825918762089)]
Epoch: 2, batch loss: 0.81283 Loss Sum: 219.11814, accuracy : 0.63675, val loss: 16.45282, val accuracy: 0.68429
Final : 0.7858892854992061 [('val/VGG16/monotone/f1-score', 0.7841409691629956), ('val/VGG16/screenshot/f1-score', 0.8279773156899811), ('val/VGG16/unknown/f1-score', 0.7476038338658146)]
Epoch: 3, batch loss: 0.65736 Loss Sum: 176.13442, accuracy : 0.76296, val loss: 14.34408, val accuracy: 0.71648
Final : 0.8200611037119349 [('val/VGG16/monotone/f1-score', 0.8600682593856656), ('val/VGG16/screenshot/f1-score', 0.8426966292134832), ('val/VGG16/unknown/f1-score', 0.7609120521172639)]
---train finished---
Trying to save to /tmp/tmp_zem8rd7/model
Too long checkpoint name: VGG16_64_[0.3, 0.2, 0.2, 0.3]_[3, 1]_1.0_0.01_[1.0, 1.0, 1.0, 1.0]_SGD_10_1_100.0 not saved
Done
VGG16 Loaded!
{'batch_size': 64,
 'class_ratio': [0.3, 0.2, 0.2, 0.3],
 'epoch': [3, 1],
 'gamma': 0.1,
 'learning_rate': 0.0001,
 'loss_cls_weight': tensor([1., 1., 1., 1.]),
 'optimizer': 'SGD',
 'step_size': 10,
 'transforms': [2,
                Compose(
    RandomAffine(degrees=(0, 0), scale=(0.75, 1.25))
    RandomPerspective(p=0.4)
    RandomHorizontalFlip(p=0.5)
    ToTensor()
    Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])
)],
 'weight_decay': 0}
Dataloader constructed!
Epoch: 0, batch loss: 0.49680 Loss Sum: 183.85404, accuracy : 0.68689, val loss: 11.59287, val accuracy: 0.78084
Final : 0.8544504325016627 [('val/VGG16/monotone/f1-score', 0.8737201365187713), ('val/VGG16/screenshot/f1-score', 0.8672897196261682), ('val/VGG16/unknown/f1-score', 0.8232354778263586)]
Epoch: 1, batch loss: 0.12756 Loss Sum: 69.52412, accuracy : 0.89977, val loss: 7.58158, val accuracy: 0.86973
Final : 0.9206424844580475 [('val/VGG16/monotone/f1-score', 0.9446494464944649), ('val/VGG16/screenshot/f1-score', 0.9174664107485605), ('val/VGG16/unknown/f1-score', 0.9003516998827668)]
Epoch: 2, batch loss: 0.19527 Loss Sum: 51.34449, accuracy : 0.92673, val loss: 6.74102, val accuracy: 0.87969
Final : 0.9260216878282921 [('val/VGG16/monotone/f1-score', 0.9516728624535317), ('val/VGG16/screenshot/f1-score', 0.9169960474308302), ('val/VGG16/unknown/f1-score', 0.9099307159353349)]
Epoch: 3, batch loss: 0.16920 Loss Sum: 41.63201, accuracy : 0.94152, val loss: 9.54343, val accuracy: 0.84215
Final : 0.912358628551375 [('val/VGG16/monotone/f1-score', 0.9407407407407407), ('val/VGG16/screenshot/f1-score', 0.918918918918919), ('val/VGG16/unknown/f1-score', 0.8785158587672052)]
---train finished---
Trying to save to /tmp/tmpzq3t9cd6/model
Too long checkpoint name: VGG16_64_[0.3, 0.2, 0.2, 0.3]_[3, 1]_1.0_0.01_[1.0, 1.0, 1.0, 1.0]_SGD_10_2_0 not saved
Done
VGG16 Loaded!
{'batch_size': 64,
 'class_ratio': [0.3, 0.2, 0.2, 0.3],
 'epoch': [3, 1],
 'gamma': 0.1,
 'learning_rate': 0.0001,
 'loss_cls_weight': tensor([1., 1., 1., 1.]),
 'optimizer': 'SGD',
 'step_size': 10,
 'transforms': [2,
                Compose(
    RandomAffine(degrees=(0, 0), scale=(0.75, 1.25))
    RandomPerspective(p=0.4)
    RandomHorizontalFlip(p=0.5)
    ToTensor()
    Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])
)],
 'weight_decay': 0.001}
Dataloader constructed!
Epoch: 0, batch loss: 1.31840 Loss Sum: 341.46046, accuracy : 0.32498, val loss: 26.26127, val accuracy: 0.44828
/opt/conda/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1221: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Final : 0.0 [('val/VGG16/monotone/f1-score', 0.0), ('val/VGG16/screenshot/f1-score', 0.5206611570247933), ('val/VGG16/unknown/f1-score', 0.6035502958579881)]
Epoch: 1, batch loss: 1.11006 Loss Sum: 313.85615, accuracy : 0.42989, val loss: 23.98080, val accuracy: 0.48659
Final : 0.0 [('val/VGG16/monotone/f1-score', 0.0), ('val/VGG16/screenshot/f1-score', 0.7161904761904762), ('val/VGG16/unknown/f1-score', 0.6024258760107817)]
Epoch: 2, batch loss: 1.04722 Loss Sum: 285.69196, accuracy : 0.48375, val loss: 21.92828, val accuracy: 0.51188
Final : 0.0 [('val/VGG16/monotone/f1-score', 0.0), ('val/VGG16/screenshot/f1-score', 0.787878787878788), ('val/VGG16/unknown/f1-score', 0.6048714479025711)]
Epoch: 3, batch loss: 1.01516 Loss Sum: 259.48448, accuracy : 0.51540, val loss: 20.09009, val accuracy: 0.54100
Final : 0.19807617298490898 [('val/VGG16/monotone/f1-score', 0.015384615384615384), ('val/VGG16/screenshot/f1-score', 0.793418647166362), ('val/VGG16/unknown/f1-score', 0.6366601435094585)]
---train finished---
Trying to save to /tmp/tmp6070f57j/model
Too long checkpoint name: VGG16_64_[0.3, 0.2, 0.2, 0.3]_[3, 1]_1.0_0.01_[1.0, 1.0, 1.0, 1.0]_SGD_10_2_100.0 not saved
Done
VGG16 Loaded!
{'batch_size': 64,
 'class_ratio': [0.3, 0.2, 0.2, 0.3],
 'epoch': [3, 1],
 'gamma': 0.1,
 'learning_rate': 0.0001,
 'loss_cls_weight': tensor([1., 1., 1., 1.]),
 'optimizer': 'SGD',
 'step_size': 2,
 'transforms': [1,
                Compose(
    ColorJitter(brightness=None, contrast=None, saturation=[0.95, 1.05], hue=[-0.05, 0.05])
    RandomHorizontalFlip(p=0.5)
    RandomRotation(degrees=(-20, 20), resample=2, expand=False)
    ToTensor()
    Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])
)],
 'weight_decay': 0}
Dataloader constructed!
Epoch: 0, batch loss: 1.21494 Loss Sum: 332.37342, accuracy : 0.36368, val loss: 24.88429, val accuracy: 0.43065
Final : 0.0 [('val/VGG16/monotone/f1-score', 0.0), ('val/VGG16/screenshot/f1-score', 0.6797385620915033), ('val/VGG16/unknown/f1-score', 0.5535105657805044)]
Epoch: 1, batch loss: 0.92336 Loss Sum: 275.23511, accuracy : 0.50426, val loss: 20.13469, val accuracy: 0.55326
Final : 0.360981330160223 [('val/VGG16/monotone/f1-score', 0.08888888888888888), ('val/VGG16/screenshot/f1-score', 0.8103130755064458), ('val/VGG16/unknown/f1-score', 0.6530612244897959)]
Epoch: 2, batch loss: 0.90441 Loss Sum: 243.57190, accuracy : 0.55075, val loss: 20.03317, val accuracy: 0.55019
Final : 0.445388426948825 [('val/VGG16/monotone/f1-score', 0.1702127659574468), ('val/VGG16/screenshot/f1-score', 0.8111111111111111), ('val/VGG16/unknown/f1-score', 0.6399474375821288)]
Epoch: 3, batch loss: 0.92181 Loss Sum: 238.67813, accuracy : 0.56110, val loss: 19.63614, val accuracy: 0.56322
Final : 0.4789814893368689 [('val/VGG16/monotone/f1-score', 0.20833333333333334), ('val/VGG16/screenshot/f1-score', 0.8037383177570093), ('val/VGG16/unknown/f1-score', 0.6562703053931124)]
---train finished---
Trying to save to /tmp/tmp29cx1dwe/model
Too long checkpoint name: VGG16_64_[0.3, 0.2, 0.2, 0.3]_[3, 1]_1.0_0.01_[1.0, 1.0, 1.0, 1.0]_SGD_2_1_0 not saved
Done
VGG16 Loaded!
{'batch_size': 64,
 'class_ratio': [0.3, 0.2, 0.2, 0.3],
 'epoch': [3, 1],
 'gamma': 0.1,
 'learning_rate': 0.0001,
 'loss_cls_weight': tensor([1., 1., 1., 1.]),
 'optimizer': 'SGD',
 'step_size': 2,
 'transforms': [1,
                Compose(
    ColorJitter(brightness=None, contrast=None, saturation=[0.95, 1.05], hue=[-0.05, 0.05])
    RandomHorizontalFlip(p=0.5)
    RandomRotation(degrees=(-20, 20), resample=2, expand=False)
    ToTensor()
    Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])
)],
 'weight_decay': 0.001}
Dataloader constructed!
Epoch: 0, batch loss: 0.42274 Loss Sum: 170.28045, accuracy : 0.70551, val loss: 6.46362, val accuracy: 0.88429
Final : 0.9101204135728809 [('val/VGG16/monotone/f1-score', 0.9057971014492754), ('val/VGG16/screenshot/f1-score', 0.9101338432122371), ('val/VGG16/unknown/f1-score', 0.9144508670520232)]
Epoch: 1, batch loss: 0.21294 Loss Sum: 59.98546, accuracy : 0.91474, val loss: 6.93544, val accuracy: 0.86973
Final : 0.9088930871532491 [('val/VGG16/monotone/f1-score', 0.9236363636363636), ('val/VGG16/screenshot/f1-score', 0.9023941068139965), ('val/VGG16/unknown/f1-score', 0.9008264462809918)]
Epoch: 2, batch loss: 0.04372 Loss Sum: 45.46360, accuracy : 0.93531, val loss: 6.37376, val accuracy: 0.88199
Final : 0.9229517440564406 [('val/VGG16/monotone/f1-score', 0.937269372693727), ('val/VGG16/screenshot/f1-score', 0.9204545454545454), ('val/VGG16/unknown/f1-score', 0.911318553092182)]
Epoch: 3, batch loss: 0.20722 Loss Sum: 42.06162, accuracy : 0.94042, val loss: 6.20010, val accuracy: 0.88046
Final : 0.9206732831275176 [('val/VGG16/monotone/f1-score', 0.937269372693727), ('val/VGG16/screenshot/f1-score', 0.9155722326454032), ('val/VGG16/unknown/f1-score', 0.9094097019286967)]
---train finished---
Trying to save to /tmp/tmpp8coxlzj/model
Too long checkpoint name: VGG16_64_[0.3, 0.2, 0.2, 0.3]_[3, 1]_1.0_0.01_[1.0, 1.0, 1.0, 1.0]_SGD_2_1_100.0 not saved
Done
VGG16 Loaded!
{'batch_size': 64,
 'class_ratio': [0.3, 0.2, 0.2, 0.3],
 'epoch': [3, 1],
 'gamma': 0.1,
 'learning_rate': 0.0001,
 'loss_cls_weight': tensor([1., 1., 1., 1.]),
 'optimizer': 'SGD',
 'step_size': 2,
 'transforms': [2,
                Compose(
    RandomAffine(degrees=(0, 0), scale=(0.75, 1.25))
    RandomPerspective(p=0.4)
    RandomHorizontalFlip(p=0.5)
    ToTensor()
    Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])
)],
 'weight_decay': 0}
Dataloader constructed!
Epoch: 0, batch loss: 0.70979 Loss Sum: 251.20996, accuracy : 0.54266, val loss: 14.63647, val accuracy: 0.74636
Final : 0.8441186078998568 [('val/VGG16/monotone/f1-score', 0.8905660377358491), ('val/VGG16/screenshot/f1-score', 0.8500948766603416), ('val/VGG16/unknown/f1-score', 0.7944688874921433)]
Epoch: 1, batch loss: 0.41910 Loss Sum: 124.13986, accuracy : 0.82930, val loss: 11.66954, val accuracy: 0.79310
Final : 0.8710564372173011 [('val/VGG16/monotone/f1-score', 0.9181494661921707), ('val/VGG16/screenshot/f1-score', 0.8628158844765342), ('val/VGG16/unknown/f1-score', 0.8342714196372732)]
Epoch: 2, batch loss: 0.22023 Loss Sum: 96.67578, accuracy : 0.86119, val loss: 11.22408, val accuracy: 0.79234
Final : 0.8704935386763398 [('val/VGG16/monotone/f1-score', 0.9078014184397163), ('val/VGG16/screenshot/f1-score', 0.8715083798882681), ('val/VGG16/unknown/f1-score', 0.8337468982630273)]
Epoch: 3, batch loss: 0.22901 Loss Sum: 93.47522, accuracy : 0.86490, val loss: 10.27668, val accuracy: 0.80613
Final : 0.8765785846979576 [('val/VGG16/monotone/f1-score', 0.910394265232975), ('val/VGG16/screenshot/f1-score', 0.874074074074074), ('val/VGG16/unknown/f1-score', 0.8464373464373462)]
---train finished---
Trying to save to /tmp/tmpbld1_kmh/model
Too long checkpoint name: VGG16_64_[0.3, 0.2, 0.2, 0.3]_[3, 1]_1.0_0.01_[1.0, 1.0, 1.0, 1.0]_SGD_2_2_0 not saved
Done
VGG16 Loaded!
{'batch_size': 64,
 'class_ratio': [0.3, 0.2, 0.2, 0.3],
 'epoch': [3, 1],
 'gamma': 0.1,
 'learning_rate': 0.0001,
 'loss_cls_weight': tensor([1., 1., 1., 1.]),
 'optimizer': 'SGD',
 'step_size': 2,
 'transforms': [2,
                Compose(
    RandomAffine(degrees=(0, 0), scale=(0.75, 1.25))
    RandomPerspective(p=0.4)
    RandomHorizontalFlip(p=0.5)
    ToTensor()
    Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])
)],
 'weight_decay': 0.001}
Dataloader constructed!
Epoch: 0, batch loss: 1.28281 Loss Sum: 342.30704, accuracy : 0.33556, val loss: 25.94340, val accuracy: 0.51648
Final : 0.24640740697884186 [('val/VGG16/monotone/f1-score', 0.045112781954887216), ('val/VGG16/screenshot/f1-score', 0.4883720930232558), ('val/VGG16/unknown/f1-score', 0.6790641871625676)]
Epoch: 1, batch loss: 1.16879 Loss Sum: 313.34468, accuracy : 0.42989, val loss: 24.04383, val accuracy: 0.50421
Final : 0.0 [('val/VGG16/monotone/f1-score', 0.0), ('val/VGG16/screenshot/f1-score', 0.6958250497017894), ('val/VGG16/unknown/f1-score', 0.6301369863013698)]
Epoch: 2, batch loss: 1.11573 Loss Sum: 298.30604, accuracy : 0.46537, val loss: 23.90866, val accuracy: 0.48736
Final : 0.0 [('val/VGG16/monotone/f1-score', 0.0), ('val/VGG16/screenshot/f1-score', 0.7145557655954631), ('val/VGG16/unknown/f1-score', 0.5995975855130785)]
Epoch: 3, batch loss: 1.16373 Loss Sum: 294.86495, accuracy : 0.47067, val loss: 23.64687, val accuracy: 0.49732
Final : 0.0 [('val/VGG16/monotone/f1-score', 0.0), ('val/VGG16/screenshot/f1-score', 0.7350746268656716), ('val/VGG16/unknown/f1-score', 0.6087542087542088)]
---train finished---
Trying to save to /tmp/tmpakmq1fh3/model
Too long checkpoint name: VGG16_64_[0.3, 0.2, 0.2, 0.3]_[3, 1]_1.0_0.01_[1.0, 1.0, 1.0, 1.0]_SGD_2_2_100.0 not saved
Done
VGG16 Loaded!
{'batch_size': 64,
 'class_ratio': [0.3, 0.2, 0.2, 0.3],
 'epoch': [3, 1],
 'gamma': 0.1,
 'learning_rate': 0.0001,
 'loss_cls_weight': tensor([1.0060, 1.0797, 1.0402, 1.2753]),
 'optimizer': 'Adamax',
 'step_size': 10,
 'transforms': [1,
                Compose(
    ColorJitter(brightness=None, contrast=None, saturation=[0.95, 1.05], hue=[-0.05, 0.05])
    RandomHorizontalFlip(p=0.5)
    RandomRotation(degrees=(-20, 20), resample=2, expand=False)
    ToTensor()
    Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])
)],
 'weight_decay': 0}
Dataloader constructed!
Epoch: 0, batch loss: 0.17367 Loss Sum: 68.41416, accuracy : 0.90184, val loss: 7.41362, val accuracy: 0.86820
Final : 0.9288811161984707 [('val/VGG16/monotone/f1-score', 0.9660377358490566), ('val/VGG16/screenshot/f1-score', 0.921875), ('val/VGG16/unknown/f1-score', 0.8999414862492686)]
Epoch: 1, batch loss: 0.10044 Loss Sum: 36.22892, accuracy : 0.95162, val loss: 7.30361, val accuracy: 0.88582
Final : 0.9401301022605639 [('val/VGG16/monotone/f1-score', 0.9660377358490566), ('val/VGG16/screenshot/f1-score', 0.9407114624505929), ('val/VGG16/unknown/f1-score', 0.9143518518518519)]
Epoch: 2, batch loss: 0.07058 Loss Sum: 24.61640, accuracy : 0.96829, val loss: 6.46618, val accuracy: 0.91188
Final : 0.9429071879293787 [('val/VGG16/monotone/f1-score', 0.9692307692307692), ('val/VGG16/screenshot/f1-score', 0.9254302103250478), ('val/VGG16/unknown/f1-score', 0.9346219442865265)]
Epoch: 3, batch loss: 0.12346 Loss Sum: 16.40935, accuracy : 0.97919, val loss: 7.76344, val accuracy: 0.90421
Final : 0.9393069276442355 [('val/VGG16/monotone/f1-score', 0.9660377358490566), ('val/VGG16/screenshot/f1-score', 0.9242424242424244), ('val/VGG16/unknown/f1-score', 0.9282021826536473)]
---train finished---
Trying to save to /tmp/tmp49kd5to9/model
Too long checkpoint name: VGG16_64_[0.3, 0.2, 0.2, 0.3]_[3, 1]_1.0_0.01_[1.00600004196167, 1.079699993133545, 1.0401999950408936, 1.2753000259399414]_Adamax_10_1_0 not saved
Done
VGG16 Loaded!
{'batch_size': 64,
 'class_ratio': [0.3, 0.2, 0.2, 0.3],
 'epoch': [3, 1],
 'gamma': 0.1,
 'learning_rate': 0.0001,
 'loss_cls_weight': tensor([1.0060, 1.0797, 1.0402, 1.2753]),
 'optimizer': 'Adamax',
 'step_size': 10,
 'transforms': [1,
                Compose(
    ColorJitter(brightness=None, contrast=None, saturation=[0.95, 1.05], hue=[-0.05, 0.05])
    RandomHorizontalFlip(p=0.5)
    RandomRotation(degrees=(-20, 20), resample=2, expand=False)
    ToTensor()
    Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])
)],
 'weight_decay': 0.001}
Dataloader constructed!
Epoch: 0, batch loss: 0.06767 Loss Sum: 71.33257, accuracy : 0.89520, val loss: 4.93065, val accuracy: 0.91648
Final : 0.9427933768706444 [('val/VGG16/monotone/f1-score', 0.9548872180451128), ('val/VGG16/screenshot/f1-score', 0.9351145038167938), ('val/VGG16/unknown/f1-score', 0.9384965831435079)]
Epoch: 1, batch loss: 0.28804 Loss Sum: 38.00221, accuracy : 0.94730, val loss: 4.53329, val accuracy: 0.92644
Final : 0.9470447892222609 [('val/VGG16/monotone/f1-score', 0.9621212121212122), ('val/VGG16/screenshot/f1-score', 0.9328214971209213), ('val/VGG16/unknown/f1-score', 0.9464184997179922)]
Epoch: 2, batch loss: 0.01707 Loss Sum: 25.19579, accuracy : 0.96714, val loss: 6.22179, val accuracy: 0.91264
Final : 0.943137150836472 [('val/VGG16/monotone/f1-score', 0.9621212121212122), ('val/VGG16/screenshot/f1-score', 0.9323308270676692), ('val/VGG16/unknown/f1-score', 0.9352435530085961)]
Epoch: 3, batch loss: 0.07839 Loss Sum: 17.85769, accuracy : 0.97694, val loss: 7.68756, val accuracy: 0.89272
Final : 0.9337633334813911 [('val/VGG16/monotone/f1-score', 0.9477611940298507), ('val/VGG16/screenshot/f1-score', 0.933852140077821), ('val/VGG16/unknown/f1-score', 0.9198847262247838)]
---train finished---
Trying to save to /tmp/tmp9ml_0aom/model
Too long checkpoint name: VGG16_64_[0.3, 0.2, 0.2, 0.3]_[3, 1]_1.0_0.01_[1.00600004196167, 1.079699993133545, 1.0401999950408936, 1.2753000259399414]_Adamax_10_1_100.0 not saved
Done
VGG16 Loaded!
{'batch_size': 64,
 'class_ratio': [0.3, 0.2, 0.2, 0.3],
 'epoch': [3, 1],
 'gamma': 0.1,
 'learning_rate': 0.0001,
 'loss_cls_weight': tensor([1.0060, 1.0797, 1.0402, 1.2753]),
 'optimizer': 'Adamax',
 'step_size': 10,
 'transforms': [2,
                Compose(
    RandomAffine(degrees=(0, 0), scale=(0.75, 1.25))
    RandomPerspective(p=0.4)
    RandomHorizontalFlip(p=0.5)
    ToTensor()
    Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])
)],
 'weight_decay': 0}
Dataloader constructed!
Epoch: 0, batch loss: 0.19282 Loss Sum: 82.55853, accuracy : 0.88291, val loss: 6.98506, val accuracy: 0.87510
Final : 0.9201554892766522 [('val/VGG16/monotone/f1-score', 0.9446494464944649), ('val/VGG16/screenshot/f1-score', 0.9111531190926275), ('val/VGG16/unknown/f1-score', 0.9051522248243559)]
Epoch: 1, batch loss: 0.12979 Loss Sum: 46.92691, accuracy : 0.93525, val loss: 5.46530, val accuracy: 0.91264
Final : 0.9339755398042557 [('val/VGG16/monotone/f1-score', 0.9446494464944649), ('val/VGG16/screenshot/f1-score', 0.9216417910447761), ('val/VGG16/unknown/f1-score', 0.9357798165137615)]
Epoch: 2, batch loss: 0.21714 Loss Sum: 34.85529, accuracy : 0.95156, val loss: 9.94006, val accuracy: 0.85211
Final : 0.9057440814212003 [('val/VGG16/monotone/f1-score', 0.9660377358490566), ('val/VGG16/screenshot/f1-score', 0.8691099476439791), ('val/VGG16/unknown/f1-score', 0.885009030704395)]
Epoch: 3, batch loss: 0.11549 Loss Sum: 26.38578, accuracy : 0.96428, val loss: 7.02335, val accuracy: 0.90498
Final : 0.9364235388570337 [('val/VGG16/monotone/f1-score', 0.9552238805970149), ('val/VGG16/screenshot/f1-score', 0.9245283018867925), ('val/VGG16/unknown/f1-score', 0.9298043728423475)]
---train finished---
Trying to save to /tmp/tmp72hx0onf/model
Too long checkpoint name: VGG16_64_[0.3, 0.2, 0.2, 0.3]_[3, 1]_1.0_0.01_[1.00600004196167, 1.079699993133545, 1.0401999950408936, 1.2753000259399414]_Adamax_10_2_0 not saved
Done
VGG16 Loaded!
{'batch_size': 64,
 'class_ratio': [0.3, 0.2, 0.2, 0.3],
 'epoch': [3, 1],
 'gamma': 0.1,
 'learning_rate': 0.0001,
 'loss_cls_weight': tensor([1.0060, 1.0797, 1.0402, 1.2753]),
 'optimizer': 'Adamax',
 'step_size': 10,
 'transforms': [2,
                Compose(
    RandomAffine(degrees=(0, 0), scale=(0.75, 1.25))
    RandomPerspective(p=0.4)
    RandomHorizontalFlip(p=0.5)
    ToTensor()
    Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])
)],
 'weight_decay': 0.001}
Dataloader constructed!
Epoch: 0, batch loss: 0.26674 Loss Sum: 79.11176, accuracy : 0.88425, val loss: 7.53464, val accuracy: 0.86284
Final : 0.9094012233492897 [('val/VGG16/monotone/f1-score', 0.9142857142857144), ('val/VGG16/screenshot/f1-score', 0.9198473282442747), ('val/VGG16/unknown/f1-score', 0.8942705256940341)]
Epoch: 1, batch loss: 0.04830 Loss Sum: 45.05017, accuracy : 0.93695, val loss: 12.31591, val accuracy: 0.81533
Final : 0.8930626494943356 [('val/VGG16/monotone/f1-score', 0.9485294117647058), ('val/VGG16/screenshot/f1-score', 0.8809946714031972), ('val/VGG16/unknown/f1-score', 0.8523573200992555)]
Epoch: 2, batch loss: 0.15197 Loss Sum: 35.31983, accuracy : 0.95119, val loss: 5.14055, val accuracy: 0.91034
Final : 0.9407276504367846 [('val/VGG16/monotone/f1-score', 0.9615384615384615), ('val/VGG16/screenshot/f1-score', 0.9254901960784313), ('val/VGG16/unknown/f1-score', 0.9355203619909502)]
Epoch: 3, batch loss: 0.02477 Loss Sum: 24.94312, accuracy : 0.96525, val loss: 7.63279, val accuracy: 0.89425
Final : 0.9339863524959134 [('val/VGG16/monotone/f1-score', 0.9516728624535317), ('val/VGG16/screenshot/f1-score', 0.9292543021032504), ('val/VGG16/unknown/f1-score', 0.9212962962962962)]
---train finished---
Trying to save to /tmp/tmp6i10k6gq/model
Too long checkpoint name: VGG16_64_[0.3, 0.2, 0.2, 0.3]_[3, 1]_1.0_0.01_[1.00600004196167, 1.079699993133545, 1.0401999950408936, 1.2753000259399414]_Adamax_10_2_100.0 not saved
Done
VGG16 Loaded!
{'batch_size': 64,
 'class_ratio': [0.3, 0.2, 0.2, 0.3],
 'epoch': [3, 1],
 'gamma': 0.1,
 'learning_rate': 0.0001,
 'loss_cls_weight': tensor([1.0060, 1.0797, 1.0402, 1.2753]),
 'optimizer': 'Adamax',
 'step_size': 2,
 'transforms': [1,
                Compose(
    ColorJitter(brightness=None, contrast=None, saturation=[0.95, 1.05], hue=[-0.05, 0.05])
    RandomHorizontalFlip(p=0.5)
    RandomRotation(degrees=(-20, 20), resample=2, expand=False)
    ToTensor()
    Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])
)],
 'weight_decay': 0}
Dataloader constructed!
Epoch: 0, batch loss: 0.26549 Loss Sum: 68.52259, accuracy : 0.90135, val loss: 4.36776, val accuracy: 0.92031
Final : 0.9396813313749945 [('val/VGG16/monotone/f1-score', 0.9446494464944649), ('val/VGG16/screenshot/f1-score', 0.9335863377609108), ('val/VGG16/unknown/f1-score', 0.9408418657565415)]
Epoch: 1, batch loss: 0.13684 Loss Sum: 36.91417, accuracy : 0.94949, val loss: 3.22745, val accuracy: 0.94866
Final : 0.9487438792525552 [('val/VGG16/monotone/f1-score', 0.9552238805970149), ('val/VGG16/screenshot/f1-score', 0.9284332688588007), ('val/VGG16/unknown/f1-score', 0.9629219701162146)]
Epoch: 2, batch loss: 0.10375 Loss Sum: 22.42739, accuracy : 0.97067, val loss: 6.04355, val accuracy: 0.90651
Final : 0.9419700969629871 [('val/VGG16/monotone/f1-score', 0.9624060150375939), ('val/VGG16/screenshot/f1-score', 0.9333333333333332), ('val/VGG16/unknown/f1-score', 0.9304997128087307)]
Epoch: 3, batch loss: 0.24655 Loss Sum: 19.36995, accuracy : 0.97511, val loss: 5.76665, val accuracy: 0.91418
Final : 0.944046962072204 [('val/VGG16/monotone/f1-score', 0.9588014981273408), ('val/VGG16/screenshot/f1-score', 0.9369024856596558), ('val/VGG16/unknown/f1-score', 0.9366076527698457)]
---train finished---
Trying to save to /tmp/tmp_unm2e4k/model
Too long checkpoint name: VGG16_64_[0.3, 0.2, 0.2, 0.3]_[3, 1]_1.0_0.01_[1.00600004196167, 1.079699993133545, 1.0401999950408936, 1.2753000259399414]_Adamax_2_1_0 not saved
Done
VGG16 Loaded!
{'batch_size': 64,
 'class_ratio': [0.3, 0.2, 0.2, 0.3],
 'epoch': [3, 1],
 'gamma': 0.1,
 'learning_rate': 0.0001,
 'loss_cls_weight': tensor([1.0060, 1.0797, 1.0402, 1.2753]),
 'optimizer': 'Adamax',
 'step_size': 2,
 'transforms': [1,
                Compose(
    ColorJitter(brightness=None, contrast=None, saturation=[0.95, 1.05], hue=[-0.05, 0.05])
    RandomHorizontalFlip(p=0.5)
    RandomRotation(degrees=(-20, 20), resample=2, expand=False)
    ToTensor()
    Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])
)],
 'weight_decay': 0.001}
Dataloader constructed!
Epoch: 0, batch loss: 0.21477 Loss Sum: 71.63016, accuracy : 0.89624, val loss: 6.86941, val accuracy: 0.87280
Final : 0.9234996516183855 [('val/VGG16/monotone/f1-score', 0.9481481481481482), ('val/VGG16/screenshot/f1-score', 0.9204545454545454), ('val/VGG16/unknown/f1-score', 0.9024676850763806)]
Epoch: 1, batch loss: 0.01714 Loss Sum: 35.25575, accuracy : 0.95204, val loss: 9.31362, val accuracy: 0.86667
Final : 0.9282629796669225 [('val/VGG16/monotone/f1-score', 0.9552238805970149), ('val/VGG16/screenshot/f1-score', 0.9335863377609108), ('val/VGG16/unknown/f1-score', 0.8969194312796208)]
Epoch: 2, batch loss: 0.07645 Loss Sum: 21.28297, accuracy : 0.97304, val loss: 5.60026, val accuracy: 0.91188
Final : 0.9480900164953924 [('val/VGG16/monotone/f1-score', 0.9660377358490566), ('val/VGG16/screenshot/f1-score', 0.944337811900192), ('val/VGG16/unknown/f1-score', 0.9341728677733258)]
Epoch: 3, batch loss: 0.17467 Loss Sum: 18.34475, accuracy : 0.97578, val loss: 6.91843, val accuracy: 0.89732
Final : 0.9398669555608664 [('val/VGG16/monotone/f1-score', 0.9660377358490566), ('val/VGG16/screenshot/f1-score', 0.9307692307692308), ('val/VGG16/unknown/f1-score', 0.9233429394812681)]
---train finished---
Trying to save to /tmp/tmpsolioria/model
Too long checkpoint name: VGG16_64_[0.3, 0.2, 0.2, 0.3]_[3, 1]_1.0_0.01_[1.00600004196167, 1.079699993133545, 1.0401999950408936, 1.2753000259399414]_Adamax_2_1_100.0 not saved
Done
VGG16 Loaded!
{'batch_size': 64,
 'class_ratio': [0.3, 0.2, 0.2, 0.3],
 'epoch': [3, 1],
 'gamma': 0.1,
 'learning_rate': 0.0001,
 'loss_cls_weight': tensor([1.0060, 1.0797, 1.0402, 1.2753]),
 'optimizer': 'Adamax',
 'step_size': 2,
 'transforms': [2,
                Compose(
    RandomAffine(degrees=(0, 0), scale=(0.75, 1.25))
    RandomPerspective(p=0.4)
    RandomHorizontalFlip(p=0.5)
    ToTensor()
    Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])
)],
 'weight_decay': 0}
Dataloader constructed!
Epoch: 0, batch loss: 0.16952 Loss Sum: 80.35116, accuracy : 0.88206, val loss: 9.14055, val accuracy: 0.84444
Final : 0.9228433317081702 [('val/VGG16/monotone/f1-score', 0.9660377358490566), ('val/VGG16/screenshot/f1-score', 0.9262759924385634), ('val/VGG16/unknown/f1-score', 0.8783132530120482)]
Epoch: 1, batch loss: 0.27168 Loss Sum: 45.18529, accuracy : 0.93659, val loss: 8.46729, val accuracy: 0.85900
Final : 0.9246507328466823 [('val/VGG16/monotone/f1-score', 0.9624060150375939), ('val/VGG16/screenshot/f1-score', 0.922201138519924), ('val/VGG16/unknown/f1-score', 0.8907363420427553)]
Epoch: 2, batch loss: 0.17892 Loss Sum: 32.49653, accuracy : 0.95710, val loss: 5.79066, val accuracy: 0.90115
Final : 0.9399089951655478 [('val/VGG16/monotone/f1-score', 0.9621212121212122), ('val/VGG16/screenshot/f1-score', 0.9318181818181819), ('val/VGG16/unknown/f1-score', 0.9261822376009228)]
Epoch: 3, batch loss: 0.15263 Loss Sum: 28.81019, accuracy : 0.96239, val loss: 6.82640, val accuracy: 0.89042
Final : 0.9333852683043052 [('val/VGG16/monotone/f1-score', 0.9660377358490566), ('val/VGG16/screenshot/f1-score', 0.9174664107485605), ('val/VGG16/unknown/f1-score', 0.9174841315637622)]
---train finished---
Trying to save to /tmp/tmpekoc3wpw/model
Too long checkpoint name: VGG16_64_[0.3, 0.2, 0.2, 0.3]_[3, 1]_1.0_0.01_[1.00600004196167, 1.079699993133545, 1.0401999950408936, 1.2753000259399414]_Adamax_2_2_0 not saved
Done
VGG16 Loaded!
{'batch_size': 64,
 'class_ratio': [0.3, 0.2, 0.2, 0.3],
 'epoch': [3, 1],
 'gamma': 0.1,
 'learning_rate': 0.0001,
 'loss_cls_weight': tensor([1.0060, 1.0797, 1.0402, 1.2753]),
 'optimizer': 'Adamax',
 'step_size': 2,
 'transforms': [2,
                Compose(
    RandomAffine(degrees=(0, 0), scale=(0.75, 1.25))
    RandomPerspective(p=0.4)
    RandomHorizontalFlip(p=0.5)
    ToTensor()
    Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])
)],
 'weight_decay': 0.001}
Dataloader constructed!
Epoch: 0, batch loss: 0.11442 Loss Sum: 82.86314, accuracy : 0.87713, val loss: 10.12657, val accuracy: 0.81762
Final : 0.8989083446702214 [('val/VGG16/monotone/f1-score', 0.9309090909090909), ('val/VGG16/screenshot/f1-score', 0.9138576779026217), ('val/VGG16/unknown/f1-score', 0.8538083538083538)]
Epoch: 1, batch loss: 0.10487 Loss Sum: 46.16546, accuracy : 0.93421, val loss: 5.68414, val accuracy: 0.89195
Final : 0.9287087232270557 [('val/VGG16/monotone/f1-score', 0.9309090909090909), ('val/VGG16/screenshot/f1-score', 0.9364161849710982), ('val/VGG16/unknown/f1-score', 0.9188876013904983)]
Epoch: 2, batch loss: 0.12599 Loss Sum: 30.91765, accuracy : 0.95880, val loss: 7.22610, val accuracy: 0.88123
Final : 0.9310398866265664 [('val/VGG16/monotone/f1-score', 0.9624060150375939), ('val/VGG16/screenshot/f1-score', 0.9219047619047619), ('val/VGG16/unknown/f1-score', 0.9096209912536443)]
Epoch: 3, batch loss: 0.07872 Loss Sum: 27.31882, accuracy : 0.96215, val loss: 6.43372, val accuracy: 0.88812
Final : 0.9293282808959269 [('val/VGG16/monotone/f1-score', 0.9552238805970149), ('val/VGG16/screenshot/f1-score', 0.9177820267686424), ('val/VGG16/unknown/f1-score', 0.9155092592592592)]
---train finished---
Trying to save to /tmp/tmp8z584r5s/model
Too long checkpoint name: VGG16_64_[0.3, 0.2, 0.2, 0.3]_[3, 1]_1.0_0.01_[1.00600004196167, 1.079699993133545, 1.0401999950408936, 1.2753000259399414]_Adamax_2_2_100.0 not saved
Done
VGG16 Loaded!
{'batch_size': 64,
 'class_ratio': [0.3, 0.2, 0.2, 0.3],
 'epoch': [3, 1],
 'gamma': 0.1,
 'learning_rate': 0.0001,
 'loss_cls_weight': tensor([1.0060, 1.0797, 1.0402, 1.2753]),
 'optimizer': 'Adam',
 'step_size': 10,
 'transforms': [1,
                Compose(
    ColorJitter(brightness=None, contrast=None, saturation=[0.95, 1.05], hue=[-0.05, 0.05])
    RandomHorizontalFlip(p=0.5)
    RandomRotation(degrees=(-20, 20), resample=2, expand=False)
    ToTensor()
    Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])
)],
 'weight_decay': 0}
Dataloader constructed!
Epoch: 0, batch loss: 0.23842 Loss Sum: 74.73761, accuracy : 0.89253, val loss: 6.26610, val accuracy: 0.89655
Final : 0.930809091113326 [('val/VGG16/monotone/f1-score', 0.9624060150375939), ('val/VGG16/screenshot/f1-score', 0.9087591240875913), ('val/VGG16/unknown/f1-score', 0.922093023255814)]
Epoch: 1, batch loss: 0.15527 Loss Sum: 43.67836, accuracy : 0.93878, val loss: 5.12483, val accuracy: 0.91188
Final : 0.9366638321458426 [('val/VGG16/monotone/f1-score', 0.9407407407407407), ('val/VGG16/screenshot/f1-score', 0.9348659003831417), ('val/VGG16/unknown/f1-score', 0.9343981745579006)]
Epoch: 2, batch loss: 0.07740 Loss Sum: 31.84392, accuracy : 0.95758, val loss: 9.07072, val accuracy: 0.86973
Final : 0.9093126489148075 [('val/VGG16/monotone/f1-score', 0.9045936395759718), ('val/VGG16/screenshot/f1-score', 0.9227871939736346), ('val/VGG16/unknown/f1-score', 0.900709219858156)]
Epoch: 3, batch loss: 0.07617 Loss Sum: 29.53467, accuracy : 0.96117, val loss: 6.59312, val accuracy: 0.91034
Final : 0.9423782158473768 [('val/VGG16/monotone/f1-score', 0.9618320610687022), ('val/VGG16/screenshot/f1-score', 0.9320388349514563), ('val/VGG16/unknown/f1-score', 0.9335604770017035)]
---train finished---
Trying to save to /tmp/tmp_dz_jmdh/model
Too long checkpoint name: VGG16_64_[0.3, 0.2, 0.2, 0.3]_[3, 1]_1.0_0.01_[1.00600004196167, 1.079699993133545, 1.0401999950408936, 1.2753000259399414]_Adam_10_1_0 not saved
Done
VGG16 Loaded!
{'batch_size': 64,
 'class_ratio': [0.3, 0.2, 0.2, 0.3],
 'epoch': [3, 1],
 'gamma': 0.1,
 'learning_rate': 0.0001,
 'loss_cls_weight': tensor([1.0060, 1.0797, 1.0402, 1.2753]),
 'optimizer': 'Adam',
 'step_size': 10,
 'transforms': [1,
                Compose(
    ColorJitter(brightness=None, contrast=None, saturation=[0.95, 1.05], hue=[-0.05, 0.05])
    RandomHorizontalFlip(p=0.5)
    RandomRotation(degrees=(-20, 20), resample=2, expand=False)
    ToTensor()
    Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])
)],
 'weight_decay': 0.001}
Dataloader constructed!
Epoch: 0, batch loss: 0.18884 Loss Sum: 73.35009, accuracy : 0.89581, val loss: 7.81951, val accuracy: 0.87969
Final : 0.9234203499887177 [('val/VGG16/monotone/f1-score', 0.9407407407407407), ('val/VGG16/screenshot/f1-score', 0.919626168224299), ('val/VGG16/unknown/f1-score', 0.91015854374633)]
Epoch: 1, batch loss: 0.13519 Loss Sum: 42.94888, accuracy : 0.94225, val loss: 5.21933, val accuracy: 0.91418
Final : 0.9376145777925062 [('val/VGG16/monotone/f1-score', 0.9347826086956522), ('val/VGG16/screenshot/f1-score', 0.9411764705882352), ('val/VGG16/unknown/f1-score', 0.9368959636156907)]
Epoch: 2, batch loss: 0.04965 Loss Sum: 33.60056, accuracy : 0.95527, val loss: 11.72787, val accuracy: 0.82222
Final : 0.9136503633907012 [('val/VGG16/monotone/f1-score', 0.9694656488549618), ('val/VGG16/screenshot/f1-score', 0.9155722326454032), ('val/VGG16/unknown/f1-score', 0.8592411260709915)]
Epoch: 3, batch loss: 0.07021 Loss Sum: 30.18452, accuracy : 0.95868, val loss: 6.67074, val accuracy: 0.89885
Final : 0.9378072216055101 [('val/VGG16/monotone/f1-score', 0.9652509652509652), ('val/VGG16/screenshot/f1-score', 0.9224952741020795), ('val/VGG16/unknown/f1-score', 0.9262672811059907)]
---train finished---
Trying to save to /tmp/tmp0nm9vquy/model
Too long checkpoint name: VGG16_64_[0.3, 0.2, 0.2, 0.3]_[3, 1]_1.0_0.01_[1.00600004196167, 1.079699993133545, 1.0401999950408936, 1.2753000259399414]_Adam_10_1_100.0 not saved
Done
VGG16 Loaded!
{'batch_size': 64,
 'class_ratio': [0.3, 0.2, 0.2, 0.3],
 'epoch': [3, 1],
 'gamma': 0.1,
 'learning_rate': 0.0001,
 'loss_cls_weight': tensor([1.0060, 1.0797, 1.0402, 1.2753]),
 'optimizer': 'Adam',
 'step_size': 10,
 'transforms': [2,
                Compose(
    RandomAffine(degrees=(0, 0), scale=(0.75, 1.25))
    RandomPerspective(p=0.4)
    RandomHorizontalFlip(p=0.5)
    ToTensor()
    Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])
)],
 'weight_decay': 0}
Dataloader constructed!
Epoch: 0, batch loss: 0.33840 Loss Sum: 81.67803, accuracy : 0.88261, val loss: 6.12757, val accuracy: 0.89272
Final : 0.9273752657801211 [('val/VGG16/monotone/f1-score', 0.9588014981273408), ('val/VGG16/screenshot/f1-score', 0.9051094890510949), ('val/VGG16/unknown/f1-score', 0.9190448456610367)]
Epoch: 1, batch loss: 0.14237 Loss Sum: 52.37427, accuracy : 0.92673, val loss: 5.04985, val accuracy: 0.91954
Final : 0.943716361202255 [('val/VGG16/monotone/f1-score', 0.9584905660377359), ('val/VGG16/screenshot/f1-score', 0.9320754716981131), ('val/VGG16/unknown/f1-score', 0.9407744874715261)]
Epoch: 2, batch loss: 0.25365 Loss Sum: 40.46912, accuracy : 0.94572, val loss: 8.01829, val accuracy: 0.87893
Final : 0.9142537522677722 [('val/VGG16/monotone/f1-score', 0.9446494464944649), ('val/VGG16/screenshot/f1-score', 0.891651865008881), ('val/VGG16/unknown/f1-score', 0.9072652096869462)]
Epoch: 3, batch loss: 0.05051 Loss Sum: 32.24351, accuracy : 0.95582, val loss: 6.77872, val accuracy: 0.89195
Final : 0.9189435086764977 [('val/VGG16/monotone/f1-score', 0.9309090909090909), ('val/VGG16/screenshot/f1-score', 0.9080882352941176), ('val/VGG16/unknown/f1-score', 0.9179755671902268)]
---train finished---
Trying to save to /tmp/tmpfpu47284/model
Too long checkpoint name: VGG16_64_[0.3, 0.2, 0.2, 0.3]_[3, 1]_1.0_0.01_[1.00600004196167, 1.079699993133545, 1.0401999950408936, 1.2753000259399414]_Adam_10_2_0 not saved
Done
VGG16 Loaded!
{'batch_size': 64,
 'class_ratio': [0.3, 0.2, 0.2, 0.3],
 'epoch': [3, 1],
 'gamma': 0.1,
 'learning_rate': 0.0001,
 'loss_cls_weight': tensor([1.0060, 1.0797, 1.0402, 1.2753]),
 'optimizer': 'Adam',
 'step_size': 10,
 'transforms': [2,
                Compose(
    RandomAffine(degrees=(0, 0), scale=(0.75, 1.25))
    RandomPerspective(p=0.4)
    RandomHorizontalFlip(p=0.5)
    ToTensor()
    Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])
)],
 'weight_decay': 0.001}
Dataloader constructed!
Epoch: 0, batch loss: 0.23014 Loss Sum: 85.37204, accuracy : 0.87208, val loss: 9.39701, val accuracy: 0.83678
Final : 0.8925458817998451 [('val/VGG16/monotone/f1-score', 0.9181494661921707), ('val/VGG16/screenshot/f1-score', 0.8892921960072595), ('val/VGG16/unknown/f1-score', 0.8708308065494239)]
Epoch: 1, batch loss: 0.17034 Loss Sum: 52.80309, accuracy : 0.92679, val loss: 6.45192, val accuracy: 0.87893
Final : 0.9308706737063327 [('val/VGG16/monotone/f1-score', 0.9581749049429658), ('val/VGG16/screenshot/f1-score', 0.9265536723163842), ('val/VGG16/unknown/f1-score', 0.9085580304806564)]
Epoch: 2, batch loss: 0.05936 Loss Sum: 44.23835, accuracy : 0.93872, val loss: 6.03844, val accuracy: 0.90115
Final : 0.9343273129512071 [('val/VGG16/monotone/f1-score', 0.9347826086956522), ('val/VGG16/screenshot/f1-score', 0.9420849420849421), ('val/VGG16/unknown/f1-score', 0.9261822376009228)]
Epoch: 3, batch loss: 0.03856 Loss Sum: 37.34916, accuracy : 0.94852, val loss: 9.47626, val accuracy: 0.86360
Final : 0.8901855221480589 [('val/VGG16/monotone/f1-score', 0.8403908794788273), ('val/VGG16/screenshot/f1-score', 0.9384615384615383), ('val/VGG16/unknown/f1-score', 0.8944246737841044)]
---train finished---
Trying to save to /tmp/tmpx825grvj/model
Too long checkpoint name: VGG16_64_[0.3, 0.2, 0.2, 0.3]_[3, 1]_1.0_0.01_[1.00600004196167, 1.079699993133545, 1.0401999950408936, 1.2753000259399414]_Adam_10_2_100.0 not saved
Done
VGG16 Loaded!
{'batch_size': 64,
 'class_ratio': [0.3, 0.2, 0.2, 0.3],
 'epoch': [3, 1],
 'gamma': 0.1,
 'learning_rate': 0.0001,
 'loss_cls_weight': tensor([1.0060, 1.0797, 1.0402, 1.2753]),
 'optimizer': 'Adam',
 'step_size': 2,
 'transforms': [1,
                Compose(
    ColorJitter(brightness=None, contrast=None, saturation=[0.95, 1.05], hue=[-0.05, 0.05])
    RandomHorizontalFlip(p=0.5)
    RandomRotation(degrees=(-20, 20), resample=2, expand=False)
    ToTensor()
    Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])
)],
 'weight_decay': 0}
Dataloader constructed!
Epoch: 0, batch loss: 0.11051 Loss Sum: 74.53257, accuracy : 0.89411, val loss: 5.86315, val accuracy: 0.89579
Final : 0.9306425771232196 [('val/VGG16/monotone/f1-score', 0.9407407407407407), ('val/VGG16/screenshot/f1-score', 0.9282868525896414), ('val/VGG16/unknown/f1-score', 0.9229891614375356)]
Epoch: 1, batch loss: 0.19520 Loss Sum: 40.76690, accuracy : 0.94444, val loss: 9.45709, val accuracy: 0.85977
Final : 0.9208860365082716 [('val/VGG16/monotone/f1-score', 0.9516728624535317), ('val/VGG16/screenshot/f1-score', 0.9211009174311927), ('val/VGG16/unknown/f1-score', 0.8908872901678657)]
Epoch: 2, batch loss: 0.00616 Loss Sum: 19.01005, accuracy : 0.97517, val loss: 6.63525, val accuracy: 0.91418
Final : 0.9477362655874405 [('val/VGG16/monotone/f1-score', 0.9655172413793104), ('val/VGG16/screenshot/f1-score', 0.9407265774378586), ('val/VGG16/unknown/f1-score', 0.9372146118721462)]
Epoch: 3, batch loss: 0.05909 Loss Sum: 13.44682, accuracy : 0.98326, val loss: 7.11839, val accuracy: 0.91341
Final : 0.9495904592253873 [('val/VGG16/monotone/f1-score', 0.9660377358490566), ('val/VGG16/screenshot/f1-score', 0.9473684210526315), ('val/VGG16/unknown/f1-score', 0.9356125356125357)]
---train finished---
Trying to save to /tmp/tmp09558eg5/model
Too long checkpoint name: VGG16_64_[0.3, 0.2, 0.2, 0.3]_[3, 1]_1.0_0.01_[1.00600004196167, 1.079699993133545, 1.0401999950408936, 1.2753000259399414]_Adam_2_1_0 not saved
Done
VGG16 Loaded!
{'batch_size': 64,
 'class_ratio': [0.3, 0.2, 0.2, 0.3],
 'epoch': [3, 1],
 'gamma': 0.1,
 'learning_rate': 0.0001,
 'loss_cls_weight': tensor([1.0060, 1.0797, 1.0402, 1.2753]),
 'optimizer': 'Adam',
 'step_size': 2,
 'transforms': [1,
                Compose(
    ColorJitter(brightness=None, contrast=None, saturation=[0.95, 1.05], hue=[-0.05, 0.05])
    RandomHorizontalFlip(p=0.5)
    RandomRotation(degrees=(-20, 20), resample=2, expand=False)
    ToTensor()
    Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])
)],
 'weight_decay': 0.001}
Dataloader constructed!
Epoch: 0, batch loss: 0.20918 Loss Sum: 74.73320, accuracy : 0.89435, val loss: 8.80964, val accuracy: 0.84444
Final : 0.9245678898859063 [('val/VGG16/monotone/f1-score', 0.9621212121212122), ('val/VGG16/screenshot/f1-score', 0.9351145038167938), ('val/VGG16/unknown/f1-score', 0.8784596871239471)]
Epoch: 1, batch loss: 0.30005 Loss Sum: 42.60991, accuracy : 0.94352, val loss: 4.58220, val accuracy: 0.92261
Final : 0.9424495267768734 [('val/VGG16/monotone/f1-score', 0.9552238805970149), ('val/VGG16/screenshot/f1-score', 0.9295238095238095), ('val/VGG16/unknown/f1-score', 0.9427762039660056)]
Epoch: 2, batch loss: 0.02581 Loss Sum: 19.27645, accuracy : 0.97627, val loss: 7.10077, val accuracy: 0.90498
Final : 0.9477684217258009 [('val/VGG16/monotone/f1-score', 0.9729729729729729), ('val/VGG16/screenshot/f1-score', 0.9402697495183046), ('val/VGG16/unknown/f1-score', 0.9305794606999427)]
Epoch: 3, batch loss: 0.03815 Loss Sum: 14.09037, accuracy : 0.98186, val loss: 7.91103, val accuracy: 0.89962
Final : 0.9474617573786879 [('val/VGG16/monotone/f1-score', 0.9655172413793104), ('val/VGG16/screenshot/f1-score', 0.951830443159923), ('val/VGG16/unknown/f1-score', 0.925476603119584)]
---train finished---
Trying to save to /tmp/tmp5bf4j6xr/model
Too long checkpoint name: VGG16_64_[0.3, 0.2, 0.2, 0.3]_[3, 1]_1.0_0.01_[1.00600004196167, 1.079699993133545, 1.0401999950408936, 1.2753000259399414]_Adam_2_1_100.0 not saved
Done
VGG16 Loaded!
{'batch_size': 64,
 'class_ratio': [0.3, 0.2, 0.2, 0.3],
 'epoch': [3, 1],
 'gamma': 0.1,
 'learning_rate': 0.0001,
 'loss_cls_weight': tensor([1.0060, 1.0797, 1.0402, 1.2753]),
 'optimizer': 'Adam',
 'step_size': 2,
 'transforms': [2,
                Compose(
    RandomAffine(degrees=(0, 0), scale=(0.75, 1.25))
    RandomPerspective(p=0.4)
    RandomHorizontalFlip(p=0.5)
    ToTensor()
    Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])
)],
 'weight_decay': 0}
Dataloader constructed!
Epoch: 0, batch loss: 0.16710 Loss Sum: 84.71965, accuracy : 0.88029, val loss: 7.24334, val accuracy: 0.87126
Final : 0.9263917959131859 [('val/VGG16/monotone/f1-score', 0.9621212121212122), ('val/VGG16/screenshot/f1-score', 0.915057915057915), ('val/VGG16/unknown/f1-score', 0.9030373831775701)]
Epoch: 1, batch loss: 0.27807 Loss Sum: 49.93628, accuracy : 0.92928, val loss: 3.79578, val accuracy: 0.93793
Final : 0.9494202080838846 [('val/VGG16/monotone/f1-score', 0.9584905660377359), ('val/VGG16/screenshot/f1-score', 0.935361216730038), ('val/VGG16/unknown/f1-score', 0.9545709478407178)]
Epoch: 2, batch loss: 0.08655 Loss Sum: 28.75440, accuracy : 0.96130, val loss: 5.87896, val accuracy: 0.90115
Final : 0.936467841593654 [('val/VGG16/monotone/f1-score', 0.9696969696969696), ('val/VGG16/screenshot/f1-score', 0.9146110056925997), ('val/VGG16/unknown/f1-score', 0.9259896729776247)]
Epoch: 3, batch loss: 0.08249 Loss Sum: 22.30807, accuracy : 0.97158, val loss: 6.83312, val accuracy: 0.90805
Final : 0.9504873068808929 [('val/VGG16/monotone/f1-score', 0.9769230769230769), ('val/VGG16/screenshot/f1-score', 0.9436893203883494), ('val/VGG16/unknown/f1-score', 0.9314285714285715)]
---train finished---
Trying to save to /tmp/tmp3umkd_26/model
Too long checkpoint name: VGG16_64_[0.3, 0.2, 0.2, 0.3]_[3, 1]_1.0_0.01_[1.00600004196167, 1.079699993133545, 1.0401999950408936, 1.2753000259399414]_Adam_2_2_0 not saved
Done
VGG16 Loaded!
{'batch_size': 64,
 'class_ratio': [0.3, 0.2, 0.2, 0.3],
 'epoch': [3, 1],
 'gamma': 0.1,
 'learning_rate': 0.0001,
 'loss_cls_weight': tensor([1.0060, 1.0797, 1.0402, 1.2753]),
 'optimizer': 'Adam',
 'step_size': 2,
 'transforms': [2,
                Compose(
    RandomAffine(degrees=(0, 0), scale=(0.75, 1.25))
    RandomPerspective(p=0.4)
    RandomHorizontalFlip(p=0.5)
    ToTensor()
    Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])
)],
 'weight_decay': 0.001}
Dataloader constructed!
Epoch: 0, batch loss: 0.18811 Loss Sum: 82.70028, accuracy : 0.87774, val loss: 7.78885, val accuracy: 0.86820
Final : 0.9192730866462181 [('val/VGG16/monotone/f1-score', 0.9578544061302682), ('val/VGG16/screenshot/f1-score', 0.9009009009009009), ('val/VGG16/unknown/f1-score', 0.9002375296912114)]
Epoch: 1, batch loss: 0.32048 Loss Sum: 53.87574, accuracy : 0.92594, val loss: 7.60395, val accuracy: 0.87126
Final : 0.9107725207031119 [('val/VGG16/monotone/f1-score', 0.8951048951048951), ('val/VGG16/screenshot/f1-score', 0.935672514619883), ('val/VGG16/unknown/f1-score', 0.9020527859237537)]
Epoch: 2, batch loss: 0.15818 Loss Sum: 29.63994, accuracy : 0.96081, val loss: 5.55750, val accuracy: 0.90651
Final : 0.945094521552237 [('val/VGG16/monotone/f1-score', 0.9694656488549618), ('val/VGG16/screenshot/f1-score', 0.9359223300970874), ('val/VGG16/unknown/f1-score', 0.930365296803653)]
Epoch: 3, batch loss: 0.04183 Loss Sum: 21.81652, accuracy : 0.97152, val loss: 7.27784, val accuracy: 0.89119
Final : 0.9441792321302402 [('val/VGG16/monotone/f1-score', 0.9694656488549618), ('val/VGG16/screenshot/f1-score', 0.9453125), ('val/VGG16/unknown/f1-score', 0.91844997108155)]
---train finished---
Trying to save to /tmp/tmpq7ye1z7n/model
Too long checkpoint name: VGG16_64_[0.3, 0.2, 0.2, 0.3]_[3, 1]_1.0_0.01_[1.00600004196167, 1.079699993133545, 1.0401999950408936, 1.2753000259399414]_Adam_2_2_100.0 not saved
Done
VGG16 Loaded!
{'batch_size': 64,
 'class_ratio': [0.3, 0.2, 0.2, 0.3],
 'epoch': [3, 1],
 'gamma': 0.1,
 'learning_rate': 0.0001,
 'loss_cls_weight': tensor([1.0060, 1.0797, 1.0402, 1.2753]),
 'optimizer': 'SGD',
 'step_size': 10,
 'transforms': [1,
                Compose(
    ColorJitter(brightness=None, contrast=None, saturation=[0.95, 1.05], hue=[-0.05, 0.05])
    RandomHorizontalFlip(p=0.5)
    RandomRotation(degrees=(-20, 20), resample=2, expand=False)
    ToTensor()
    Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])
)],
 'weight_decay': 0}
Dataloader constructed!
Epoch: 0, batch loss: 0.51862 Loss Sum: 245.20288, accuracy : 0.56524, val loss: 12.33354, val accuracy: 0.79540
Final : 0.8495695069677106 [('val/VGG16/monotone/f1-score', 0.8551724137931035), ('val/VGG16/screenshot/f1-score', 0.8555347091932457), ('val/VGG16/unknown/f1-score', 0.8381185094685402)]
Epoch: 1, batch loss: 0.48804 Loss Sum: 110.18955, accuracy : 0.84518, val loss: 9.50707, val accuracy: 0.84521
Final : 0.8920520408790467 [('val/VGG16/monotone/f1-score', 0.9130434782608695), ('val/VGG16/screenshot/f1-score', 0.8840579710144927), ('val/VGG16/unknown/f1-score', 0.8794241151769646)]
Epoch: 2, batch loss: 0.18191 Loss Sum: 79.19212, accuracy : 0.88516, val loss: 7.44664, val accuracy: 0.86437
Final : 0.9039743697317405 [('val/VGG16/monotone/f1-score', 0.9309090909090909), ('val/VGG16/screenshot/f1-score', 0.88468809073724), ('val/VGG16/unknown/f1-score', 0.8969555035128806)]
Epoch: 3, batch loss: 0.14620 Loss Sum: 68.23587, accuracy : 0.90208, val loss: 6.82747, val accuracy: 0.87433
Final : 0.9111444267320153 [('val/VGG16/monotone/f1-score', 0.9304029304029303), ('val/VGG16/screenshot/f1-score', 0.8984962406015037), ('val/VGG16/unknown/f1-score', 0.9048453006421483)]
---train finished---
Trying to save to /tmp/tmp_i3ga9de/model
Too long checkpoint name: VGG16_64_[0.3, 0.2, 0.2, 0.3]_[3, 1]_1.0_0.01_[1.00600004196167, 1.079699993133545, 1.0401999950408936, 1.2753000259399414]_SGD_10_1_0 not saved
Done
VGG16 Loaded!
{'batch_size': 64,
 'class_ratio': [0.3, 0.2, 0.2, 0.3],
 'epoch': [3, 1],
 'gamma': 0.1,
 'learning_rate': 0.0001,
 'loss_cls_weight': tensor([1.0060, 1.0797, 1.0402, 1.2753]),
 'optimizer': 'SGD',
 'step_size': 10,
 'transforms': [1,
                Compose(
    ColorJitter(brightness=None, contrast=None, saturation=[0.95, 1.05], hue=[-0.05, 0.05])
    RandomHorizontalFlip(p=0.5)
    RandomRotation(degrees=(-20, 20), resample=2, expand=False)
    ToTensor()
    Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])
)],
 'weight_decay': 0.001}
Dataloader constructed!
Epoch: 0, batch loss: 0.48767 Loss Sum: 249.49679, accuracy : 0.55495, val loss: 12.91835, val accuracy: 0.76705
Final : 0.8436233263675924 [('val/VGG16/monotone/f1-score', 0.8668941979522184), ('val/VGG16/screenshot/f1-score', 0.8532818532818532), ('val/VGG16/unknown/f1-score', 0.8116842759477937)]
Epoch: 1, batch loss: 0.32083 Loss Sum: 109.99016, accuracy : 0.85060, val loss: 7.98004, val accuracy: 0.86897
Final : 0.8988179420897149 [('val/VGG16/monotone/f1-score', 0.910394265232975), ('val/VGG16/screenshot/f1-score', 0.8868613138686132), ('val/VGG16/unknown/f1-score', 0.8993525603296056)]
Epoch: 2, batch loss: 0.24743 Loss Sum: 76.72984, accuracy : 0.89186, val loss: 8.11519, val accuracy: 0.86360
Final : 0.9050727669688479 [('val/VGG16/monotone/f1-score', 0.9181494661921707), ('val/VGG16/screenshot/f1-score', 0.9023941068139965), ('val/VGG16/unknown/f1-score', 0.894830659536542)]
Epoch: 3, batch loss: 0.30533 Loss Sum: 65.57615, accuracy : 0.91005, val loss: 6.28229, val accuracy: 0.89195
Final : 0.9147311750886761 [('val/VGG16/monotone/f1-score', 0.9264705882352942), ('val/VGG16/screenshot/f1-score', 0.8986615678776291), ('val/VGG16/unknown/f1-score', 0.9192902117916428)]
---train finished---
Trying to save to /tmp/tmpuoqmadyj/model
Too long checkpoint name: VGG16_64_[0.3, 0.2, 0.2, 0.3]_[3, 1]_1.0_0.01_[1.00600004196167, 1.079699993133545, 1.0401999950408936, 1.2753000259399414]_SGD_10_1_100.0 not saved
Done
VGG16 Loaded!
{'batch_size': 64,
 'class_ratio': [0.3, 0.2, 0.2, 0.3],
 'epoch': [3, 1],
 'gamma': 0.1,
 'learning_rate': 0.0001,
 'loss_cls_weight': tensor([1.0060, 1.0797, 1.0402, 1.2753]),
 'optimizer': 'SGD',
 'step_size': 10,
 'transforms': [2,
                Compose(
    RandomAffine(degrees=(0, 0), scale=(0.75, 1.25))
    RandomPerspective(p=0.4)
    RandomHorizontalFlip(p=0.5)
    ToTensor()
    Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])
)],
 'weight_decay': 0}
Dataloader constructed!
Epoch: 0, batch loss: 1.30668 Loss Sum: 341.25685, accuracy : 0.33459, val loss: 25.50070, val accuracy: 0.51724
Final : 0.0 [('val/VGG16/monotone/f1-score', 0.0), ('val/VGG16/screenshot/f1-score', 0.5349794238683129), ('val/VGG16/unknown/f1-score', 0.6578153289076645)]
Epoch: 1, batch loss: 1.17489 Loss Sum: 312.96801, accuracy : 0.41602, val loss: 22.48473, val accuracy: 0.66207
Final : 0.0 [('val/VGG16/monotone/f1-score', 0.0), ('val/VGG16/screenshot/f1-score', 0.6736401673640168), ('val/VGG16/unknown/f1-score', 0.7738029719317556)]
Epoch: 2, batch loss: 1.13459 Loss Sum: 285.10065, accuracy : 0.46038, val loss: 20.11427, val accuracy: 0.67816
Final : 0.0 [('val/VGG16/monotone/f1-score', 0.0), ('val/VGG16/screenshot/f1-score', 0.7916666666666666), ('val/VGG16/unknown/f1-score', 0.77389811104751)]
Epoch: 3, batch loss: 0.94715 Loss Sum: 261.54914, accuracy : 0.48381, val loss: 18.63261, val accuracy: 0.68046
Final : 0.0 [('val/VGG16/monotone/f1-score', 0.0), ('val/VGG16/screenshot/f1-score', 0.816793893129771), ('val/VGG16/unknown/f1-score', 0.7738231917336394)]
---train finished---
Trying to save to /tmp/tmp7i1zi5bl/model
Too long checkpoint name: VGG16_64_[0.3, 0.2, 0.2, 0.3]_[3, 1]_1.0_0.01_[1.00600004196167, 1.079699993133545, 1.0401999950408936, 1.2753000259399414]_SGD_10_2_0 not saved
Done
VGG16 Loaded!
{'batch_size': 64,
 'class_ratio': [0.3, 0.2, 0.2, 0.3],
 'epoch': [3, 1],
 'gamma': 0.1,
 'learning_rate': 0.0001,
 'loss_cls_weight': tensor([1.0060, 1.0797, 1.0402, 1.2753]),
 'optimizer': 'SGD',
 'step_size': 10,
 'transforms': [2,
                Compose(
    RandomAffine(degrees=(0, 0), scale=(0.75, 1.25))
    RandomPerspective(p=0.4)
    RandomHorizontalFlip(p=0.5)
    ToTensor()
    Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])
)],
 'weight_decay': 0.001}
Dataloader constructed!
Epoch: 0, batch loss: 0.18400 Loss Sum: 190.35974, accuracy : 0.66784, val loss: 10.63138, val accuracy: 0.78697
Final : 0.8603209550784264 [('val/VGG16/monotone/f1-score', 0.8975265017667844), ('val/VGG16/screenshot/f1-score', 0.8571428571428571), ('val/VGG16/unknown/f1-score', 0.8277153558052435)]
Epoch: 1, batch loss: 0.19945 Loss Sum: 73.08317, accuracy : 0.89606, val loss: 6.55517, val accuracy: 0.88506
Final : 0.9228414063564548 [('val/VGG16/monotone/f1-score', 0.9481481481481482), ('val/VGG16/screenshot/f1-score', 0.9073724007561437), ('val/VGG16/unknown/f1-score', 0.9135229251305861)]
Epoch: 2, batch loss: 0.08847 Loss Sum: 56.55533, accuracy : 0.91997, val loss: 5.67905, val accuracy: 0.90575
Final : 0.9367239039324168 [('val/VGG16/monotone/f1-score', 0.9657794676806083), ('val/VGG16/screenshot/f1-score', 0.9138276553106213), ('val/VGG16/unknown/f1-score', 0.9313063063063063)]
Epoch: 3, batch loss: 0.17043 Loss Sum: 48.66372, accuracy : 0.93178, val loss: 6.20085, val accuracy: 0.89195
Final : 0.9335231186507118 [('val/VGG16/monotone/f1-score', 0.9581749049429658), ('val/VGG16/screenshot/f1-score', 0.922201138519924), ('val/VGG16/unknown/f1-score', 0.9206716850028951)]
---train finished---
Trying to save to /tmp/tmpuobw7hyq/model
Too long checkpoint name: VGG16_64_[0.3, 0.2, 0.2, 0.3]_[3, 1]_1.0_0.01_[1.00600004196167, 1.079699993133545, 1.0401999950408936, 1.2753000259399414]_SGD_10_2_100.0 not saved
Done
VGG16 Loaded!
{'batch_size': 64,
 'class_ratio': [0.3, 0.2, 0.2, 0.3],
 'epoch': [3, 1],
 'gamma': 0.1,
 'learning_rate': 0.0001,
 'loss_cls_weight': tensor([1.0060, 1.0797, 1.0402, 1.2753]),
 'optimizer': 'SGD',
 'step_size': 2,
 'transforms': [1,
                Compose(
    ColorJitter(brightness=None, contrast=None, saturation=[0.95, 1.05], hue=[-0.05, 0.05])
    RandomHorizontalFlip(p=0.5)
    RandomRotation(degrees=(-20, 20), resample=2, expand=False)
    ToTensor()
    Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])
)],
 'weight_decay': 0}
Dataloader constructed!
Epoch: 0, batch loss: 0.50959 Loss Sum: 248.35175, accuracy : 0.54716, val loss: 13.18003, val accuracy: 0.77395
Final : 0.8454326991188774 [('val/VGG16/monotone/f1-score', 0.8631578947368421), ('val/VGG16/screenshot/f1-score', 0.8543689320388349), ('val/VGG16/unknown/f1-score', 0.8194103194103195)]
Epoch: 1, batch loss: 0.43529 Loss Sum: 111.92317, accuracy : 0.84530, val loss: 7.11981, val accuracy: 0.88123
Final : 0.9094767897395774 [('val/VGG16/monotone/f1-score', 0.9343065693430657), ('val/VGG16/screenshot/f1-score', 0.8847583643122676), ('val/VGG16/unknown/f1-score', 0.910040626813697)]
Epoch: 2, batch loss: 0.35697 Loss Sum: 86.78868, accuracy : 0.87427, val loss: 9.33689, val accuracy: 0.84981
Final : 0.8999482163316306 [('val/VGG16/monotone/f1-score', 0.9304029304029303), ('val/VGG16/screenshot/f1-score', 0.8851224105461394), ('val/VGG16/unknown/f1-score', 0.8850710900473934)]
Epoch: 3, batch loss: 0.38819 Loss Sum: 82.40179, accuracy : 0.88303, val loss: 8.32071, val accuracy: 0.84674
Final : 0.8899482675308312 [('val/VGG16/monotone/f1-score', 0.9097472924187726), ('val/VGG16/screenshot/f1-score', 0.8775894538606404), ('val/VGG16/unknown/f1-score', 0.8828402366863906)]
---train finished---
Trying to save to /tmp/tmp_x_h3rpn/model
Too long checkpoint name: VGG16_64_[0.3, 0.2, 0.2, 0.3]_[3, 1]_1.0_0.01_[1.00600004196167, 1.079699993133545, 1.0401999950408936, 1.2753000259399414]_SGD_2_1_0 not saved
Done
VGG16 Loaded!
{'batch_size': 64,
 'class_ratio': [0.3, 0.2, 0.2, 0.3],
 'epoch': [3, 1],
 'gamma': 0.1,
 'learning_rate': 0.0001,
 'loss_cls_weight': tensor([1.0060, 1.0797, 1.0402, 1.2753]),
 'optimizer': 'SGD',
 'step_size': 2,
 'transforms': [1,
                Compose(
    ColorJitter(brightness=None, contrast=None, saturation=[0.95, 1.05], hue=[-0.05, 0.05])
    RandomHorizontalFlip(p=0.5)
    RandomRotation(degrees=(-20, 20), resample=2, expand=False)
    ToTensor()
    Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])
)],
 'weight_decay': 0.001}
Dataloader constructed!
Epoch: 0, batch loss: 1.29417 Loss Sum: 342.99980, accuracy : 0.32832, val loss: 25.43740, val accuracy: 0.55709
Final : 0.2103994653162747 [('val/VGG16/monotone/f1-score', 0.0303030303030303), ('val/VGG16/screenshot/f1-score', 0.4329896907216495), ('val/VGG16/unknown/f1-score', 0.7098560354374308)]
Epoch: 1, batch loss: 1.21326 Loss Sum: 317.55733, accuracy : 0.39514, val loss: 22.86836, val accuracy: 0.67739
Final : 0.0 [('val/VGG16/monotone/f1-score', 0.0), ('val/VGG16/screenshot/f1-score', 0.6602409638554217), ('val/VGG16/unknown/f1-score', 0.7896405919661732)]
Epoch: 2, batch loss: 1.14727 Loss Sum: 304.03772, accuracy : 0.42935, val loss: 22.66899, val accuracy: 0.67663
Final : 0.28667986000962264 [('val/VGG16/monotone/f1-score', 0.04545454545454545), ('val/VGG16/screenshot/f1-score', 0.6538461538461537), ('val/VGG16/unknown/f1-score', 0.7927543953116676)]
Epoch: 3, batch loss: 1.24811 Loss Sum: 301.90221, accuracy : 0.42947, val loss: 22.51638, val accuracy: 0.68889
Final : 0.25556928924989514 [('val/VGG16/monotone/f1-score', 0.030534351145038167), ('val/VGG16/screenshot/f1-score', 0.6837209302325581), ('val/VGG16/unknown/f1-score', 0.7995735607675906)]
---train finished---
Trying to save to /tmp/tmp7m0vltxf/model
Too long checkpoint name: VGG16_64_[0.3, 0.2, 0.2, 0.3]_[3, 1]_1.0_0.01_[1.00600004196167, 1.079699993133545, 1.0401999950408936, 1.2753000259399414]_SGD_2_1_100.0 not saved
Done
VGG16 Loaded!
{'batch_size': 64,
 'class_ratio': [0.3, 0.2, 0.2, 0.3],
 'epoch': [3, 1],
 'gamma': 0.1,
 'learning_rate': 0.0001,
 'loss_cls_weight': tensor([1.0060, 1.0797, 1.0402, 1.2753]),
 'optimizer': 'SGD',
 'step_size': 2,
 'transforms': [2,
                Compose(
    RandomAffine(degrees=(0, 0), scale=(0.75, 1.25))
    RandomPerspective(p=0.4)
    RandomHorizontalFlip(p=0.5)
    ToTensor()
    Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])
)],
 'weight_decay': 0}
Dataloader constructed!
Epoch: 0, batch loss: 1.30190 Loss Sum: 340.52497, accuracy : 0.31207, val loss: 25.18811, val accuracy: 0.56935
Final : 0.0 [('val/VGG16/monotone/f1-score', 0.0), ('val/VGG16/screenshot/f1-score', 0.36962025316455693), ('val/VGG16/unknown/f1-score', 0.729450190528035)]
Epoch: 1, batch loss: 1.21450 Loss Sum: 316.78598, accuracy : 0.38084, val loss: 22.96867, val accuracy: 0.62452
Final : 0.0 [('val/VGG16/monotone/f1-score', 0.0), ('val/VGG16/screenshot/f1-score', 0.6090909090909091), ('val/VGG16/unknown/f1-score', 0.7508269018743109)]
Epoch: 2, batch loss: 1.18583 Loss Sum: 303.45984, accuracy : 0.42162, val loss: 22.65914, val accuracy: 0.64904
Final : 0.0 [('val/VGG16/monotone/f1-score', 0.0), ('val/VGG16/screenshot/f1-score', 0.6863636363636364), ('val/VGG16/unknown/f1-score', 0.769485903814262)]
Epoch: 3, batch loss: 1.10261 Loss Sum: 300.71766, accuracy : 0.42782, val loss: 22.31184, val accuracy: 0.66054
Final : 0.0 [('val/VGG16/monotone/f1-score', 0.0), ('val/VGG16/screenshot/f1-score', 0.6742081447963801), ('val/VGG16/unknown/f1-score', 0.7809419496166484)]
---train finished---
Trying to save to /tmp/tmpxjc3aoln/model
Too long checkpoint name: VGG16_64_[0.3, 0.2, 0.2, 0.3]_[3, 1]_1.0_0.01_[1.00600004196167, 1.079699993133545, 1.0401999950408936, 1.2753000259399414]_SGD_2_2_0 not saved
Done
VGG16 Loaded!
{'batch_size': 64,
 'class_ratio': [0.3, 0.2, 0.2, 0.3],
 'epoch': [3, 1],
 'gamma': 0.1,
 'learning_rate': 0.0001,
 'loss_cls_weight': tensor([1.0060, 1.0797, 1.0402, 1.2753]),
 'optimizer': 'SGD',
 'step_size': 2,
 'transforms': [2,
                Compose(
    RandomAffine(degrees=(0, 0), scale=(0.75, 1.25))
    RandomPerspective(p=0.4)
    RandomHorizontalFlip(p=0.5)
    ToTensor()
    Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])
)],
 'weight_decay': 0.001}
Dataloader constructed!
Epoch: 0, batch loss: 1.29416 Loss Sum: 343.12126, accuracy : 0.31627, val loss: 25.54280, val accuracy: 0.52031
Final : 0.0 [('val/VGG16/monotone/f1-score', 0.0), ('val/VGG16/screenshot/f1-score', 0.327683615819209), ('val/VGG16/unknown/f1-score', 0.6954087346024637)]
Epoch: 1, batch loss: 1.16213 Loss Sum: 315.08363, accuracy : 0.38486, val loss: 22.81102, val accuracy: 0.62912
Final : 0.0 [('val/VGG16/monotone/f1-score', 0.0), ('val/VGG16/screenshot/f1-score', 0.6527777777777778), ('val/VGG16/unknown/f1-score', 0.7509663169519603)]
Epoch: 2, batch loss: 1.13906 Loss Sum: 300.45049, accuracy : 0.43105, val loss: 22.41414, val accuracy: 0.66207
Final : 0.0 [('val/VGG16/monotone/f1-score', 0.0), ('val/VGG16/screenshot/f1-score', 0.7320261437908497), ('val/VGG16/unknown/f1-score', 0.7759197324414716)]
Epoch: 3, batch loss: 1.17556 Loss Sum: 298.14995, accuracy : 0.44079, val loss: 22.31239, val accuracy: 0.65211
Final : 0.0 [('val/VGG16/monotone/f1-score', 0.0), ('val/VGG16/screenshot/f1-score', 0.717062634989201), ('val/VGG16/unknown/f1-score', 0.7632311977715877)]
---train finished---
Trying to save to /tmp/tmpop6ykvl_/model
Too long checkpoint name: VGG16_64_[0.3, 0.2, 0.2, 0.3]_[3, 1]_1.0_0.01_[1.00600004196167, 1.079699993133545, 1.0401999950408936, 1.2753000259399414]_SGD_2_2_100.0 not saved
Done
VGG16 Loaded!
{'batch_size': 64,
 'class_ratio': [0.3, 0.2, 0.2, 0.3],
 'epoch': [3, 1],
 'gamma': 0.1,
 'learning_rate': 1e-06,
 'loss_cls_weight': tensor([1., 1., 1., 1.]),
 'optimizer': 'Adamax',
 'step_size': 10,
 'transforms': [1,
                Compose(
    ColorJitter(brightness=None, contrast=None, saturation=[0.95, 1.05], hue=[-0.05, 0.05])
    RandomHorizontalFlip(p=0.5)
    RandomRotation(degrees=(-20, 20), resample=2, expand=False)
    ToTensor()
    Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])
)],
 'weight_decay': 0}
Dataloader constructed!
Epoch: 0, batch loss: 1.01535 Loss Sum: 313.36706, accuracy : 0.44718, val loss: 21.88301, val accuracy: 0.57011
Final : 0.5265754257830826 [('val/VGG16/monotone/f1-score', 0.28), ('val/VGG16/screenshot/f1-score', 0.7721280602636534), ('val/VGG16/unknown/f1-score', 0.6753585397653195)]
Epoch: 1, batch loss: 0.81589 Loss Sum: 230.73255, accuracy : 0.65153, val loss: 17.02424, val accuracy: 0.64904
Final : 0.7965937705941568 [('val/VGG16/monotone/f1-score', 0.8734693877551021), ('val/VGG16/screenshot/f1-score', 0.8264150943396227), ('val/VGG16/unknown/f1-score', 0.700268817204301)]
Epoch: 2, batch loss: 0.80873 Loss Sum: 170.28686, accuracy : 0.77696, val loss: 14.09594, val accuracy: 0.73410
Final : 0.8317038460009136 [('val/VGG16/monotone/f1-score', 0.8896797153024911), ('val/VGG16/screenshot/f1-score', 0.8286252354048964), ('val/VGG16/unknown/f1-score', 0.7803946530872055)]
Epoch: 3, batch loss: 0.41001 Loss Sum: 137.52199, accuracy : 0.80641, val loss: 12.61947, val accuracy: 0.75402
Final : 0.84480309124407 [('val/VGG16/monotone/f1-score', 0.8758620689655173), ('val/VGG16/screenshot/f1-score', 0.8640595903165735), ('val/VGG16/unknown/f1-score', 0.7966857871255577)]
---train finished---
Trying to save to /tmp/tmpvwy8rpr3/model
Too long checkpoint name: VGG16_64_[0.3, 0.2, 0.2, 0.3]_[3, 1]_1.0_9.999999999999999e-05_[1.0, 1.0, 1.0, 1.0]_Adamax_10_1_0 not saved
Done
VGG16 Loaded!
{'batch_size': 64,
 'class_ratio': [0.3, 0.2, 0.2, 0.3],
 'epoch': [3, 1],
 'gamma': 0.1,
 'learning_rate': 1e-06,
 'loss_cls_weight': tensor([1., 1., 1., 1.]),
 'optimizer': 'Adamax',
 'step_size': 10,
 'transforms': [1,
                Compose(
    ColorJitter(brightness=None, contrast=None, saturation=[0.95, 1.05], hue=[-0.05, 0.05])
    RandomHorizontalFlip(p=0.5)
    RandomRotation(degrees=(-20, 20), resample=2, expand=False)
    ToTensor()
    Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])
)],
 'weight_decay': 0.001}
Dataloader constructed!
Epoch: 0, batch loss: 1.09417 Loss Sum: 311.79724, accuracy : 0.44127, val loss: 22.26110, val accuracy: 0.52797
Final : 0.580589038159062 [('val/VGG16/monotone/f1-score', 0.4121212121212121), ('val/VGG16/screenshot/f1-score', 0.764), ('val/VGG16/unknown/f1-score', 0.6215673141326189)]
Epoch: 1, batch loss: 0.91965 Loss Sum: 228.98911, accuracy : 0.65464, val loss: 17.68958, val accuracy: 0.61762
Final : 0.7708966671091505 [('val/VGG16/monotone/f1-score', 0.8536585365853658), ('val/VGG16/screenshot/f1-score', 0.8022388059701493), ('val/VGG16/unknown/f1-score', 0.6689607708189952)]
Epoch: 2, batch loss: 0.61567 Loss Sum: 168.42033, accuracy : 0.77769, val loss: 14.13205, val accuracy: 0.74406
Final : 0.8315429650350916 [('val/VGG16/monotone/f1-score', 0.8571428571428571), ('val/VGG16/screenshot/f1-score', 0.8507462686567163), ('val/VGG16/unknown/f1-score', 0.7884984025559105)]
Epoch: 3, batch loss: 0.37668 Loss Sum: 135.97425, accuracy : 0.81110, val loss: 12.71371, val accuracy: 0.75402
Final : 0.8334463363790189 [('val/VGG16/monotone/f1-score', 0.8456375838926175), ('val/VGG16/screenshot/f1-score', 0.8576779026217228), ('val/VGG16/unknown/f1-score', 0.7982233502538072)]
---train finished---
Trying to save to /tmp/tmpalzhsp0l/model
Too long checkpoint name: VGG16_64_[0.3, 0.2, 0.2, 0.3]_[3, 1]_1.0_9.999999999999999e-05_[1.0, 1.0, 1.0, 1.0]_Adamax_10_1_100.0 not saved
Done
VGG16 Loaded!
{'batch_size': 64,
 'class_ratio': [0.3, 0.2, 0.2, 0.3],
 'epoch': [3, 1],
 'gamma': 0.1,
 'learning_rate': 1e-06,
 'loss_cls_weight': tensor([1., 1., 1., 1.]),
 'optimizer': 'Adamax',
 'step_size': 10,
 'transforms': [2,
                Compose(
    RandomAffine(degrees=(0, 0), scale=(0.75, 1.25))
    RandomPerspective(p=0.4)
    RandomHorizontalFlip(p=0.5)
    ToTensor()
    Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])
)],
 'weight_decay': 0}
Dataloader constructed!
Epoch: 0, batch loss: 1.09690 Loss Sum: 318.66426, accuracy : 0.40914, val loss: 23.19779, val accuracy: 0.45441
Final : 0.0 [('val/VGG16/monotone/f1-score', 0.0), ('val/VGG16/screenshot/f1-score', 0.749063670411985), ('val/VGG16/unknown/f1-score', 0.5531315974665728)]
Epoch: 1, batch loss: 0.85758 Loss Sum: 249.32220, accuracy : 0.53335, val loss: 18.79285, val accuracy: 0.55862
Final : 0.5593810643600291 [('val/VGG16/monotone/f1-score', 0.33548387096774196), ('val/VGG16/screenshot/f1-score', 0.8139963167587477), ('val/VGG16/unknown/f1-score', 0.6409574468085106)]
Epoch: 2, batch loss: 0.75931 Loss Sum: 207.16102, accuracy : 0.66322, val loss: 16.54235, val accuracy: 0.68199
Final : 0.8065540459706885 [('val/VGG16/monotone/f1-score', 0.8558951965065502), ('val/VGG16/screenshot/f1-score', 0.8248587570621468), ('val/VGG16/unknown/f1-score', 0.7431906614785991)]
Epoch: 3, batch loss: 0.47113 Loss Sum: 178.03468, accuracy : 0.77075, val loss: 14.72021, val accuracy: 0.74330
Final : 0.8558145946809455 [('val/VGG16/monotone/f1-score', 0.9358490566037736), ('val/VGG16/screenshot/f1-score', 0.8480300187617261), ('val/VGG16/unknown/f1-score', 0.7898089171974523)]
---train finished---
Trying to save to /tmp/tmpultzn9mk/model
Too long checkpoint name: VGG16_64_[0.3, 0.2, 0.2, 0.3]_[3, 1]_1.0_9.999999999999999e-05_[1.0, 1.0, 1.0, 1.0]_Adamax_10_2_0 not saved
Done
VGG16 Loaded!
{'batch_size': 64,
 'class_ratio': [0.3, 0.2, 0.2, 0.3],
 'epoch': [3, 1],
 'gamma': 0.1,
 'learning_rate': 1e-06,
 'loss_cls_weight': tensor([1., 1., 1., 1.]),
 'optimizer': 'Adamax',
 'step_size': 10,
 'transforms': [2,
                Compose(
    RandomAffine(degrees=(0, 0), scale=(0.75, 1.25))
    RandomPerspective(p=0.4)
    RandomHorizontalFlip(p=0.5)
    ToTensor()
    Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])
)],
 'weight_decay': 0.001}
Dataloader constructed!
Epoch: 0, batch loss: 1.16729 Loss Sum: 316.14279, accuracy : 0.42642, val loss: 22.79327, val accuracy: 0.47739
Final : 0.4045705003453622 [('val/VGG16/monotone/f1-score', 0.15714285714285714), ('val/VGG16/screenshot/f1-score', 0.745583038869258), ('val/VGG16/unknown/f1-score', 0.5651867512332628)]
Epoch: 1, batch loss: 0.82414 Loss Sum: 247.78307, accuracy : 0.55483, val loss: 19.23654, val accuracy: 0.55556
Final : 0.6773972425743607 [('val/VGG16/monotone/f1-score', 0.6492146596858639), ('val/VGG16/screenshot/f1-score', 0.7725631768953067), ('val/VGG16/unknown/f1-score', 0.6197377501725327)]
Epoch: 2, batch loss: 0.83380 Loss Sum: 205.34075, accuracy : 0.68726, val loss: 16.66057, val accuracy: 0.68582
Final : 0.8126788397847565 [('val/VGG16/monotone/f1-score', 0.8813559322033898), ('val/VGG16/screenshot/f1-score', 0.8228782287822879), ('val/VGG16/unknown/f1-score', 0.7400651465798045)]
Epoch: 3, batch loss: 0.58844 Loss Sum: 174.62391, accuracy : 0.77045, val loss: 15.52791, val accuracy: 0.71571
Final : 0.8378272945394062 [('val/VGG16/monotone/f1-score', 0.9323308270676692), ('val/VGG16/screenshot/f1-score', 0.8274582560296846), ('val/VGG16/unknown/f1-score', 0.7623376623376623)]
---train finished---
Trying to save to /tmp/tmp5_bm00pd/model
Too long checkpoint name: VGG16_64_[0.3, 0.2, 0.2, 0.3]_[3, 1]_1.0_9.999999999999999e-05_[1.0, 1.0, 1.0, 1.0]_Adamax_10_2_100.0 not saved
Done
VGG16 Loaded!
{'batch_size': 64,
 'class_ratio': [0.3, 0.2, 0.2, 0.3],
 'epoch': [3, 1],
 'gamma': 0.1,
 'learning_rate': 1e-06,
 'loss_cls_weight': tensor([1., 1., 1., 1.]),
 'optimizer': 'Adamax',
 'step_size': 2,
 'transforms': [1,
                Compose(
    ColorJitter(brightness=None, contrast=None, saturation=[0.95, 1.05], hue=[-0.05, 0.05])
    RandomHorizontalFlip(p=0.5)
    RandomRotation(degrees=(-20, 20), resample=2, expand=False)
    ToTensor()
    Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])
)],
 'weight_decay': 0}
Dataloader constructed!
Epoch: 0, batch loss: 1.04767 Loss Sum: 317.74691, accuracy : 0.45308, val loss: 23.36950, val accuracy: 0.47969
Final : 0.5488877634654304 [('val/VGG16/monotone/f1-score', 0.38271604938271603), ('val/VGG16/screenshot/f1-score', 0.7677902621722847), ('val/VGG16/unknown/f1-score', 0.5627705627705627)]
Epoch: 1, batch loss: 0.74337 Loss Sum: 232.86202, accuracy : 0.66066, val loss: 17.72552, val accuracy: 0.64674
Final : 0.805758122840985 [('val/VGG16/monotone/f1-score', 0.921259842519685), ('val/VGG16/screenshot/f1-score', 0.8210922787193974), ('val/VGG16/unknown/f1-score', 0.6915760869565217)]
Epoch: 2, batch loss: 0.72566 Loss Sum: 193.66592, accuracy : 0.74544, val loss: 17.16707, val accuracy: 0.66743
Final : 0.801955936540815 [('val/VGG16/monotone/f1-score', 0.8740157480314961), ('val/VGG16/screenshot/f1-score', 0.8174904942965779), ('val/VGG16/unknown/f1-score', 0.7218543046357616)]
Epoch: 3, batch loss: 0.73450 Loss Sum: 187.57911, accuracy : 0.75889, val loss: 16.89190, val accuracy: 0.66743
Final : 0.8125592887632191 [('val/VGG16/monotone/f1-score', 0.9007633587786259), ('val/VGG16/screenshot/f1-score', 0.8342857142857143), ('val/VGG16/unknown/f1-score', 0.7139037433155081)]
---train finished---
Trying to save to /tmp/tmpzgk422yj/model
Too long checkpoint name: VGG16_64_[0.3, 0.2, 0.2, 0.3]_[3, 1]_1.0_9.999999999999999e-05_[1.0, 1.0, 1.0, 1.0]_Adamax_2_1_0 not saved
Done
VGG16 Loaded!
{'batch_size': 64,
 'class_ratio': [0.3, 0.2, 0.2, 0.3],
 'epoch': [3, 1],
 'gamma': 0.1,
 'learning_rate': 1e-06,
 'loss_cls_weight': tensor([1., 1., 1., 1.]),
 'optimizer': 'Adamax',
 'step_size': 2,
 'transforms': [1,
                Compose(
    ColorJitter(brightness=None, contrast=None, saturation=[0.95, 1.05], hue=[-0.05, 0.05])
    RandomHorizontalFlip(p=0.5)
    RandomRotation(degrees=(-20, 20), resample=2, expand=False)
    ToTensor()
    Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])
)],
 'weight_decay': 0.001}
Dataloader constructed!
Epoch: 0, batch loss: 1.12802 Loss Sum: 316.48794, accuracy : 0.42216, val loss: 22.63538, val accuracy: 0.51571
Final : 0.4460118676652524 [('val/VGG16/monotone/f1-score', 0.18309859154929578), ('val/VGG16/screenshot/f1-score', 0.7751004016064258), ('val/VGG16/unknown/f1-score', 0.6251673360107095)]
Epoch: 1, batch loss: 0.74163 Loss Sum: 232.01322, accuracy : 0.63954, val loss: 17.30560, val accuracy: 0.67050
Final : 0.8039820516290446 [('val/VGG16/monotone/f1-score', 0.8582995951417005), ('val/VGG16/screenshot/f1-score', 0.8364312267657992), ('val/VGG16/unknown/f1-score', 0.7238855622089156)]
Epoch: 2, batch loss: 0.79120 Loss Sum: 192.53581, accuracy : 0.74531, val loss: 17.32274, val accuracy: 0.64981
Final : 0.7987323777685769 [('val/VGG16/monotone/f1-score', 0.8906249999999999), ('val/VGG16/screenshot/f1-score', 0.8230912476722533), ('val/VGG16/unknown/f1-score', 0.6951219512195121)]
Epoch: 3, batch loss: 0.75583 Loss Sum: 185.80365, accuracy : 0.76010, val loss: 16.28729, val accuracy: 0.68736
Final : 0.8230585897564654 [('val/VGG16/monotone/f1-score', 0.8823529411764707), ('val/VGG16/screenshot/f1-score', 0.8625235404896422), ('val/VGG16/unknown/f1-score', 0.732620320855615)]
---train finished---
Trying to save to /tmp/tmpy3ee_bg_/model
Too long checkpoint name: VGG16_64_[0.3, 0.2, 0.2, 0.3]_[3, 1]_1.0_9.999999999999999e-05_[1.0, 1.0, 1.0, 1.0]_Adamax_2_1_100.0 not saved
Done
VGG16 Loaded!
{'batch_size': 64,
 'class_ratio': [0.3, 0.2, 0.2, 0.3],
 'epoch': [3, 1],
 'gamma': 0.1,
 'learning_rate': 1e-06,
 'loss_cls_weight': tensor([1., 1., 1., 1.]),
 'optimizer': 'Adamax',
 'step_size': 2,
 'transforms': [2,
                Compose(
    RandomAffine(degrees=(0, 0), scale=(0.75, 1.25))
    RandomPerspective(p=0.4)
    RandomHorizontalFlip(p=0.5)
    ToTensor()
    Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])
)],
 'weight_decay': 0}
Dataloader constructed!
Epoch: 0, batch loss: 1.10325 Loss Sum: 322.46467, accuracy : 0.41072, val loss: 23.49977, val accuracy: 0.46130
Final : 0.3738458668200239 [('val/VGG16/monotone/f1-score', 0.13043478260869565), ('val/VGG16/screenshot/f1-score', 0.7234042553191489), ('val/VGG16/unknown/f1-score', 0.5537366548042705)]
Epoch: 1, batch loss: 0.90411 Loss Sum: 249.82576, accuracy : 0.56396, val loss: 19.22296, val accuracy: 0.56322
Final : 0.6254053134947792 [('val/VGG16/monotone/f1-score', 0.47337278106508873), ('val/VGG16/screenshot/f1-score', 0.8079710144927535), ('val/VGG16/unknown/f1-score', 0.6395663956639566)]
Epoch: 2, batch loss: 0.87148 Loss Sum: 221.80449, accuracy : 0.62275, val loss: 18.94023, val accuracy: 0.56015
Final : 0.6524466892002403 [('val/VGG16/monotone/f1-score', 0.5666666666666667), ('val/VGG16/screenshot/f1-score', 0.7745454545454546), ('val/VGG16/unknown/f1-score', 0.6327913279132792)]
Epoch: 3, batch loss: 0.87641 Loss Sum: 218.23070, accuracy : 0.63668, val loss: 18.61656, val accuracy: 0.57088
Final : 0.6638129024312371 [('val/VGG16/monotone/f1-score', 0.5714285714285714), ('val/VGG16/screenshot/f1-score', 0.7963302752293578), ('val/VGG16/unknown/f1-score', 0.6428089128966914)]
---train finished---
Trying to save to /tmp/tmp_lxyvrsm/model
Too long checkpoint name: VGG16_64_[0.3, 0.2, 0.2, 0.3]_[3, 1]_1.0_9.999999999999999e-05_[1.0, 1.0, 1.0, 1.0]_Adamax_2_2_0 not saved
Done
VGG16 Loaded!
{'batch_size': 64,
 'class_ratio': [0.3, 0.2, 0.2, 0.3],
 'epoch': [3, 1],
 'gamma': 0.1,
 'learning_rate': 1e-06,
 'loss_cls_weight': tensor([1., 1., 1., 1.]),
 'optimizer': 'Adamax',
 'step_size': 2,
 'transforms': [2,
                Compose(
    RandomAffine(degrees=(0, 0), scale=(0.75, 1.25))
    RandomPerspective(p=0.4)
    RandomHorizontalFlip(p=0.5)
    ToTensor()
    Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])
)],
 'weight_decay': 0.001}
Dataloader constructed!
Epoch: 0, batch loss: 1.14084 Loss Sum: 314.62436, accuracy : 0.40689, val loss: 23.50701, val accuracy: 0.37318
Final : 0.2453989295298133 [('val/VGG16/monotone/f1-score', 0.04545454545454545), ('val/VGG16/screenshot/f1-score', 0.7320754716981134), ('val/VGG16/unknown/f1-score', 0.444104134762634)]
Epoch: 1, batch loss: 0.89643 Loss Sum: 246.98545, accuracy : 0.54199, val loss: 19.26871, val accuracy: 0.53027
Final : 0.5902168338387537 [('val/VGG16/monotone/f1-score', 0.43373493975903615), ('val/VGG16/screenshot/f1-score', 0.787878787878788), ('val/VGG16/unknown/f1-score', 0.6016597510373444)]
Epoch: 2, batch loss: 1.03019 Loss Sum: 219.82589, accuracy : 0.62001, val loss: 18.93723, val accuracy: 0.56475
Final : 0.6765292403174074 [('val/VGG16/monotone/f1-score', 0.6096256684491979), ('val/VGG16/screenshot/f1-score', 0.8086642599277979), ('val/VGG16/unknown/f1-score', 0.6280991735537191)]
Epoch: 3, batch loss: 0.84908 Loss Sum: 216.73317, accuracy : 0.63705, val loss: 18.64602, val accuracy: 0.57701
Final : 0.674160167600678 [('val/VGG16/monotone/f1-score', 0.5824175824175825), ('val/VGG16/screenshot/f1-score', 0.8145454545454546), ('val/VGG16/unknown/f1-score', 0.6458616010854816)]
---train finished---
Trying to save to /tmp/tmpwpooyqdv/model
Too long checkpoint name: VGG16_64_[0.3, 0.2, 0.2, 0.3]_[3, 1]_1.0_9.999999999999999e-05_[1.0, 1.0, 1.0, 1.0]_Adamax_2_2_100.0 not saved
Done
VGG16 Loaded!
{'batch_size': 64,
 'class_ratio': [0.3, 0.2, 0.2, 0.3],
 'epoch': [3, 1],
 'gamma': 0.1,
 'learning_rate': 1e-06,
 'loss_cls_weight': tensor([1., 1., 1., 1.]),
 'optimizer': 'Adam',
 'step_size': 10,
 'transforms': [1,
                Compose(
    ColorJitter(brightness=None, contrast=None, saturation=[0.95, 1.05], hue=[-0.05, 0.05])
    RandomHorizontalFlip(p=0.5)
    RandomRotation(degrees=(-20, 20), resample=2, expand=False)
    ToTensor()
    Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])
)],
 'weight_decay': 0}
Dataloader constructed!
Epoch: 0, batch loss: 0.52387 Loss Sum: 238.03079, accuracy : 0.64021, val loss: 13.84696, val accuracy: 0.72874
Final : 0.8201181949166239 [('val/VGG16/monotone/f1-score', 0.8410596026490067), ('val/VGG16/screenshot/f1-score', 0.8479087452471483), ('val/VGG16/unknown/f1-score', 0.7734877734877734)]
Epoch: 1, batch loss: 0.22698 Loss Sum: 106.18072, accuracy : 0.84847, val loss: 9.24572, val accuracy: 0.83295
Final : 0.8803510577180418 [('val/VGG16/monotone/f1-score', 0.8992805755395683), ('val/VGG16/screenshot/f1-score', 0.8703703703703703), ('val/VGG16/unknown/f1-score', 0.8717026378896883)]
Epoch: 2, batch loss: 0.33033 Loss Sum: 78.68485, accuracy : 0.88285, val loss: 8.71751, val accuracy: 0.83448
Final : 0.8915394041141547 [('val/VGG16/monotone/f1-score', 0.9181494661921707), ('val/VGG16/screenshot/f1-score', 0.8859315589353612), ('val/VGG16/unknown/f1-score', 0.8711803475134811)]
Epoch: 3, batch loss: 0.26636 Loss Sum: 67.39917, accuracy : 0.90196, val loss: 7.96907, val accuracy: 0.84981
Final : 0.9066403869811763 [('val/VGG16/monotone/f1-score', 0.9202898550724637), ('val/VGG16/screenshot/f1-score', 0.9153846153846155), ('val/VGG16/unknown/f1-score', 0.8846611177170036)]
---train finished---
Trying to save to /tmp/tmp6d4fl1b7/model
Too long checkpoint name: VGG16_64_[0.3, 0.2, 0.2, 0.3]_[3, 1]_1.0_9.999999999999999e-05_[1.0, 1.0, 1.0, 1.0]_Adam_10_1_0 not saved
Done
VGG16 Loaded!
{'batch_size': 64,
 'class_ratio': [0.3, 0.2, 0.2, 0.3],
 'epoch': [3, 1],
 'gamma': 0.1,
 'learning_rate': 1e-06,
 'loss_cls_weight': tensor([1., 1., 1., 1.]),
 'optimizer': 'Adam',
 'step_size': 10,
 'transforms': [1,
                Compose(
    ColorJitter(brightness=None, contrast=None, saturation=[0.95, 1.05], hue=[-0.05, 0.05])
    RandomHorizontalFlip(p=0.5)
    RandomRotation(degrees=(-20, 20), resample=2, expand=False)
    ToTensor()
    Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])
)],
 'weight_decay': 0.001}
Dataloader constructed!
Epoch: 0, batch loss: 0.47395 Loss Sum: 235.88678, accuracy : 0.63072, val loss: 12.98689, val accuracy: 0.74253
Final : 0.8210676240755878 [('val/VGG16/monotone/f1-score', 0.840677966101695), ('val/VGG16/screenshot/f1-score', 0.8326848249027237), ('val/VGG16/unknown/f1-score', 0.7907268170426065)]
Epoch: 1, batch loss: 0.30684 Loss Sum: 106.74675, accuracy : 0.84786, val loss: 10.10113, val accuracy: 0.81762
Final : 0.8850161662529097 [('val/VGG16/monotone/f1-score', 0.910394265232975), ('val/VGG16/screenshot/f1-score', 0.8905109489051095), ('val/VGG16/unknown/f1-score', 0.855036855036855)]
Epoch: 2, batch loss: 0.23979 Loss Sum: 79.41611, accuracy : 0.88729, val loss: 7.88085, val accuracy: 0.85670
Final : 0.9008340101984639 [('val/VGG16/monotone/f1-score', 0.9136690647482014), ('val/VGG16/screenshot/f1-score', 0.8977272727272727), ('val/VGG16/unknown/f1-score', 0.8912529550827424)]
Epoch: 3, batch loss: 0.27846 Loss Sum: 67.86145, accuracy : 0.90433, val loss: 8.26524, val accuracy: 0.84981
Final : 0.9049402795506352 [('val/VGG16/monotone/f1-score', 0.9338235294117646), ('val/VGG16/screenshot/f1-score', 0.8966789667896681), ('val/VGG16/unknown/f1-score', 0.8850299401197604)]
---train finished---
Trying to save to /tmp/tmp_39tnifq/model
Too long checkpoint name: VGG16_64_[0.3, 0.2, 0.2, 0.3]_[3, 1]_1.0_9.999999999999999e-05_[1.0, 1.0, 1.0, 1.0]_Adam_10_1_100.0 not saved
Done
VGG16 Loaded!
{'batch_size': 64,
 'class_ratio': [0.3, 0.2, 0.2, 0.3],
 'epoch': [3, 1],
 'gamma': 0.1,
 'learning_rate': 1e-06,
 'loss_cls_weight': tensor([1., 1., 1., 1.]),
 'optimizer': 'Adam',
 'step_size': 10,
 'transforms': [2,
                Compose(
    RandomAffine(degrees=(0, 0), scale=(0.75, 1.25))
    RandomPerspective(p=0.4)
    RandomHorizontalFlip(p=0.5)
    ToTensor()
    Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])
)],
 'weight_decay': 0}
Dataloader constructed!
Epoch: 0, batch loss: 0.62108 Loss Sum: 253.91433, accuracy : 0.55848, val loss: 15.30777, val accuracy: 0.71724
Final : 0.8297753896610276 [('val/VGG16/monotone/f1-score', 0.8951612903225806), ('val/VGG16/screenshot/f1-score', 0.8270676691729324), ('val/VGG16/unknown/f1-score', 0.7716836734693878)]
Epoch: 1, batch loss: 0.58462 Loss Sum: 130.73841, accuracy : 0.82936, val loss: 10.59040, val accuracy: 0.80153
Final : 0.8738420774403332 [('val/VGG16/monotone/f1-score', 0.9078014184397163), ('val/VGG16/screenshot/f1-score', 0.8733944954128441), ('val/VGG16/unknown/f1-score', 0.8415841584158417)]
Epoch: 2, batch loss: 0.19482 Loss Sum: 93.04301, accuracy : 0.86776, val loss: 8.74870, val accuracy: 0.85824
Final : 0.9055337937278901 [('val/VGG16/monotone/f1-score', 0.9275362318840579), ('val/VGG16/screenshot/f1-score', 0.8983364140480592), ('val/VGG16/unknown/f1-score', 0.8911362284354551)]
Epoch: 3, batch loss: 0.21320 Loss Sum: 77.24054, accuracy : 0.89003, val loss: 8.53649, val accuracy: 0.85364
Final : 0.9084265076826629 [('val/VGG16/monotone/f1-score', 0.9446494464944649), ('val/VGG16/screenshot/f1-score', 0.8934579439252337), ('val/VGG16/unknown/f1-score', 0.8882282996432818)]
---train finished---
Trying to save to /tmp/tmp5ei5dh2h/model
Too long checkpoint name: VGG16_64_[0.3, 0.2, 0.2, 0.3]_[3, 1]_1.0_9.999999999999999e-05_[1.0, 1.0, 1.0, 1.0]_Adam_10_2_0 not saved
Done
VGG16 Loaded!
{'batch_size': 64,
 'class_ratio': [0.3, 0.2, 0.2, 0.3],
 'epoch': [3, 1],
 'gamma': 0.1,
 'learning_rate': 1e-06,
 'loss_cls_weight': tensor([1., 1., 1., 1.]),
 'optimizer': 'Adam',
 'step_size': 10,
 'transforms': [2,
                Compose(
    RandomAffine(degrees=(0, 0), scale=(0.75, 1.25))
    RandomPerspective(p=0.4)
    RandomHorizontalFlip(p=0.5)
    ToTensor()
    Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])
)],
 'weight_decay': 0.001}
Dataloader constructed!
Epoch: 0, batch loss: 0.62361 Loss Sum: 256.92506, accuracy : 0.55836, val loss: 15.40644, val accuracy: 0.73410
Final : 0.8311951327500691 [('val/VGG16/monotone/f1-score', 0.897119341563786), ('val/VGG16/screenshot/f1-score', 0.8074766355140187), ('val/VGG16/unknown/f1-score', 0.7927363807138385)]
Epoch: 1, batch loss: 0.61215 Loss Sum: 135.24329, accuracy : 0.82461, val loss: 11.14478, val accuracy: 0.79004
Final : 0.863720750882738 [('val/VGG16/monotone/f1-score', 0.900709219858156), ('val/VGG16/screenshot/f1-score', 0.8608058608058607), ('val/VGG16/unknown/f1-score', 0.831055900621118)]
Epoch: 2, batch loss: 0.35857 Loss Sum: 93.46572, accuracy : 0.86843, val loss: 9.03319, val accuracy: 0.84138
Final : 0.8879122608254852 [('val/VGG16/monotone/f1-score', 0.907142857142857), ('val/VGG16/screenshot/f1-score', 0.8786764705882354), ('val/VGG16/unknown/f1-score', 0.8782243551289742)]
Epoch: 3, batch loss: 0.20618 Loss Sum: 80.54532, accuracy : 0.88328, val loss: 9.57833, val accuracy: 0.83525
Final : 0.8954282337897814 [('val/VGG16/monotone/f1-score', 0.9338235294117646), ('val/VGG16/screenshot/f1-score', 0.8819188191881918), ('val/VGG16/unknown/f1-score', 0.8717639975918122)]
---train finished---
Trying to save to /tmp/tmp4u5v4z1w/model
Too long checkpoint name: VGG16_64_[0.3, 0.2, 0.2, 0.3]_[3, 1]_1.0_9.999999999999999e-05_[1.0, 1.0, 1.0, 1.0]_Adam_10_2_100.0 not saved
Done
VGG16 Loaded!
{'batch_size': 64,
 'class_ratio': [0.3, 0.2, 0.2, 0.3],
 'epoch': [3, 1],
 'gamma': 0.1,
 'learning_rate': 1e-06,
 'loss_cls_weight': tensor([1., 1., 1., 1.]),
 'optimizer': 'Adam',
 'step_size': 2,
 'transforms': [1,
                Compose(
    ColorJitter(brightness=None, contrast=None, saturation=[0.95, 1.05], hue=[-0.05, 0.05])
    RandomHorizontalFlip(p=0.5)
    RandomRotation(degrees=(-20, 20), resample=2, expand=False)
    ToTensor()
    Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])
)],
 'weight_decay': 0}
Dataloader constructed!
Epoch: 0, batch loss: 0.56555 Loss Sum: 236.87679, accuracy : 0.61021, val loss: 13.66253, val accuracy: 0.74253
Final : 0.8282867084239663 [('val/VGG16/monotone/f1-score', 0.8512110726643598), ('val/VGG16/screenshot/f1-score', 0.844106463878327), ('val/VGG16/unknown/f1-score', 0.790874524714829)]
Epoch: 1, batch loss: 0.42047 Loss Sum: 109.28202, accuracy : 0.84798, val loss: 9.32051, val accuracy: 0.82682
Final : 0.8843086425431069 [('val/VGG16/monotone/f1-score', 0.9032258064516129), ('val/VGG16/screenshot/f1-score', 0.8851851851851851), ('val/VGG16/unknown/f1-score', 0.8649303452453059)]
Epoch: 2, batch loss: 0.34868 Loss Sum: 87.33106, accuracy : 0.87610, val loss: 9.20484, val accuracy: 0.83678
Final : 0.8930734684128646 [('val/VGG16/monotone/f1-score', 0.9142857142857144), ('val/VGG16/screenshot/f1-score', 0.8937728937728938), ('val/VGG16/unknown/f1-score', 0.8716707021791767)]
Epoch: 3, batch loss: 0.27680 Loss Sum: 83.98310, accuracy : 0.87908, val loss: 9.55591, val accuracy: 0.82989
Final : 0.8879850673096059 [('val/VGG16/monotone/f1-score', 0.9020979020979021), ('val/VGG16/screenshot/f1-score', 0.8956356736242884), ('val/VGG16/unknown/f1-score', 0.8666264333132166)]
---train finished---
Trying to save to /tmp/tmpqadr237q/model
Too long checkpoint name: VGG16_64_[0.3, 0.2, 0.2, 0.3]_[3, 1]_1.0_9.999999999999999e-05_[1.0, 1.0, 1.0, 1.0]_Adam_2_1_0 not saved
Done
VGG16 Loaded!
{'batch_size': 64,
 'class_ratio': [0.3, 0.2, 0.2, 0.3],
 'epoch': [3, 1],
 'gamma': 0.1,
 'learning_rate': 1e-06,
 'loss_cls_weight': tensor([1., 1., 1., 1.]),
 'optimizer': 'Adam',
 'step_size': 2,
 'transforms': [1,
                Compose(
    ColorJitter(brightness=None, contrast=None, saturation=[0.95, 1.05], hue=[-0.05, 0.05])
    RandomHorizontalFlip(p=0.5)
    RandomRotation(degrees=(-20, 20), resample=2, expand=False)
    ToTensor()
    Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])
)],
 'weight_decay': 0.001}
Dataloader constructed!
Epoch: 0, batch loss: 0.39748 Loss Sum: 238.43820, accuracy : 0.63029, val loss: 12.69482, val accuracy: 0.75632
Final : 0.8370328178695297 [('val/VGG16/monotone/f1-score', 0.8659793814432991), ('val/VGG16/screenshot/f1-score', 0.8454376163873369), ('val/VGG16/unknown/f1-score', 0.801010739102969)]
Epoch: 1, batch loss: 0.34346 Loss Sum: 104.09279, accuracy : 0.85461, val loss: 9.81817, val accuracy: 0.81533
Final : 0.8778359709127563 [('val/VGG16/monotone/f1-score', 0.8881118881118881), ('val/VGG16/screenshot/f1-score', 0.8933823529411765), ('val/VGG16/unknown/f1-score', 0.8525798525798526)]
Epoch: 2, batch loss: 0.28380 Loss Sum: 84.65582, accuracy : 0.88096, val loss: 9.82670, val accuracy: 0.80230
Final : 0.8747936211171985 [('val/VGG16/monotone/f1-score', 0.9039145907473309), ('val/VGG16/screenshot/f1-score', 0.8794063079777366), ('val/VGG16/unknown/f1-score', 0.842170160295931)]
Epoch: 3, batch loss: 0.31233 Loss Sum: 84.39660, accuracy : 0.88084, val loss: 9.20689, val accuracy: 0.81762
Final : 0.8741793452008665 [('val/VGG16/monotone/f1-score', 0.8936170212765957), ('val/VGG16/screenshot/f1-score', 0.8719851576994434), ('val/VGG16/unknown/f1-score', 0.8573163327261689)]
---train finished---
Trying to save to /tmp/tmp07aj9pxm/model
Too long checkpoint name: VGG16_64_[0.3, 0.2, 0.2, 0.3]_[3, 1]_1.0_9.999999999999999e-05_[1.0, 1.0, 1.0, 1.0]_Adam_2_1_100.0 not saved
Done
VGG16 Loaded!
{'batch_size': 64,
 'class_ratio': [0.3, 0.2, 0.2, 0.3],
 'epoch': [3, 1],
 'gamma': 0.1,
 'learning_rate': 1e-06,
 'loss_cls_weight': tensor([1., 1., 1., 1.]),
 'optimizer': 'Adam',
 'step_size': 2,
 'transforms': [2,
                Compose(
    RandomAffine(degrees=(0, 0), scale=(0.75, 1.25))
    RandomPerspective(p=0.4)
    RandomHorizontalFlip(p=0.5)
    ToTensor()
    Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])
)],
 'weight_decay': 0}
Dataloader constructed!
Epoch: 0, batch loss: 0.59931 Loss Sum: 255.40812, accuracy : 0.55769, val loss: 15.85352, val accuracy: 0.69962
Final : 0.8294131027914361 [('val/VGG16/monotone/f1-score', 0.9482071713147411), ('val/VGG16/screenshot/f1-score', 0.7992351816443595), ('val/VGG16/unknown/f1-score', 0.752895752895753)]
Epoch: 1, batch loss: 0.30261 Loss Sum: 131.15043, accuracy : 0.82534, val loss: 12.20239, val accuracy: 0.76935
Final : 0.8576890339626879 [('val/VGG16/monotone/f1-score', 0.8982456140350877), ('val/VGG16/screenshot/f1-score', 0.8647619047619047), ('val/VGG16/unknown/f1-score', 0.8122653316645807)]
Epoch: 2, batch loss: 0.36162 Loss Sum: 101.27577, accuracy : 0.86003, val loss: 11.07669, val accuracy: 0.80077
Final : 0.8715195124177375 [('val/VGG16/monotone/f1-score', 0.9208633093525179), ('val/VGG16/screenshot/f1-score', 0.8538899430740037), ('val/VGG16/unknown/f1-score', 0.8418491484184915)]
Epoch: 3, batch loss: 0.31465 Loss Sum: 98.25892, accuracy : 0.85997, val loss: 10.69786, val accuracy: 0.80000
Final : 0.8707304166886558 [('val/VGG16/monotone/f1-score', 0.8982456140350877), ('val/VGG16/screenshot/f1-score', 0.874296435272045), ('val/VGG16/unknown/f1-score', 0.8406153846153845)]
---train finished---
Trying to save to /tmp/tmp5yve1jee/model
Too long checkpoint name: VGG16_64_[0.3, 0.2, 0.2, 0.3]_[3, 1]_1.0_9.999999999999999e-05_[1.0, 1.0, 1.0, 1.0]_Adam_2_2_0 not saved
Done
VGG16 Loaded!
{'batch_size': 64,
 'class_ratio': [0.3, 0.2, 0.2, 0.3],
 'epoch': [3, 1],
 'gamma': 0.1,
 'learning_rate': 1e-06,
 'loss_cls_weight': tensor([1., 1., 1., 1.]),
 'optimizer': 'Adam',
 'step_size': 2,
 'transforms': [2,
                Compose(
    RandomAffine(degrees=(0, 0), scale=(0.75, 1.25))
    RandomPerspective(p=0.4)
    RandomHorizontalFlip(p=0.5)
    ToTensor()
    Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])
)],
 'weight_decay': 0.001}
Dataloader constructed!
Epoch: 0, batch loss: 0.67401 Loss Sum: 255.95474, accuracy : 0.54516, val loss: 15.92340, val accuracy: 0.69119
Final : 0.8231701922099416 [('val/VGG16/monotone/f1-score', 0.9230769230769232), ('val/VGG16/screenshot/f1-score', 0.8106060606060607), ('val/VGG16/unknown/f1-score', 0.7454545454545454)]
Epoch: 1, batch loss: 0.36062 Loss Sum: 135.86894, accuracy : 0.82163, val loss: 10.86160, val accuracy: 0.81226
Final : 0.8814966096725982 [('val/VGG16/monotone/f1-score', 0.924187725631769), ('val/VGG16/screenshot/f1-score', 0.8710280373831776), ('val/VGG16/unknown/f1-score', 0.8508825319537431)]
Epoch: 2, batch loss: 0.41953 Loss Sum: 104.31368, accuracy : 0.85364, val loss: 10.24824, val accuracy: 0.82529
Final : 0.8869758507356157 [('val/VGG16/monotone/f1-score', 0.9097472924187726), ('val/VGG16/screenshot/f1-score', 0.8880597014925372), ('val/VGG16/unknown/f1-score', 0.8637189582071473)]
Epoch: 3, batch loss: 0.38266 Loss Sum: 103.22773, accuracy : 0.85826, val loss: 10.48083, val accuracy: 0.80690
Final : 0.8749094549968957 [('val/VGG16/monotone/f1-score', 0.9169675090252708), ('val/VGG16/screenshot/f1-score', 0.8608534322820037), ('val/VGG16/unknown/f1-score', 0.8484107579462102)]
---train finished---
Trying to save to /tmp/tmpqkpgwvwd/model
Too long checkpoint name: VGG16_64_[0.3, 0.2, 0.2, 0.3]_[3, 1]_1.0_9.999999999999999e-05_[1.0, 1.0, 1.0, 1.0]_Adam_2_2_100.0 not saved
Done
VGG16 Loaded!
{'batch_size': 64,
 'class_ratio': [0.3, 0.2, 0.2, 0.3],
 'epoch': [3, 1],
 'gamma': 0.1,
 'learning_rate': 1e-06,
 'loss_cls_weight': tensor([1., 1., 1., 1.]),
 'optimizer': 'SGD',
 'step_size': 10,
 'transforms': [1,
                Compose(
    ColorJitter(brightness=None, contrast=None, saturation=[0.95, 1.05], hue=[-0.05, 0.05])
    RandomHorizontalFlip(p=0.5)
    RandomRotation(degrees=(-20, 20), resample=2, expand=False)
    ToTensor()
    Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])
)],
 'weight_decay': 0}
Dataloader constructed!
Epoch: 0, batch loss: 1.28250 Loss Sum: 348.40193, accuracy : 0.29430, val loss: 27.53703, val accuracy: 0.32337
Final : 0.1424366249542372 [('val/VGG16/monotone/f1-score', 0.01515151515151515), ('val/VGG16/screenshot/f1-score', 0.38974358974358975), ('val/VGG16/unknown/f1-score', 0.4893617021276596)]
Epoch: 1, batch loss: 1.26652 Loss Sum: 326.20908, accuracy : 0.36764, val loss: 25.63749, val accuracy: 0.37854
Final : 0.0 [('val/VGG16/monotone/f1-score', 0.0), ('val/VGG16/screenshot/f1-score', 0.5727923627684964), ('val/VGG16/unknown/f1-score', 0.5169315825846579)]
Epoch: 2, batch loss: 1.05711 Loss Sum: 303.85326, accuracy : 0.44882, val loss: 23.60014, val accuracy: 0.47050
Final : 0.19091623441075603 [('val/VGG16/monotone/f1-score', 0.015384615384615384), ('val/VGG16/screenshot/f1-score', 0.7845528455284553), ('val/VGG16/unknown/f1-score', 0.5765271105010294)]
Epoch: 3, batch loss: 0.98941 Loss Sum: 278.15470, accuracy : 0.49933, val loss: 21.59384, val accuracy: 0.49502
Final : 0.1938720336089037 [('val/VGG16/monotone/f1-score', 0.015384615384615384), ('val/VGG16/screenshot/f1-score', 0.8145454545454546), ('val/VGG16/unknown/f1-score', 0.5814917127071824)]
---train finished---
Trying to save to /tmp/tmpuf8lrkns/model
Too long checkpoint name: VGG16_64_[0.3, 0.2, 0.2, 0.3]_[3, 1]_1.0_9.999999999999999e-05_[1.0, 1.0, 1.0, 1.0]_SGD_10_1_0 not saved
Done
VGG16 Loaded!
{'batch_size': 64,
 'class_ratio': [0.3, 0.2, 0.2, 0.3],
 'epoch': [3, 1],
 'gamma': 0.1,
 'learning_rate': 1e-06,
 'loss_cls_weight': tensor([1., 1., 1., 1.]),
 'optimizer': 'SGD',
 'step_size': 10,
 'transforms': [1,
                Compose(
    ColorJitter(brightness=None, contrast=None, saturation=[0.95, 1.05], hue=[-0.05, 0.05])
    RandomHorizontalFlip(p=0.5)
    RandomRotation(degrees=(-20, 20), resample=2, expand=False)
    ToTensor()
    Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])
)],
 'weight_decay': 0.001}
Dataloader constructed!
Epoch: 0, batch loss: 1.30720 Loss Sum: 354.53166, accuracy : 0.27300, val loss: 27.88766, val accuracy: 0.31341
Final : 0.25032742507901146 [('val/VGG16/monotone/f1-score', 0.09876543209876544), ('val/VGG16/screenshot/f1-score', 0.3386004514672686), ('val/VGG16/unknown/f1-score', 0.46906474820143884)]
Epoch: 1, batch loss: 1.20678 Loss Sum: 328.03298, accuracy : 0.37950, val loss: 25.52469, val accuracy: 0.41839
Final : 0.0 [('val/VGG16/monotone/f1-score', 0.0), ('val/VGG16/screenshot/f1-score', 0.5707317073170731), ('val/VGG16/unknown/f1-score', 0.5689655172413793)]
Epoch: 2, batch loss: 1.15560 Loss Sum: 306.40700, accuracy : 0.44401, val loss: 23.93665, val accuracy: 0.46820
Final : 0.0 [('val/VGG16/monotone/f1-score', 0.0), ('val/VGG16/screenshot/f1-score', 0.7131147540983607), ('val/VGG16/unknown/f1-score', 0.5838343353373414)]
Epoch: 3, batch loss: 1.03669 Loss Sum: 280.98561, accuracy : 0.50292, val loss: 22.12436, val accuracy: 0.50115
Final : 0.24163400347868028 [('val/VGG16/monotone/f1-score', 0.030534351145038167), ('val/VGG16/screenshot/f1-score', 0.7783783783783784), ('val/VGG16/unknown/f1-score', 0.5936010891763104)]
---train finished---
Trying to save to /tmp/tmpibmfbo5z/model
Too long checkpoint name: VGG16_64_[0.3, 0.2, 0.2, 0.3]_[3, 1]_1.0_9.999999999999999e-05_[1.0, 1.0, 1.0, 1.0]_SGD_10_1_100.0 not saved
Done
VGG16 Loaded!
{'batch_size': 64,
 'class_ratio': [0.3, 0.2, 0.2, 0.3],
 'epoch': [3, 1],
 'gamma': 0.1,
 'learning_rate': 1e-06,
 'loss_cls_weight': tensor([1., 1., 1., 1.]),
 'optimizer': 'SGD',
 'step_size': 10,
 'transforms': [2,
                Compose(
    RandomAffine(degrees=(0, 0), scale=(0.75, 1.25))
    RandomPerspective(p=0.4)
    RandomHorizontalFlip(p=0.5)
    ToTensor()
    Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])
)],
 'weight_decay': 0}
Dataloader constructed!
Epoch: 0, batch loss: 1.38248 Loss Sum: 356.70741, accuracy : 0.25061, val loss: 30.23684, val accuracy: 0.15096
Final : 0.14565905330286189 [('val/VGG16/monotone/f1-score', 0.07164179104477612), ('val/VGG16/screenshot/f1-score', 0.16565656565656567), ('val/VGG16/unknown/f1-score', 0.2603978300180832)]
Epoch: 1, batch loss: 1.38411 Loss Sum: 356.41667, accuracy : 0.25627, val loss: 30.04788, val accuracy: 0.15709
Final : 0.16622460161416536 [('val/VGG16/monotone/f1-score', 0.1020408163265306), ('val/VGG16/screenshot/f1-score', 0.1713147410358566), ('val/VGG16/unknown/f1-score', 0.26273458445040215)]
Epoch: 2, batch loss: 1.39737 Loss Sum: 356.52831, accuracy : 0.25371, val loss: 30.16491, val accuracy: 0.15556
Final : 0.14567373630366437 [('val/VGG16/monotone/f1-score', 0.08860759493670886), ('val/VGG16/screenshot/f1-score', 0.12474012474012476), ('val/VGG16/unknown/f1-score', 0.2796833773087071)]
Epoch: 3, batch loss: 1.38860 Loss Sum: 356.06027, accuracy : 0.25262, val loss: 29.96599, val accuracy: 0.15632
Final : 0.15298436667931936 [('val/VGG16/monotone/f1-score', 0.07766990291262137), ('val/VGG16/screenshot/f1-score', 0.17523809523809525), ('val/VGG16/unknown/f1-score', 0.26306306306306304)]
---train finished---
Trying to save to /tmp/tmp051ef4wu/model
Too long checkpoint name: VGG16_64_[0.3, 0.2, 0.2, 0.3]_[3, 1]_1.0_9.999999999999999e-05_[1.0, 1.0, 1.0, 1.0]_SGD_10_2_0 not saved
Done
VGG16 Loaded!
{'batch_size': 64,
 'class_ratio': [0.3, 0.2, 0.2, 0.3],
 'epoch': [3, 1],
 'gamma': 0.1,
 'learning_rate': 1e-06,
 'loss_cls_weight': tensor([1., 1., 1., 1.]),
 'optimizer': 'SGD',
 'step_size': 10,
 'transforms': [2,
                Compose(
    RandomAffine(degrees=(0, 0), scale=(0.75, 1.25))
    RandomPerspective(p=0.4)
    RandomHorizontalFlip(p=0.5)
    ToTensor()
    Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])
)],
 'weight_decay': 0.001}
Dataloader constructed!
Epoch: 0, batch loss: 1.40893 Loss Sum: 353.82056, accuracy : 0.26844, val loss: 28.32519, val accuracy: 0.34100
Final : 0.2682783458796878 [('val/VGG16/monotone/f1-score', 0.1422924901185771), ('val/VGG16/screenshot/f1-score', 0.2951219512195122), ('val/VGG16/unknown/f1-score', 0.45980465815176563)]
Epoch: 1, batch loss: 1.40618 Loss Sum: 353.37903, accuracy : 0.27191, val loss: 28.18487, val accuracy: 0.35402
Final : 0.2783298316352562 [('val/VGG16/monotone/f1-score', 0.1589958158995816), ('val/VGG16/screenshot/f1-score', 0.28105395232120456), ('val/VGG16/unknown/f1-score', 0.4825072886297376)]
Epoch: 2, batch loss: 1.36693 Loss Sum: 353.20850, accuracy : 0.26777, val loss: 28.29245, val accuracy: 0.34636
Final : 0.2680567834398781 [('val/VGG16/monotone/f1-score', 0.13821138211382114), ('val/VGG16/screenshot/f1-score', 0.29913473423980225), ('val/VGG16/unknown/f1-score', 0.46587537091988124)]
Epoch: 3, batch loss: 1.33555 Loss Sum: 352.66294, accuracy : 0.26814, val loss: 28.15376, val accuracy: 0.35019
Final : 0.2695058969938644 [('val/VGG16/monotone/f1-score', 0.13043478260869565), ('val/VGG16/screenshot/f1-score', 0.32696897374701667), ('val/VGG16/unknown/f1-score', 0.45899172310007524)]
---train finished---
Trying to save to /tmp/tmpy7qvp5uo/model
Too long checkpoint name: VGG16_64_[0.3, 0.2, 0.2, 0.3]_[3, 1]_1.0_9.999999999999999e-05_[1.0, 1.0, 1.0, 1.0]_SGD_10_2_100.0 not saved
Done
VGG16 Loaded!
{'batch_size': 64,
 'class_ratio': [0.3, 0.2, 0.2, 0.3],
 'epoch': [3, 1],
 'gamma': 0.1,
 'learning_rate': 1e-06,
 'loss_cls_weight': tensor([1., 1., 1., 1.]),
 'optimizer': 'SGD',
 'step_size': 2,
 'transforms': [1,
                Compose(
    ColorJitter(brightness=None, contrast=None, saturation=[0.95, 1.05], hue=[-0.05, 0.05])
    RandomHorizontalFlip(p=0.5)
    RandomRotation(degrees=(-20, 20), resample=2, expand=False)
    ToTensor()
    Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])
)],
 'weight_decay': 0}
Dataloader constructed!
Epoch: 0, batch loss: 1.38728 Loss Sum: 358.15959, accuracy : 0.25621, val loss: 29.58156, val accuracy: 0.22605
Final : 0.20795407311044697 [('val/VGG16/monotone/f1-score', 0.14468085106382977), ('val/VGG16/screenshot/f1-score', 0.17672413793103448), ('val/VGG16/unknown/f1-score', 0.3517186250999201)]
Epoch: 1, batch loss: 1.38528 Loss Sum: 357.12852, accuracy : 0.26327, val loss: 29.43876, val accuracy: 0.23908
Final : 0.19323469250696837 [('val/VGG16/monotone/f1-score', 0.11009174311926606), ('val/VGG16/screenshot/f1-score', 0.16913319238900634), ('val/VGG16/unknown/f1-score', 0.3875)]
Epoch: 2, batch loss: 1.43097 Loss Sum: 357.18597, accuracy : 0.25858, val loss: 29.49440, val accuracy: 0.23985
Final : 0.2249045542825766 [('val/VGG16/monotone/f1-score', 0.15841584158415842), ('val/VGG16/screenshot/f1-score', 0.1945031712473573), ('val/VGG16/unknown/f1-score', 0.3692065985860173)]
Epoch: 3, batch loss: 1.40097 Loss Sum: 357.17799, accuracy : 0.25389, val loss: 29.43538, val accuracy: 0.24138
Final : 0.18613753386507256 [('val/VGG16/monotone/f1-score', 0.10672853828306264), ('val/VGG16/screenshot/f1-score', 0.15261044176706826), ('val/VGG16/unknown/f1-score', 0.3959469992205768)]
---train finished---
Trying to save to /tmp/tmpun23f3fs/model
Too long checkpoint name: VGG16_64_[0.3, 0.2, 0.2, 0.3]_[3, 1]_1.0_9.999999999999999e-05_[1.0, 1.0, 1.0, 1.0]_SGD_2_1_0 not saved
Done
VGG16 Loaded!
{'batch_size': 64,
 'class_ratio': [0.3, 0.2, 0.2, 0.3],
 'epoch': [3, 1],
 'gamma': 0.1,
 'learning_rate': 1e-06,
 'loss_cls_weight': tensor([1., 1., 1., 1.]),
 'optimizer': 'SGD',
 'step_size': 2,
 'transforms': [1,
                Compose(
    ColorJitter(brightness=None, contrast=None, saturation=[0.95, 1.05], hue=[-0.05, 0.05])
    RandomHorizontalFlip(p=0.5)
    RandomRotation(degrees=(-20, 20), resample=2, expand=False)
    ToTensor()
    Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])
)],
 'weight_decay': 0.001}
Dataloader constructed!
Epoch: 0, batch loss: 1.33685 Loss Sum: 351.74253, accuracy : 0.27885, val loss: 27.14570, val accuracy: 0.38238
Final : 0.1722449617755818 [('val/VGG16/monotone/f1-score', 0.02962962962962963), ('val/VGG16/screenshot/f1-score', 0.31100478468899523), ('val/VGG16/unknown/f1-score', 0.5545571245186136)]
Epoch: 1, batch loss: 1.19905 Loss Sum: 328.25175, accuracy : 0.36605, val loss: 25.76491, val accuracy: 0.36782
Final : 0.0 [('val/VGG16/monotone/f1-score', 0.0), ('val/VGG16/screenshot/f1-score', 0.4712041884816754), ('val/VGG16/unknown/f1-score', 0.5266711681296421)]
Epoch: 2, batch loss: 1.16166 Loss Sum: 316.26047, accuracy : 0.40537, val loss: 25.46360, val accuracy: 0.38621
Final : 0.0 [('val/VGG16/monotone/f1-score', 0.0), ('val/VGG16/screenshot/f1-score', 0.5413533834586466), ('val/VGG16/unknown/f1-score', 0.5344129554655871)]
Epoch: 3, batch loss: 1.23026 Loss Sum: 314.21505, accuracy : 0.41541, val loss: 25.27754, val accuracy: 0.41609
Final : 0.0 [('val/VGG16/monotone/f1-score', 0.0), ('val/VGG16/screenshot/f1-score', 0.624113475177305), ('val/VGG16/unknown/f1-score', 0.5498327759197325)]
---train finished---
Trying to save to /tmp/tmpm_rq2yk2/model
Too long checkpoint name: VGG16_64_[0.3, 0.2, 0.2, 0.3]_[3, 1]_1.0_9.999999999999999e-05_[1.0, 1.0, 1.0, 1.0]_SGD_2_1_100.0 not saved
Done
VGG16 Loaded!
{'batch_size': 64,
 'class_ratio': [0.3, 0.2, 0.2, 0.3],
 'epoch': [3, 1],
 'gamma': 0.1,
 'learning_rate': 1e-06,
 'loss_cls_weight': tensor([1., 1., 1., 1.]),
 'optimizer': 'SGD',
 'step_size': 2,
 'transforms': [2,
                Compose(
    RandomAffine(degrees=(0, 0), scale=(0.75, 1.25))
    RandomPerspective(p=0.4)
    RandomHorizontalFlip(p=0.5)
    ToTensor()
    Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])
)],
 'weight_decay': 0}
Dataloader constructed!
Epoch: 0, batch loss: 1.28785 Loss Sum: 355.27699, accuracy : 0.26868, val loss: 27.59602, val accuracy: 0.35172
Final : 0.14336221750234737 [('val/VGG16/monotone/f1-score', 0.013888888888888888), ('val/VGG16/screenshot/f1-score', 0.4343065693430657), ('val/VGG16/unknown/f1-score', 0.4884726224783861)]
Epoch: 1, batch loss: 1.23339 Loss Sum: 327.70132, accuracy : 0.38218, val loss: 25.32198, val accuracy: 0.42375
Final : 0.0 [('val/VGG16/monotone/f1-score', 0.0), ('val/VGG16/screenshot/f1-score', 0.656188605108055), ('val/VGG16/unknown/f1-score', 0.544428772919605)]
Epoch: 2, batch loss: 1.18142 Loss Sum: 314.37919, accuracy : 0.43318, val loss: 25.12646, val accuracy: 0.43678
Final : 0.0 [('val/VGG16/monotone/f1-score', 0.0), ('val/VGG16/screenshot/f1-score', 0.678714859437751), ('val/VGG16/unknown/f1-score', 0.5604472396925227)]
Epoch: 3, batch loss: 1.22767 Loss Sum: 312.08343, accuracy : 0.43671, val loss: 24.91816, val accuracy: 0.45900
Final : 0.0 [('val/VGG16/monotone/f1-score', 0.0), ('val/VGG16/screenshot/f1-score', 0.6785009861932939), ('val/VGG16/unknown/f1-score', 0.5845311430527036)]
---train finished---
Trying to save to /tmp/tmp8z3u5gl9/model
Too long checkpoint name: VGG16_64_[0.3, 0.2, 0.2, 0.3]_[3, 1]_1.0_9.999999999999999e-05_[1.0, 1.0, 1.0, 1.0]_SGD_2_2_0 not saved
Done
VGG16 Loaded!
{'batch_size': 64,
 'class_ratio': [0.3, 0.2, 0.2, 0.3],
 'epoch': [3, 1],
 'gamma': 0.1,
 'learning_rate': 1e-06,
 'loss_cls_weight': tensor([1., 1., 1., 1.]),
 'optimizer': 'SGD',
 'step_size': 2,
 'transforms': [2,
                Compose(
    RandomAffine(degrees=(0, 0), scale=(0.75, 1.25))
    RandomPerspective(p=0.4)
    RandomHorizontalFlip(p=0.5)
    ToTensor()
    Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])
)],
 'weight_decay': 0.001}
Dataloader constructed!
Epoch: 0, batch loss: 1.33204 Loss Sum: 354.95909, accuracy : 0.27422, val loss: 28.54026, val accuracy: 0.33870
Final : 0.27201269568770586 [('val/VGG16/monotone/f1-score', 0.1413427561837456), ('val/VGG16/screenshot/f1-score', 0.2971246006389776), ('val/VGG16/unknown/f1-score', 0.4792425345957757)]
Epoch: 1, batch loss: 1.36735 Loss Sum: 350.95556, accuracy : 0.29083, val loss: 28.32935, val accuracy: 0.30881
Final : 0.21851530867408395 [('val/VGG16/monotone/f1-score', 0.0881057268722467), ('val/VGG16/screenshot/f1-score', 0.2619808306709266), ('val/VGG16/unknown/f1-score', 0.4520348837209302)]
Epoch: 2, batch loss: 1.36444 Loss Sum: 348.85703, accuracy : 0.30337, val loss: 28.12900, val accuracy: 0.36398
Final : 0.29414397501955986 [('val/VGG16/monotone/f1-score', 0.1552511415525114), ('val/VGG16/screenshot/f1-score', 0.3227848101265823), ('val/VGG16/unknown/f1-score', 0.5078459343794579)]
Epoch: 3, batch loss: 1.35633 Loss Sum: 348.66792, accuracy : 0.30343, val loss: 28.27908, val accuracy: 0.33563
Final : 0.2692093901316044 [('val/VGG16/monotone/f1-score', 0.1565217391304348), ('val/VGG16/screenshot/f1-score', 0.25546218487394956), ('val/VGG16/unknown/f1-score', 0.4879432624113475)]
---train finished---
Trying to save to /tmp/tmp857zxvwn/model
Too long checkpoint name: VGG16_64_[0.3, 0.2, 0.2, 0.3]_[3, 1]_1.0_9.999999999999999e-05_[1.0, 1.0, 1.0, 1.0]_SGD_2_2_100.0 not saved
Done
VGG16 Loaded!
{'batch_size': 64,
 'class_ratio': [0.3, 0.2, 0.2, 0.3],
 'epoch': [3, 1],
 'gamma': 0.1,
 'learning_rate': 1e-06,
 'loss_cls_weight': tensor([1.0060, 1.0797, 1.0402, 1.2753]),
 'optimizer': 'Adamax',
 'step_size': 10,
 'transforms': [1,
                Compose(
    ColorJitter(brightness=None, contrast=None, saturation=[0.95, 1.05], hue=[-0.05, 0.05])
    RandomHorizontalFlip(p=0.5)
    RandomRotation(degrees=(-20, 20), resample=2, expand=False)
    ToTensor()
    Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])
)],
 'weight_decay': 0}
Dataloader constructed!
Epoch: 0, batch loss: 1.06593 Loss Sum: 314.21288, accuracy : 0.40506, val loss: 21.05754, val accuracy: 0.67433
Final : 0.44209027542205825 [('val/VGG16/monotone/f1-score', 0.15602836879432622), ('val/VGG16/screenshot/f1-score', 0.7109207708779444), ('val/VGG16/unknown/f1-score', 0.7789473684210526)]
Epoch: 1, batch loss: 0.79591 Loss Sum: 236.64860, accuracy : 0.60954, val loss: 16.57089, val accuracy: 0.71571
Final : 0.8104080664031839 [('val/VGG16/monotone/f1-score', 0.8403361344537815), ('val/VGG16/screenshot/f1-score', 0.8194174757281554), ('val/VGG16/unknown/f1-score', 0.7729528535980148)]
Epoch: 2, batch loss: 0.55954 Loss Sum: 176.72183, accuracy : 0.76083, val loss: 13.91315, val accuracy: 0.75479
Final : 0.8370568109702397 [('val/VGG16/monotone/f1-score', 0.8710801393728222), ('val/VGG16/screenshot/f1-score', 0.8403041825095058), ('val/VGG16/unknown/f1-score', 0.8012539184952977)]
Epoch: 3, batch loss: 0.39486 Loss Sum: 141.98350, accuracy : 0.80203, val loss: 12.52359, val accuracy: 0.77241
Final : 0.8433003799136277 [('val/VGG16/monotone/f1-score', 0.8741258741258742), ('val/VGG16/screenshot/f1-score', 0.839924670433145), ('val/VGG16/unknown/f1-score', 0.8168316831683169)]
---train finished---
Trying to save to /tmp/tmpg97xcr0q/model
Too long checkpoint name: VGG16_64_[0.3, 0.2, 0.2, 0.3]_[3, 1]_1.0_9.999999999999999e-05_[1.00600004196167, 1.079699993133545, 1.0401999950408936, 1.2753000259399414]_Adamax_10_1_0 not saved
Done
VGG16 Loaded!
{'batch_size': 64,
 'class_ratio': [0.3, 0.2, 0.2, 0.3],
 'epoch': [3, 1],
 'gamma': 0.1,
 'learning_rate': 1e-06,
 'loss_cls_weight': tensor([1.0060, 1.0797, 1.0402, 1.2753]),
 'optimizer': 'Adamax',
 'step_size': 10,
 'transforms': [1,
                Compose(
    ColorJitter(brightness=None, contrast=None, saturation=[0.95, 1.05], hue=[-0.05, 0.05])
    RandomHorizontalFlip(p=0.5)
    RandomRotation(degrees=(-20, 20), resample=2, expand=False)
    ToTensor()
    Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])
)],
 'weight_decay': 0.001}
Dataloader constructed!
Epoch: 0, batch loss: 1.08769 Loss Sum: 316.16077, accuracy : 0.43519, val loss: 21.14031, val accuracy: 0.67510
Final : 0.46092659819962234 [('val/VGG16/monotone/f1-score', 0.16901408450704228), ('val/VGG16/screenshot/f1-score', 0.7500000000000001), ('val/VGG16/unknown/f1-score', 0.7725225225225225)]
Epoch: 1, batch loss: 0.74510 Loss Sum: 235.07877, accuracy : 0.60473, val loss: 16.12047, val accuracy: 0.73333
Final : 0.819367538124817 [('val/VGG16/monotone/f1-score', 0.8502024291497976), ('val/VGG16/screenshot/f1-score', 0.8199233716475097), ('val/VGG16/unknown/f1-score', 0.7891156462585034)]
Epoch: 2, batch loss: 0.66651 Loss Sum: 174.91861, accuracy : 0.76296, val loss: 13.15394, val accuracy: 0.77395
Final : 0.838440386175294 [('val/VGG16/monotone/f1-score', 0.8464163822525597), ('val/VGG16/screenshot/f1-score', 0.8489483747609943), ('val/VGG16/unknown/f1-score', 0.820259419394688)]
Epoch: 3, batch loss: 0.58398 Loss Sum: 142.37688, accuracy : 0.80252, val loss: 11.95519, val accuracy: 0.79923
Final : 0.8591357382592827 [('val/VGG16/monotone/f1-score', 0.8758620689655173), ('val/VGG16/screenshot/f1-score', 0.860952380952381), ('val/VGG16/unknown/f1-score', 0.8409506398537477)]
---train finished---
Trying to save to /tmp/tmpab27mjhh/model
Too long checkpoint name: VGG16_64_[0.3, 0.2, 0.2, 0.3]_[3, 1]_1.0_9.999999999999999e-05_[1.00600004196167, 1.079699993133545, 1.0401999950408936, 1.2753000259399414]_Adamax_10_1_100.0 not saved
Done
VGG16 Loaded!
{'batch_size': 64,
 'class_ratio': [0.3, 0.2, 0.2, 0.3],
 'epoch': [3, 1],
 'gamma': 0.1,
 'learning_rate': 1e-06,
 'loss_cls_weight': tensor([1.0060, 1.0797, 1.0402, 1.2753]),
 'optimizer': 'Adamax',
 'step_size': 10,
 'transforms': [2,
                Compose(
    RandomAffine(degrees=(0, 0), scale=(0.75, 1.25))
    RandomPerspective(p=0.4)
    RandomHorizontalFlip(p=0.5)
    ToTensor()
    Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])
)],
 'weight_decay': 0}
Dataloader constructed!
Epoch: 0, batch loss: 1.07163 Loss Sum: 321.17906, accuracy : 0.39922, val loss: 21.75049, val accuracy: 0.64215
Final : 0.3617652921728774 [('val/VGG16/monotone/f1-score', 0.08888888888888888), ('val/VGG16/screenshot/f1-score', 0.7051282051282052), ('val/VGG16/unknown/f1-score', 0.7553793884484711)]
Epoch: 1, batch loss: 0.86680 Loss Sum: 253.60473, accuracy : 0.52556, val loss: 17.71826, val accuracy: 0.64981
Final : 0.650495366282199 [('val/VGG16/monotone/f1-score', 0.46428571428571425), ('val/VGG16/screenshot/f1-score', 0.8061420345489443), ('val/VGG16/unknown/f1-score', 0.7354205033763045)]
Epoch: 2, batch loss: 0.72558 Loss Sum: 212.32535, accuracy : 0.65549, val loss: 15.47142, val accuracy: 0.73946
Final : 0.837193022619554 [('val/VGG16/monotone/f1-score', 0.8906882591093117), ('val/VGG16/screenshot/f1-score', 0.8304761904761904), ('val/VGG16/unknown/f1-score', 0.7932752179327524)]
Epoch: 3, batch loss: 0.81981 Loss Sum: 182.92316, accuracy : 0.75426, val loss: 14.17580, val accuracy: 0.74713
Final : 0.8478354920272487 [('val/VGG16/monotone/f1-score', 0.9283018867924528), ('val/VGG16/screenshot/f1-score', 0.8239845261121856), ('val/VGG16/unknown/f1-score', 0.7967581047381547)]
---train finished---
Trying to save to /tmp/tmprpaxbwze/model
Too long checkpoint name: VGG16_64_[0.3, 0.2, 0.2, 0.3]_[3, 1]_1.0_9.999999999999999e-05_[1.00600004196167, 1.079699993133545, 1.0401999950408936, 1.2753000259399414]_Adamax_10_2_0 not saved
Done
VGG16 Loaded!
{'batch_size': 64,
 'class_ratio': [0.3, 0.2, 0.2, 0.3],
 'epoch': [3, 1],
 'gamma': 0.1,
 'learning_rate': 1e-06,
 'loss_cls_weight': tensor([1.0060, 1.0797, 1.0402, 1.2753]),
 'optimizer': 'Adamax',
 'step_size': 10,
 'transforms': [2,
                Compose(
    RandomAffine(degrees=(0, 0), scale=(0.75, 1.25))
    RandomPerspective(p=0.4)
    RandomHorizontalFlip(p=0.5)
    ToTensor()
    Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])
)],
 'weight_decay': 0.001}
Dataloader constructed!
Epoch: 0, batch loss: 1.12379 Loss Sum: 319.14283, accuracy : 0.38547, val loss: 20.70064, val accuracy: 0.68889
Final : 0.32814370791415076 [('val/VGG16/monotone/f1-score', 0.06015037593984962), ('val/VGG16/screenshot/f1-score', 0.7443762781186094), ('val/VGG16/unknown/f1-score', 0.7891532927504151)]
Epoch: 1, batch loss: 0.95332 Loss Sum: 252.16190, accuracy : 0.52921, val loss: 17.09750, val accuracy: 0.68123
Final : 0.6496199968766462 [('val/VGG16/monotone/f1-score', 0.4457831325301205), ('val/VGG16/screenshot/f1-score', 0.801556420233463), ('val/VGG16/unknown/f1-score', 0.7672209026128266)]
Epoch: 2, batch loss: 0.84389 Loss Sum: 211.57972, accuracy : 0.66084, val loss: 15.74310, val accuracy: 0.72414
Final : 0.8221690480374159 [('val/VGG16/monotone/f1-score', 0.8813559322033898), ('val/VGG16/screenshot/f1-score', 0.8037735849056605), ('val/VGG16/unknown/f1-score', 0.7845096814490942)]
Epoch: 3, batch loss: 0.53937 Loss Sum: 177.55361, accuracy : 0.76734, val loss: 13.78774, val accuracy: 0.78008
Final : 0.8732446613731039 [('val/VGG16/monotone/f1-score', 0.942528735632184), ('val/VGG16/screenshot/f1-score', 0.8549618320610687), ('val/VGG16/unknown/f1-score', 0.8263546798029557)]
---train finished---
Trying to save to /tmp/tmpo8h8q9jc/model
Too long checkpoint name: VGG16_64_[0.3, 0.2, 0.2, 0.3]_[3, 1]_1.0_9.999999999999999e-05_[1.00600004196167, 1.079699993133545, 1.0401999950408936, 1.2753000259399414]_Adamax_10_2_100.0 not saved
Done
VGG16 Loaded!
{'batch_size': 64,
 'class_ratio': [0.3, 0.2, 0.2, 0.3],
 'epoch': [3, 1],
 'gamma': 0.1,
 'learning_rate': 1e-06,
 'loss_cls_weight': tensor([1.0060, 1.0797, 1.0402, 1.2753]),
 'optimizer': 'Adamax',
 'step_size': 2,
 'transforms': [1,
                Compose(
    ColorJitter(brightness=None, contrast=None, saturation=[0.95, 1.05], hue=[-0.05, 0.05])
    RandomHorizontalFlip(p=0.5)
    RandomRotation(degrees=(-20, 20), resample=2, expand=False)
    ToTensor()
    Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])
)],
 'weight_decay': 0}
Dataloader constructed!
Epoch: 0, batch loss: 1.02671 Loss Sum: 315.82489, accuracy : 0.41048, val loss: 21.18361, val accuracy: 0.66743
Final : 0.5039120073829446 [('val/VGG16/monotone/f1-score', 0.2191780821917808), ('val/VGG16/screenshot/f1-score', 0.7605042016806722), ('val/VGG16/unknown/f1-score', 0.7676537585421412)]
Epoch: 1, batch loss: 0.71319 Loss Sum: 234.45601, accuracy : 0.61648, val loss: 15.76187, val accuracy: 0.73487
Final : 0.8212926730699169 [('val/VGG16/monotone/f1-score', 0.8514056224899598), ('val/VGG16/screenshot/f1-score', 0.8217054263565892), ('val/VGG16/unknown/f1-score', 0.791846819024089)]
Epoch: 2, batch loss: 0.78370 Loss Sum: 194.66799, accuracy : 0.73296, val loss: 15.70986, val accuracy: 0.74789
Final : 0.8384290150999817 [('val/VGG16/monotone/f1-score', 0.8871595330739299), ('val/VGG16/screenshot/f1-score', 0.8317214700193424), ('val/VGG16/unknown/f1-score', 0.7987654320987654)]
Epoch: 3, batch loss: 0.74773 Loss Sum: 190.07611, accuracy : 0.74038, val loss: 15.22600, val accuracy: 0.75556
Final : 0.8425571145311709 [('val/VGG16/monotone/f1-score', 0.8981132075471698), ('val/VGG16/screenshot/f1-score', 0.8253358925143954), ('val/VGG16/unknown/f1-score', 0.806930693069307)]
---train finished---
Trying to save to /tmp/tmpk_v5h29b/model
Too long checkpoint name: VGG16_64_[0.3, 0.2, 0.2, 0.3]_[3, 1]_1.0_9.999999999999999e-05_[1.00600004196167, 1.079699993133545, 1.0401999950408936, 1.2753000259399414]_Adamax_2_1_0 not saved
Done
VGG16 Loaded!
{'batch_size': 64,
 'class_ratio': [0.3, 0.2, 0.2, 0.3],
 'epoch': [3, 1],
 'gamma': 0.1,
 'learning_rate': 1e-06,
 'loss_cls_weight': tensor([1.0060, 1.0797, 1.0402, 1.2753]),
 'optimizer': 'Adamax',
 'step_size': 2,
 'transforms': [1,
                Compose(
    ColorJitter(brightness=None, contrast=None, saturation=[0.95, 1.05], hue=[-0.05, 0.05])
    RandomHorizontalFlip(p=0.5)
    RandomRotation(degrees=(-20, 20), resample=2, expand=False)
    ToTensor()
    Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])
)],
 'weight_decay': 0.001}
Dataloader constructed!
Epoch: 0, batch loss: 1.06892 Loss Sum: 320.11360, accuracy : 0.39618, val loss: 21.42789, val accuracy: 0.67969
Final : 0.49805513392675715 [('val/VGG16/monotone/f1-score', 0.2206896551724138), ('val/VGG16/screenshot/f1-score', 0.7108167770419426), ('val/VGG16/unknown/f1-score', 0.7875762617859124)]
Epoch: 1, batch loss: 0.76818 Loss Sum: 241.85225, accuracy : 0.59810, val loss: 16.01663, val accuracy: 0.75556
Final : 0.8253401140713056 [('val/VGG16/monotone/f1-score', 0.8713692946058091), ('val/VGG16/screenshot/f1-score', 0.7945736434108528), ('val/VGG16/unknown/f1-score', 0.8120120120120119)]
Epoch: 2, batch loss: 0.74151 Loss Sum: 202.15963, accuracy : 0.71367, val loss: 15.66256, val accuracy: 0.74253
Final : 0.828832543836459 [('val/VGG16/monotone/f1-score', 0.878048780487805), ('val/VGG16/screenshot/f1-score', 0.8138195777351248), ('val/VGG16/unknown/f1-score', 0.7968078575813383)]
Epoch: 3, batch loss: 0.72096 Loss Sum: 196.94720, accuracy : 0.73034, val loss: 15.52480, val accuracy: 0.75019
Final : 0.821533813678873 [('val/VGG16/monotone/f1-score', 0.846473029045643), ('val/VGG16/screenshot/f1-score', 0.8128544423440455), ('val/VGG16/unknown/f1-score', 0.8058429701765064)]
---train finished---
Trying to save to /tmp/tmpoe71iafk/model
Too long checkpoint name: VGG16_64_[0.3, 0.2, 0.2, 0.3]_[3, 1]_1.0_9.999999999999999e-05_[1.00600004196167, 1.079699993133545, 1.0401999950408936, 1.2753000259399414]_Adamax_2_1_100.0 not saved
Done
VGG16 Loaded!
{'batch_size': 64,
 'class_ratio': [0.3, 0.2, 0.2, 0.3],
 'epoch': [3, 1],
 'gamma': 0.1,
 'learning_rate': 1e-06,
 'loss_cls_weight': tensor([1.0060, 1.0797, 1.0402, 1.2753]),
 'optimizer': 'Adamax',
 'step_size': 2,
 'transforms': [2,
                Compose(
    RandomAffine(degrees=(0, 0), scale=(0.75, 1.25))
    RandomPerspective(p=0.4)
    RandomHorizontalFlip(p=0.5)
    ToTensor()
    Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])
)],
 'weight_decay': 0}
Dataloader constructed!
Epoch: 0, batch loss: 1.13160 Loss Sum: 322.29772, accuracy : 0.37871, val loss: 21.87373, val accuracy: 0.64215
Final : 0.20467980221971654 [('val/VGG16/monotone/f1-score', 0.015384615384615384), ('val/VGG16/screenshot/f1-score', 0.7458333333333335), ('val/VGG16/unknown/f1-score', 0.7473026689381035)]
Epoch: 1, batch loss: 0.84095 Loss Sum: 254.85092, accuracy : 0.52775, val loss: 17.47147, val accuracy: 0.66973
Final : 0.6305517365027794 [('val/VGG16/monotone/f1-score', 0.4171779141104295), ('val/VGG16/screenshot/f1-score', 0.7946257197696737), ('val/VGG16/unknown/f1-score', 0.7562724014336918)]
Epoch: 2, batch loss: 0.92012 Loss Sum: 226.38749, accuracy : 0.59768, val loss: 17.37106, val accuracy: 0.67126
Final : 0.675190189084134 [('val/VGG16/monotone/f1-score', 0.5086705202312138), ('val/VGG16/screenshot/f1-score', 0.7984496124031009), ('val/VGG16/unknown/f1-score', 0.757869249394673)]
Epoch: 3, batch loss: 0.88496 Loss Sum: 221.98038, accuracy : 0.61824, val loss: 17.37197, val accuracy: 0.67203
Final : 0.6895030954775951 [('val/VGG16/monotone/f1-score', 0.550561797752809), ('val/VGG16/screenshot/f1-score', 0.7893738140417457), ('val/VGG16/unknown/f1-score', 0.754257907542579)]
---train finished---
Trying to save to /tmp/tmppuffi0w2/model
Too long checkpoint name: VGG16_64_[0.3, 0.2, 0.2, 0.3]_[3, 1]_1.0_9.999999999999999e-05_[1.00600004196167, 1.079699993133545, 1.0401999950408936, 1.2753000259399414]_Adamax_2_2_0 not saved
Done
VGG16 Loaded!
{'batch_size': 64,
 'class_ratio': [0.3, 0.2, 0.2, 0.3],
 'epoch': [3, 1],
 'gamma': 0.1,
 'learning_rate': 1e-06,
 'loss_cls_weight': tensor([1.0060, 1.0797, 1.0402, 1.2753]),
 'optimizer': 'Adamax',
 'step_size': 2,
 'transforms': [2,
                Compose(
    RandomAffine(degrees=(0, 0), scale=(0.75, 1.25))
    RandomPerspective(p=0.4)
    RandomHorizontalFlip(p=0.5)
    ToTensor()
    Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])
)],
 'weight_decay': 0.001}
Dataloader constructed!
Epoch: 0, batch loss: 1.06244 Loss Sum: 315.48016, accuracy : 0.38705, val loss: 21.08906, val accuracy: 0.65517
Final : 0.2587176281803165 [('val/VGG16/monotone/f1-score', 0.030534351145038167), ('val/VGG16/screenshot/f1-score', 0.7459016393442625), ('val/VGG16/unknown/f1-score', 0.7603399433427762)]
Epoch: 1, batch loss: 1.00339 Loss Sum: 250.91393, accuracy : 0.52806, val loss: 17.71449, val accuracy: 0.65134
Final : 0.5949928580473393 [('val/VGG16/monotone/f1-score', 0.356687898089172), ('val/VGG16/screenshot/f1-score', 0.8029739776951673), ('val/VGG16/unknown/f1-score', 0.7354368932038834)]
Epoch: 2, batch loss: 0.72492 Loss Sum: 224.18882, accuracy : 0.59719, val loss: 17.42918, val accuracy: 0.66284
Final : 0.6123335258165604 [('val/VGG16/monotone/f1-score', 0.37735849056603776), ('val/VGG16/screenshot/f1-score', 0.8136882129277566), ('val/VGG16/unknown/f1-score', 0.7477423239012643)]
Epoch: 3, batch loss: 0.74251 Loss Sum: 221.88018, accuracy : 0.60650, val loss: 16.99086, val accuracy: 0.66360
Final : 0.6511763791612593 [('val/VGG16/monotone/f1-score', 0.46428571428571425), ('val/VGG16/screenshot/f1-score', 0.7961538461538461), ('val/VGG16/unknown/f1-score', 0.746987951807229)]
---train finished---
Trying to save to /tmp/tmp2h3zshuy/model
Too long checkpoint name: VGG16_64_[0.3, 0.2, 0.2, 0.3]_[3, 1]_1.0_9.999999999999999e-05_[1.00600004196167, 1.079699993133545, 1.0401999950408936, 1.2753000259399414]_Adamax_2_2_100.0 not saved
Done
VGG16 Loaded!
{'batch_size': 64,
 'class_ratio': [0.3, 0.2, 0.2, 0.3],
 'epoch': [3, 1],
 'gamma': 0.1,
 'learning_rate': 1e-06,
 'loss_cls_weight': tensor([1.0060, 1.0797, 1.0402, 1.2753]),
 'optimizer': 'Adam',
 'step_size': 10,
 'transforms': [1,
                Compose(
    ColorJitter(brightness=None, contrast=None, saturation=[0.95, 1.05], hue=[-0.05, 0.05])
    RandomHorizontalFlip(p=0.5)
    RandomRotation(degrees=(-20, 20), resample=2, expand=False)
    ToTensor()
    Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])
)],
 'weight_decay': 0}
Dataloader constructed!
Epoch: 0, batch loss: 0.45644 Loss Sum: 243.58916, accuracy : 0.58307, val loss: 12.44083, val accuracy: 0.77854
Final : 0.8491884934216578 [('val/VGG16/monotone/f1-score', 0.8811188811188811), ('val/VGG16/screenshot/f1-score', 0.84251968503937), ('val/VGG16/unknown/f1-score', 0.8248932275777913)]
Epoch: 1, batch loss: 0.36540 Loss Sum: 110.83720, accuracy : 0.84847, val loss: 9.05964, val accuracy: 0.83372
Final : 0.8832938626010853 [('val/VGG16/monotone/f1-score', 0.9020979020979021), ('val/VGG16/screenshot/f1-score', 0.8775894538606404), ('val/VGG16/unknown/f1-score', 0.8705035971223021)]
Epoch: 2, batch loss: 0.28483 Loss Sum: 81.91782, accuracy : 0.88510, val loss: 7.46786, val accuracy: 0.86130
Final : 0.9053010459294517 [('val/VGG16/monotone/f1-score', 0.9416058394160584), ('val/VGG16/screenshot/f1-score', 0.8818011257035646), ('val/VGG16/unknown/f1-score', 0.8935920047031157)]
Epoch: 3, batch loss: 0.36006 Loss Sum: 69.70341, accuracy : 0.89867, val loss: 7.98626, val accuracy: 0.86054
Final : 0.902959885129888 [('val/VGG16/monotone/f1-score', 0.9130434782608695), ('val/VGG16/screenshot/f1-score', 0.9029850746268657), ('val/VGG16/unknown/f1-score', 0.8929627439384978)]
---train finished---
Trying to save to /tmp/tmpahv1rbn3/model
Too long checkpoint name: VGG16_64_[0.3, 0.2, 0.2, 0.3]_[3, 1]_1.0_9.999999999999999e-05_[1.00600004196167, 1.079699993133545, 1.0401999950408936, 1.2753000259399414]_Adam_10_1_0 not saved
Done
VGG16 Loaded!
{'batch_size': 64,
 'class_ratio': [0.3, 0.2, 0.2, 0.3],
 'epoch': [3, 1],
 'gamma': 0.1,
 'learning_rate': 1e-06,
 'loss_cls_weight': tensor([1.0060, 1.0797, 1.0402, 1.2753]),
 'optimizer': 'Adam',
 'step_size': 10,
 'transforms': [1,
                Compose(
    ColorJitter(brightness=None, contrast=None, saturation=[0.95, 1.05], hue=[-0.05, 0.05])
    RandomHorizontalFlip(p=0.5)
    RandomRotation(degrees=(-20, 20), resample=2, expand=False)
    ToTensor()
    Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])
)],
 'weight_decay': 0.001}
Dataloader constructed!
Epoch: 0, batch loss: 0.53181 Loss Sum: 241.28900, accuracy : 0.58690, val loss: 12.41028, val accuracy: 0.78851
Final : 0.8485246476635311 [('val/VGG16/monotone/f1-score', 0.8873239436619718), ('val/VGG16/screenshot/f1-score', 0.8264150943396227), ('val/VGG16/unknown/f1-score', 0.8331303288672351)]
Epoch: 1, batch loss: 0.29530 Loss Sum: 110.74319, accuracy : 0.84834, val loss: 8.50856, val accuracy: 0.84368
Final : 0.8849687008774361 [('val/VGG16/monotone/f1-score', 0.907142857142857), ('val/VGG16/screenshot/f1-score', 0.8670520231213873), ('val/VGG16/unknown/f1-score', 0.8811764705882353)]
Epoch: 2, batch loss: 0.29921 Loss Sum: 80.83858, accuracy : 0.88535, val loss: 7.64804, val accuracy: 0.85824
Final : 0.8987141760156326 [('val/VGG16/monotone/f1-score', 0.9064748201438849), ('val/VGG16/screenshot/f1-score', 0.8983364140480592), ('val/VGG16/unknown/f1-score', 0.8913946587537093)]
Epoch: 3, batch loss: 0.48250 Loss Sum: 69.15006, accuracy : 0.90159, val loss: 7.73370, val accuracy: 0.85977
Final : 0.9019936316377213 [('val/VGG16/monotone/f1-score', 0.9175627240143369), ('val/VGG16/screenshot/f1-score', 0.895910780669145), ('val/VGG16/unknown/f1-score', 0.8927089508002372)]
---train finished---
Trying to save to /tmp/tmp928zg413/model
Too long checkpoint name: VGG16_64_[0.3, 0.2, 0.2, 0.3]_[3, 1]_1.0_9.999999999999999e-05_[1.00600004196167, 1.079699993133545, 1.0401999950408936, 1.2753000259399414]_Adam_10_1_100.0 not saved
Done
VGG16 Loaded!
{'batch_size': 64,
 'class_ratio': [0.3, 0.2, 0.2, 0.3],
 'epoch': [3, 1],
 'gamma': 0.1,
 'learning_rate': 1e-06,
 'loss_cls_weight': tensor([1.0060, 1.0797, 1.0402, 1.2753]),
 'optimizer': 'Adam',
 'step_size': 10,
 'transforms': [2,
                Compose(
    RandomAffine(degrees=(0, 0), scale=(0.75, 1.25))
    RandomPerspective(p=0.4)
    RandomHorizontalFlip(p=0.5)
    ToTensor()
    Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])
)],
 'weight_decay': 0}
Dataloader constructed!
Epoch: 0, batch loss: 0.86510 Loss Sum: 259.40097, accuracy : 0.54126, val loss: 14.12968, val accuracy: 0.78238
Final : 0.8530975285259116 [('val/VGG16/monotone/f1-score', 0.8916666666666667), ('val/VGG16/screenshot/f1-score', 0.8361581920903955), ('val/VGG16/unknown/f1-score', 0.8327316486161253)]
Epoch: 1, batch loss: 0.46228 Loss Sum: 138.27445, accuracy : 0.82029, val loss: 10.39988, val accuracy: 0.81839
Final : 0.8764897778244389 [('val/VGG16/monotone/f1-score', 0.9110320284697508), ('val/VGG16/screenshot/f1-score', 0.8614232209737828), ('val/VGG16/unknown/f1-score', 0.8580060422960725)]
Epoch: 2, batch loss: 0.33796 Loss Sum: 96.11026, accuracy : 0.86350, val loss: 9.16224, val accuracy: 0.84215
Final : 0.8922125229677306 [('val/VGG16/monotone/f1-score', 0.9236363636363636), ('val/VGG16/screenshot/f1-score', 0.8754716981132076), ('val/VGG16/unknown/f1-score', 0.8783382789317506)]
Epoch: 3, batch loss: 0.26905 Loss Sum: 81.76607, accuracy : 0.88425, val loss: 8.30781, val accuracy: 0.85517
Final : 0.9007181384818695 [('val/VGG16/monotone/f1-score', 0.924731182795699), ('val/VGG16/screenshot/f1-score', 0.8884758364312267), ('val/VGG16/unknown/f1-score', 0.8894173602853745)]
---train finished---
Trying to save to /tmp/tmpfzybdw41/model
Too long checkpoint name: VGG16_64_[0.3, 0.2, 0.2, 0.3]_[3, 1]_1.0_9.999999999999999e-05_[1.00600004196167, 1.079699993133545, 1.0401999950408936, 1.2753000259399414]_Adam_10_2_0 not saved
Done
VGG16 Loaded!
{'batch_size': 64,
 'class_ratio': [0.3, 0.2, 0.2, 0.3],
 'epoch': [3, 1],
 'gamma': 0.1,
 'learning_rate': 1e-06,
 'loss_cls_weight': tensor([1.0060, 1.0797, 1.0402, 1.2753]),
 'optimizer': 'Adam',
 'step_size': 10,
 'transforms': [2,
                Compose(
    RandomAffine(degrees=(0, 0), scale=(0.75, 1.25))
    RandomPerspective(p=0.4)
    RandomHorizontalFlip(p=0.5)
    ToTensor()
    Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])
)],
 'weight_decay': 0.001}
Dataloader constructed!
Epoch: 0, batch loss: 0.69140 Loss Sum: 256.89539, accuracy : 0.54339, val loss: 14.66920, val accuracy: 0.76169
Final : 0.8484077528040306 [('val/VGG16/monotone/f1-score', 0.9045643153526971), ('val/VGG16/screenshot/f1-score', 0.8304761904761904), ('val/VGG16/unknown/f1-score', 0.8129189518586227)]
Epoch: 1, batch loss: 0.46562 Loss Sum: 137.48513, accuracy : 0.81615, val loss: 10.25660, val accuracy: 0.81303
Final : 0.870983294801785 [('val/VGG16/monotone/f1-score', 0.896797153024911), ('val/VGG16/screenshot/f1-score', 0.8631984585741811), ('val/VGG16/unknown/f1-score', 0.8535414165666265)]
Epoch: 2, batch loss: 0.32002 Loss Sum: 97.00552, accuracy : 0.85972, val loss: 9.60189, val accuracy: 0.83065
Final : 0.8874616512103229 [('val/VGG16/monotone/f1-score', 0.9343065693430657), ('val/VGG16/screenshot/f1-score', 0.8593448940269749), ('val/VGG16/unknown/f1-score', 0.8705463182897862)]
Epoch: 3, batch loss: 0.42240 Loss Sum: 82.39519, accuracy : 0.88224, val loss: 8.01043, val accuracy: 0.86207
Final : 0.9011452130488927 [('val/VGG16/monotone/f1-score', 0.927007299270073), ('val/VGG16/screenshot/f1-score', 0.8807692307692309), ('val/VGG16/unknown/f1-score', 0.8962703962703962)]
---train finished---
Trying to save to /tmp/tmppefxqu6x/model
Too long checkpoint name: VGG16_64_[0.3, 0.2, 0.2, 0.3]_[3, 1]_1.0_9.999999999999999e-05_[1.00600004196167, 1.079699993133545, 1.0401999950408936, 1.2753000259399414]_Adam_10_2_100.0 not saved
Done
VGG16 Loaded!
{'batch_size': 64,
 'class_ratio': [0.3, 0.2, 0.2, 0.3],
 'epoch': [3, 1],
 'gamma': 0.1,
 'learning_rate': 1e-06,
 'loss_cls_weight': tensor([1.0060, 1.0797, 1.0402, 1.2753]),
 'optimizer': 'Adam',
 'step_size': 2,
 'transforms': [1,
                Compose(
    ColorJitter(brightness=None, contrast=None, saturation=[0.95, 1.05], hue=[-0.05, 0.05])
    RandomHorizontalFlip(p=0.5)
    RandomRotation(degrees=(-20, 20), resample=2, expand=False)
    ToTensor()
    Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])
)],
 'weight_decay': 0}
Dataloader constructed!
Epoch: 0, batch loss: 0.65015 Loss Sum: 240.61571, accuracy : 0.59378, val loss: 12.77438, val accuracy: 0.77088
Final : 0.8427313623965934 [('val/VGG16/monotone/f1-score', 0.8710801393728222), ('val/VGG16/screenshot/f1-score', 0.8406909788867563), ('val/VGG16/unknown/f1-score', 0.817283950617284)]
Epoch: 1, batch loss: 0.22184 Loss Sum: 111.80793, accuracy : 0.84628, val loss: 8.18607, val accuracy: 0.84904
Final : 0.8931694707973916 [('val/VGG16/monotone/f1-score', 0.9110320284697508), ('val/VGG16/screenshot/f1-score', 0.8841698841698841), ('val/VGG16/unknown/f1-score', 0.8845700824499412)]
Epoch: 2, batch loss: 0.43993 Loss Sum: 90.00426, accuracy : 0.87214, val loss: 8.44623, val accuracy: 0.84444
Final : 0.8885931359829092 [('val/VGG16/monotone/f1-score', 0.9), ('val/VGG16/screenshot/f1-score', 0.8846153846153847), ('val/VGG16/unknown/f1-score', 0.8812758417011222)]
Epoch: 3, batch loss: 0.43944 Loss Sum: 88.05453, accuracy : 0.87652, val loss: 9.37055, val accuracy: 0.82682
Final : 0.8858382809672881 [('val/VGG16/monotone/f1-score', 0.9169675090252708), ('val/VGG16/screenshot/f1-score', 0.8761904761904762), ('val/VGG16/unknown/f1-score', 0.8651887357699222)]
---train finished---
Trying to save to /tmp/tmpnv50mvf2/model
Too long checkpoint name: VGG16_64_[0.3, 0.2, 0.2, 0.3]_[3, 1]_1.0_9.999999999999999e-05_[1.00600004196167, 1.079699993133545, 1.0401999950408936, 1.2753000259399414]_Adam_2_1_0 not saved
Done
VGG16 Loaded!
{'batch_size': 64,
 'class_ratio': [0.3, 0.2, 0.2, 0.3],
 'epoch': [3, 1],
 'gamma': 0.1,
 'learning_rate': 1e-06,
 'loss_cls_weight': tensor([1.0060, 1.0797, 1.0402, 1.2753]),
 'optimizer': 'Adam',
 'step_size': 2,
 'transforms': [1,
                Compose(
    ColorJitter(brightness=None, contrast=None, saturation=[0.95, 1.05], hue=[-0.05, 0.05])
    RandomHorizontalFlip(p=0.5)
    RandomRotation(degrees=(-20, 20), resample=2, expand=False)
    ToTensor()
    Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])
)],
 'weight_decay': 0.001}
Dataloader constructed!
Epoch: 0, batch loss: 0.56980 Loss Sum: 242.02106, accuracy : 0.58289, val loss: 12.68562, val accuracy: 0.78621
Final : 0.8501845387055639 [('val/VGG16/monotone/f1-score', 0.8771929824561403), ('val/VGG16/screenshot/f1-score', 0.8414872798434442), ('val/VGG16/unknown/f1-score', 0.8325242718446603)]
Epoch: 1, batch loss: 0.27972 Loss Sum: 116.31333, accuracy : 0.84037, val loss: 8.84699, val accuracy: 0.83831
Final : 0.8799118476617115 [('val/VGG16/monotone/f1-score', 0.9), ('val/VGG16/screenshot/f1-score', 0.8646616541353384), ('val/VGG16/unknown/f1-score', 0.8754448398576513)]
Epoch: 2, batch loss: 0.44037 Loss Sum: 94.07711, accuracy : 0.86843, val loss: 9.11114, val accuracy: 0.83372
Final : 0.8824908220135783 [('val/VGG16/monotone/f1-score', 0.9064748201438849), ('val/VGG16/screenshot/f1-score', 0.8710280373831776), ('val/VGG16/unknown/f1-score', 0.8704477611940299)]
Epoch: 3, batch loss: 0.32308 Loss Sum: 92.20147, accuracy : 0.87171, val loss: 8.83014, val accuracy: 0.84138
Final : 0.8866058058911301 [('val/VGG16/monotone/f1-score', 0.9045936395759718), ('val/VGG16/screenshot/f1-score', 0.8775894538606404), ('val/VGG16/unknown/f1-score', 0.8779035139964264)]
---train finished---
Trying to save to /tmp/tmpxambp1bc/model
Too long checkpoint name: VGG16_64_[0.3, 0.2, 0.2, 0.3]_[3, 1]_1.0_9.999999999999999e-05_[1.00600004196167, 1.079699993133545, 1.0401999950408936, 1.2753000259399414]_Adam_2_1_100.0 not saved
Done
VGG16 Loaded!
{'batch_size': 64,
 'class_ratio': [0.3, 0.2, 0.2, 0.3],
 'epoch': [3, 1],
 'gamma': 0.1,
 'learning_rate': 1e-06,
 'loss_cls_weight': tensor([1.0060, 1.0797, 1.0402, 1.2753]),
 'optimizer': 'Adam',
 'step_size': 2,
 'transforms': [2,
                Compose(
    RandomAffine(degrees=(0, 0), scale=(0.75, 1.25))
    RandomPerspective(p=0.4)
    RandomHorizontalFlip(p=0.5)
    ToTensor()
    Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])
)],
 'weight_decay': 0}
Dataloader constructed!
Epoch: 0, batch loss: 0.78764 Loss Sum: 261.07925, accuracy : 0.51984, val loss: 14.54644, val accuracy: 0.77548
Final : 0.8527863732750347 [('val/VGG16/monotone/f1-score', 0.9037656903765691), ('val/VGG16/screenshot/f1-score', 0.8301886792452831), ('val/VGG16/unknown/f1-score', 0.8265861027190332)]
Epoch: 1, batch loss: 0.39463 Loss Sum: 138.91562, accuracy : 0.81731, val loss: 10.26223, val accuracy: 0.82452
Final : 0.8847214733171166 [('val/VGG16/monotone/f1-score', 0.9208633093525179), ('val/VGG16/screenshot/f1-score', 0.8699029126213592), ('val/VGG16/unknown/f1-score', 0.8644776119402986)]
Epoch: 2, batch loss: 0.23698 Loss Sum: 105.06014, accuracy : 0.85327, val loss: 9.73677, val accuracy: 0.82835
Final : 0.8842667338274792 [('val/VGG16/monotone/f1-score', 0.9236363636363636), ('val/VGG16/screenshot/f1-score', 0.8620689655172413), ('val/VGG16/unknown/f1-score', 0.8683740321620012)]
Epoch: 3, batch loss: 0.28211 Loss Sum: 102.53989, accuracy : 0.85668, val loss: 10.54779, val accuracy: 0.82299
Final : 0.8852187710356445 [('val/VGG16/monotone/f1-score', 0.9214285714285714), ('val/VGG16/screenshot/f1-score', 0.8735632183908045), ('val/VGG16/unknown/f1-score', 0.8617788461538461)]
---train finished---
Trying to save to /tmp/tmp5chqz_u8/model
Too long checkpoint name: VGG16_64_[0.3, 0.2, 0.2, 0.3]_[3, 1]_1.0_9.999999999999999e-05_[1.00600004196167, 1.079699993133545, 1.0401999950408936, 1.2753000259399414]_Adam_2_2_0 not saved
Done
VGG16 Loaded!
{'batch_size': 64,
 'class_ratio': [0.3, 0.2, 0.2, 0.3],
 'epoch': [3, 1],
 'gamma': 0.1,
 'learning_rate': 1e-06,
 'loss_cls_weight': tensor([1.0060, 1.0797, 1.0402, 1.2753]),
 'optimizer': 'Adam',
 'step_size': 2,
 'transforms': [2,
                Compose(
    RandomAffine(degrees=(0, 0), scale=(0.75, 1.25))
    RandomPerspective(p=0.4)
    RandomHorizontalFlip(p=0.5)
    ToTensor()
    Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])
)],
 'weight_decay': 0.001}
Dataloader constructed!
Epoch: 0, batch loss: 0.92532 Loss Sum: 262.30830, accuracy : 0.52033, val loss: 14.93971, val accuracy: 0.75479
Final : 0.8383604611703099 [('val/VGG16/monotone/f1-score', 0.8744588744588744), ('val/VGG16/screenshot/f1-score', 0.8348794063079777), ('val/VGG16/unknown/f1-score', 0.8071034905082669)]
Epoch: 1, batch loss: 0.56961 Loss Sum: 141.44976, accuracy : 0.81779, val loss: 10.24676, val accuracy: 0.81839
Final : 0.8775733495113204 [('val/VGG16/monotone/f1-score', 0.9045936395759718), ('val/VGG16/screenshot/f1-score', 0.8721804511278196), ('val/VGG16/unknown/f1-score', 0.8566243194192378)]
Epoch: 2, batch loss: 0.34825 Loss Sum: 108.66245, accuracy : 0.84749, val loss: 10.09582, val accuracy: 0.82222
Final : 0.88114809815538 [('val/VGG16/monotone/f1-score', 0.9045936395759718), ('val/VGG16/screenshot/f1-score', 0.879852125693161), ('val/VGG16/unknown/f1-score', 0.8595744680851064)]
Epoch: 3, batch loss: 0.31218 Loss Sum: 105.77853, accuracy : 0.85181, val loss: 9.85080, val accuracy: 0.83525
Final : 0.8851182176476765 [('val/VGG16/monotone/f1-score', 0.9078014184397163), ('val/VGG16/screenshot/f1-score', 0.8752327746741155), ('val/VGG16/unknown/f1-score', 0.872749099639856)]
---train finished---
Trying to save to /tmp/tmpzyb1e7_c/model
Too long checkpoint name: VGG16_64_[0.3, 0.2, 0.2, 0.3]_[3, 1]_1.0_9.999999999999999e-05_[1.00600004196167, 1.079699993133545, 1.0401999950408936, 1.2753000259399414]_Adam_2_2_100.0 not saved
Done
VGG16 Loaded!
{'batch_size': 64,
 'class_ratio': [0.3, 0.2, 0.2, 0.3],
 'epoch': [3, 1],
 'gamma': 0.1,
 'learning_rate': 1e-06,
 'loss_cls_weight': tensor([1.0060, 1.0797, 1.0402, 1.2753]),
 'optimizer': 'SGD',
 'step_size': 10,
 'transforms': [1,
                Compose(
    ColorJitter(brightness=None, contrast=None, saturation=[0.95, 1.05], hue=[-0.05, 0.05])
    RandomHorizontalFlip(p=0.5)
    RandomRotation(degrees=(-20, 20), resample=2, expand=False)
    ToTensor()
    Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])
)],
 'weight_decay': 0}
Dataloader constructed!
Epoch: 0, batch loss: 1.34535 Loss Sum: 351.61061, accuracy : 0.28706, val loss: 28.20042, val accuracy: 0.34483
Final : 0.23761906698719537 [('val/VGG16/monotone/f1-score', 0.10980392156862744), ('val/VGG16/screenshot/f1-score', 0.2380038387715931), ('val/VGG16/unknown/f1-score', 0.5133836650652024)]
Epoch: 1, batch loss: 1.34247 Loss Sum: 348.24934, accuracy : 0.30611, val loss: 27.73964, val accuracy: 0.38621
Final : 0.2535018767932129 [('val/VGG16/monotone/f1-score', 0.0970873786407767), ('val/VGG16/screenshot/f1-score', 0.2974559686888454), ('val/VGG16/unknown/f1-score', 0.5641025641025641)]
Epoch: 2, batch loss: 1.34744 Loss Sum: 344.84506, accuracy : 0.31463, val loss: 27.27125, val accuracy: 0.41916
Final : 0.247055902701146 [('val/VGG16/monotone/f1-score', 0.09302325581395349), ('val/VGG16/screenshot/f1-score', 0.2723214285714286), ('val/VGG16/unknown/f1-score', 0.5952677459526775)]
Epoch: 3, batch loss: 1.34285 Loss Sum: 341.38410, accuracy : 0.32662, val loss: 26.80755, val accuracy: 0.46207
Final : 0.255934448179878 [('val/VGG16/monotone/f1-score', 0.08641975308641975), ('val/VGG16/screenshot/f1-score', 0.3009708737864078), ('val/VGG16/unknown/f1-score', 0.6445383222691612)]
---train finished---
Trying to save to /tmp/tmpu6bjpn39/model
Too long checkpoint name: VGG16_64_[0.3, 0.2, 0.2, 0.3]_[3, 1]_1.0_9.999999999999999e-05_[1.00600004196167, 1.079699993133545, 1.0401999950408936, 1.2753000259399414]_SGD_10_1_0 not saved
Done
VGG16 Loaded!
{'batch_size': 64,
 'class_ratio': [0.3, 0.2, 0.2, 0.3],
 'epoch': [3, 1],
 'gamma': 0.1,
 'learning_rate': 1e-06,
 'loss_cls_weight': tensor([1.0060, 1.0797, 1.0402, 1.2753]),
 'optimizer': 'SGD',
 'step_size': 10,
 'transforms': [1,
                Compose(
    ColorJitter(brightness=None, contrast=None, saturation=[0.95, 1.05], hue=[-0.05, 0.05])
    RandomHorizontalFlip(p=0.5)
    RandomRotation(degrees=(-20, 20), resample=2, expand=False)
    ToTensor()
    Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])
)],
 'weight_decay': 0.001}
Dataloader constructed!
Epoch: 0, batch loss: 1.39086 Loss Sum: 359.37431, accuracy : 0.26010, val loss: 29.29989, val accuracy: 0.23831
Final : 0.22269528948845801 [('val/VGG16/monotone/f1-score', 0.13666666666666666), ('val/VGG16/screenshot/f1-score', 0.23061630218687873), ('val/VGG16/unknown/f1-score', 0.35041322314049583)]
Epoch: 1, batch loss: 1.38174 Loss Sum: 354.64048, accuracy : 0.28858, val loss: 28.66681, val accuracy: 0.31034
Final : 0.25764832253934944 [('val/VGG16/monotone/f1-score', 0.1290322580645161), ('val/VGG16/screenshot/f1-score', 0.2911392405063291), ('val/VGG16/unknown/f1-score', 0.45528455284552843)]
Epoch: 2, batch loss: 1.34262 Loss Sum: 350.11708, accuracy : 0.30897, val loss: 28.01054, val accuracy: 0.39693
Final : 0.3253573183932765 [('val/VGG16/monotone/f1-score', 0.2046204620462046), ('val/VGG16/screenshot/f1-score', 0.3008849557522124), ('val/VGG16/unknown/f1-score', 0.5594125500667556)]
Epoch: 3, batch loss: 1.32593 Loss Sum: 345.68510, accuracy : 0.33429, val loss: 27.55572, val accuracy: 0.41762
Final : 0.2722396484699311 [('val/VGG16/monotone/f1-score', 0.10483870967741934), ('val/VGG16/screenshot/f1-score', 0.32547169811320753), ('val/VGG16/unknown/f1-score', 0.5913154533844188)]
---train finished---
Trying to save to /tmp/tmpi5bvuora/model
Too long checkpoint name: VGG16_64_[0.3, 0.2, 0.2, 0.3]_[3, 1]_1.0_9.999999999999999e-05_[1.00600004196167, 1.079699993133545, 1.0401999950408936, 1.2753000259399414]_SGD_10_1_100.0 not saved
Done
VGG16 Loaded!
{'batch_size': 64,
 'class_ratio': [0.3, 0.2, 0.2, 0.3],
 'epoch': [3, 1],
 'gamma': 0.1,
 'learning_rate': 1e-06,
 'loss_cls_weight': tensor([1.0060, 1.0797, 1.0402, 1.2753]),
 'optimizer': 'SGD',
 'step_size': 10,
 'transforms': [2,
                Compose(
    RandomAffine(degrees=(0, 0), scale=(0.75, 1.25))
    RandomPerspective(p=0.4)
    RandomHorizontalFlip(p=0.5)
    ToTensor()
    Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])
)],
 'weight_decay': 0}
Dataloader constructed!
Epoch: 0, batch loss: 1.38575 Loss Sum: 358.19933, accuracy : 0.27453, val loss: 28.82962, val accuracy: 0.29579
Final : 0.26825800481623197 [('val/VGG16/monotone/f1-score', 0.178752107925801), ('val/VGG16/screenshot/f1-score', 0.26452905811623245), ('val/VGG16/unknown/f1-score', 0.40825688073394495)]
Epoch: 1, batch loss: 1.37456 Loss Sum: 353.64124, accuracy : 0.29771, val loss: 28.14136, val accuracy: 0.37395
Final : 0.3138026153335869 [('val/VGG16/monotone/f1-score', 0.2232558139534884), ('val/VGG16/screenshot/f1-score', 0.2658730158730158), ('val/VGG16/unknown/f1-score', 0.520586182833217)]
Epoch: 2, batch loss: 1.33854 Loss Sum: 349.46597, accuracy : 0.31883, val loss: 27.70719, val accuracy: 0.42605
Final : 0.3067834215274834 [('val/VGG16/monotone/f1-score', 0.14814814814814817), ('val/VGG16/screenshot/f1-score', 0.332657200811359), ('val/VGG16/unknown/f1-score', 0.5858716785482826)]
Epoch: 3, batch loss: 1.36251 Loss Sum: 345.40803, accuracy : 0.33319, val loss: 27.20762, val accuracy: 0.46667
Final : 0.3166324895534437 [('val/VGG16/monotone/f1-score', 0.14457831325301204), ('val/VGG16/screenshot/f1-score', 0.3534303534303534), ('val/VGG16/unknown/f1-score', 0.6212400245549418)]
---train finished---
Trying to save to /tmp/tmpo0fkyb98/model
Too long checkpoint name: VGG16_64_[0.3, 0.2, 0.2, 0.3]_[3, 1]_1.0_9.999999999999999e-05_[1.00600004196167, 1.079699993133545, 1.0401999950408936, 1.2753000259399414]_SGD_10_2_0 not saved
Done
VGG16 Loaded!
{'batch_size': 64,
 'class_ratio': [0.3, 0.2, 0.2, 0.3],
 'epoch': [3, 1],
 'gamma': 0.1,
 'learning_rate': 1e-06,
 'loss_cls_weight': tensor([1.0060, 1.0797, 1.0402, 1.2753]),
 'optimizer': 'SGD',
 'step_size': 10,
 'transforms': [2,
                Compose(
    RandomAffine(degrees=(0, 0), scale=(0.75, 1.25))
    RandomPerspective(p=0.4)
    RandomHorizontalFlip(p=0.5)
    ToTensor()
    Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])
)],
 'weight_decay': 0.001}
Dataloader constructed!
Epoch: 0, batch loss: 1.37301 Loss Sum: 352.77284, accuracy : 0.26844, val loss: 28.22269, val accuracy: 0.35172
Final : 0.21577413443985308 [('val/VGG16/monotone/f1-score', 0.09448818897637795), ('val/VGG16/screenshot/f1-score', 0.19367588932806326), ('val/VGG16/unknown/f1-score', 0.5489655172413793)]
Epoch: 1, batch loss: 1.36989 Loss Sum: 352.13619, accuracy : 0.27306, val loss: 28.24295, val accuracy: 0.35249
Final : 0.18008027665904594 [('val/VGG16/monotone/f1-score', 0.07407407407407408), ('val/VGG16/screenshot/f1-score', 0.14285714285714288), ('val/VGG16/unknown/f1-score', 0.5518617021276596)]
Epoch: 2, batch loss: 1.36871 Loss Sum: 351.63195, accuracy : 0.27246, val loss: 28.07630, val accuracy: 0.36245
Final : 0.17320199013909082 [('val/VGG16/monotone/f1-score', 0.05286343612334802), ('val/VGG16/screenshot/f1-score', 0.17391304347826086), ('val/VGG16/unknown/f1-score', 0.5651595744680851)]
Epoch: 3, batch loss: 1.36377 Loss Sum: 350.70935, accuracy : 0.27775, val loss: 27.86480, val accuracy: 0.38544
Final : 0.17333747586200549 [('val/VGG16/monotone/f1-score', 0.04081632653061224), ('val/VGG16/screenshot/f1-score', 0.21906693711967545), ('val/VGG16/unknown/f1-score', 0.5824607329842931)]
---train finished---
Trying to save to /tmp/tmpn93depgn/model
Too long checkpoint name: VGG16_64_[0.3, 0.2, 0.2, 0.3]_[3, 1]_1.0_9.999999999999999e-05_[1.00600004196167, 1.079699993133545, 1.0401999950408936, 1.2753000259399414]_SGD_10_2_100.0 not saved
Done
VGG16 Loaded!
{'batch_size': 64,
 'class_ratio': [0.3, 0.2, 0.2, 0.3],
 'epoch': [3, 1],
 'gamma': 0.1,
 'learning_rate': 1e-06,
 'loss_cls_weight': tensor([1.0060, 1.0797, 1.0402, 1.2753]),
 'optimizer': 'SGD',
 'step_size': 2,
 'transforms': [1,
                Compose(
    ColorJitter(brightness=None, contrast=None, saturation=[0.95, 1.05], hue=[-0.05, 0.05])
    RandomHorizontalFlip(p=0.5)
    RandomRotation(degrees=(-20, 20), resample=2, expand=False)
    ToTensor()
    Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])
)],
 'weight_decay': 0}
Dataloader constructed!
Epoch: 0, batch loss: 1.36477 Loss Sum: 357.71080, accuracy : 0.25310, val loss: 29.24530, val accuracy: 0.23755
Final : 0.179942832781655 [('val/VGG16/monotone/f1-score', 0.0923076923076923), ('val/VGG16/screenshot/f1-score', 0.15489749430523922), ('val/VGG16/unknown/f1-score', 0.40749414519906324)]
Epoch: 1, batch loss: 1.40931 Loss Sum: 356.04614, accuracy : 0.26004, val loss: 29.05596, val accuracy: 0.25977
Final : 0.18645711821239946 [('val/VGG16/monotone/f1-score', 0.08668730650154798), ('val/VGG16/screenshot/f1-score', 0.170316301703163), ('val/VGG16/unknown/f1-score', 0.4390613171839516)]
Epoch: 2, batch loss: 1.36065 Loss Sum: 356.38401, accuracy : 0.26199, val loss: 29.07166, val accuracy: 0.25747
Final : 0.18123980631105438 [('val/VGG16/monotone/f1-score', 0.09180327868852459), ('val/VGG16/screenshot/f1-score', 0.14797136038186157), ('val/VGG16/unknown/f1-score', 0.43825301204819284)]
Epoch: 3, batch loss: 1.36399 Loss Sum: 356.16660, accuracy : 0.25968, val loss: 29.18394, val accuracy: 0.25900
Final : 0.1748842691375362 [('val/VGG16/monotone/f1-score', 0.09615384615384615), ('val/VGG16/screenshot/f1-score', 0.12530120481927712), ('val/VGG16/unknown/f1-score', 0.4439461883408072)]
---train finished---
Trying to save to /tmp/tmpjya0411n/model
Too long checkpoint name: VGG16_64_[0.3, 0.2, 0.2, 0.3]_[3, 1]_1.0_9.999999999999999e-05_[1.00600004196167, 1.079699993133545, 1.0401999950408936, 1.2753000259399414]_SGD_2_1_0 not saved
Done
VGG16 Loaded!
{'batch_size': 64,
 'class_ratio': [0.3, 0.2, 0.2, 0.3],
 'epoch': [3, 1],
 'gamma': 0.1,
 'learning_rate': 1e-06,
 'loss_cls_weight': tensor([1.0060, 1.0797, 1.0402, 1.2753]),
 'optimizer': 'SGD',
 'step_size': 2,
 'transforms': [1,
                Compose(
    ColorJitter(brightness=None, contrast=None, saturation=[0.95, 1.05], hue=[-0.05, 0.05])
    RandomHorizontalFlip(p=0.5)
    RandomRotation(degrees=(-20, 20), resample=2, expand=False)
    ToTensor()
    Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])
)],
 'weight_decay': 0.001}
Dataloader constructed!
Epoch: 0, batch loss: 1.33810 Loss Sum: 352.95955, accuracy : 0.26777, val loss: 27.94710, val accuracy: 0.37625
Final : 0.13196964535913341 [('val/VGG16/monotone/f1-score', 0.021739130434782608), ('val/VGG16/screenshot/f1-score', 0.18796992481203006), ('val/VGG16/unknown/f1-score', 0.5624599615631006)]
Epoch: 1, batch loss: 1.28587 Loss Sum: 349.45413, accuracy : 0.28578, val loss: 27.66706, val accuracy: 0.38238
Final : 0.15689239364478735 [('val/VGG16/monotone/f1-score', 0.03508771929824561), ('val/VGG16/screenshot/f1-score', 0.196), ('val/VGG16/unknown/f1-score', 0.5615577889447236)]
Epoch: 2, batch loss: 1.34357 Loss Sum: 347.51894, accuracy : 0.29613, val loss: 27.50516, val accuracy: 0.41073
Final : 0.1655007127553529 [('val/VGG16/monotone/f1-score', 0.03571428571428571), ('val/VGG16/screenshot/f1-score', 0.21491228070175436), ('val/VGG16/unknown/f1-score', 0.5906040268456376)]
Epoch: 3, batch loss: 1.40146 Loss Sum: 348.12639, accuracy : 0.28919, val loss: 27.45814, val accuracy: 0.42299
Final : 0.14996072891004983 [('val/VGG16/monotone/f1-score', 0.02531645569620253), ('val/VGG16/screenshot/f1-score', 0.21987315010570826), ('val/VGG16/unknown/f1-score', 0.6058394160583941)]
---train finished---
Trying to save to /tmp/tmpg43clzvc/model
Too long checkpoint name: VGG16_64_[0.3, 0.2, 0.2, 0.3]_[3, 1]_1.0_9.999999999999999e-05_[1.00600004196167, 1.079699993133545, 1.0401999950408936, 1.2753000259399414]_SGD_2_1_100.0 not saved
Done
VGG16 Loaded!
{'batch_size': 64,
 'class_ratio': [0.3, 0.2, 0.2, 0.3],
 'epoch': [3, 1],
 'gamma': 0.1,
 'learning_rate': 1e-06,
 'loss_cls_weight': tensor([1.0060, 1.0797, 1.0402, 1.2753]),
 'optimizer': 'SGD',
 'step_size': 2,
 'transforms': [2,
                Compose(
    RandomAffine(degrees=(0, 0), scale=(0.75, 1.25))
    RandomPerspective(p=0.4)
    RandomHorizontalFlip(p=0.5)
    ToTensor()
    Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])
)],
 'weight_decay': 0}
Dataloader constructed!
Epoch: 0, batch loss: 1.30031 Loss Sum: 347.95929, accuracy : 0.27684, val loss: 26.23541, val accuracy: 0.47050
Final : 0.0 [('val/VGG16/monotone/f1-score', 0.0), ('val/VGG16/screenshot/f1-score', 0.3111111111111111), ('val/VGG16/unknown/f1-score', 0.6509155345540462)]
Epoch: 1, batch loss: 1.17803 Loss Sum: 324.87844, accuracy : 0.35157, val loss: 23.48211, val accuracy: 0.65824
Final : 0.0 [('val/VGG16/monotone/f1-score', 0.0), ('val/VGG16/screenshot/f1-score', 0.5116279069767442), ('val/VGG16/unknown/f1-score', 0.7892004153686396)]
Epoch: 2, batch loss: 1.19904 Loss Sum: 313.88037, accuracy : 0.38157, val loss: 22.94557, val accuracy: 0.67969
Final : 0.0 [('val/VGG16/monotone/f1-score', 0.0), ('val/VGG16/screenshot/f1-score', 0.6104218362282878), ('val/VGG16/unknown/f1-score', 0.7970787689097548)]
Epoch: 3, batch loss: 1.20185 Loss Sum: 311.60948, accuracy : 0.38565, val loss: 23.04335, val accuracy: 0.65670
Final : 0.0 [('val/VGG16/monotone/f1-score', 0.0), ('val/VGG16/screenshot/f1-score', 0.592039800995025), ('val/VGG16/unknown/f1-score', 0.7780706378492357)]
---train finished---
Trying to save to /tmp/tmpznho74le/model
Too long checkpoint name: VGG16_64_[0.3, 0.2, 0.2, 0.3]_[3, 1]_1.0_9.999999999999999e-05_[1.00600004196167, 1.079699993133545, 1.0401999950408936, 1.2753000259399414]_SGD_2_2_0 not saved
Done
VGG16 Loaded!
{'batch_size': 64,
 'class_ratio': [0.3, 0.2, 0.2, 0.3],
 'epoch': [3, 1],
 'gamma': 0.1,
 'learning_rate': 1e-06,
 'loss_cls_weight': tensor([1.0060, 1.0797, 1.0402, 1.2753]),
 'optimizer': 'SGD',
 'step_size': 2,
 'transforms': [2,
                Compose(
    RandomAffine(degrees=(0, 0), scale=(0.75, 1.25))
    RandomPerspective(p=0.4)
    RandomHorizontalFlip(p=0.5)
    ToTensor()
    Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])
)],
 'weight_decay': 0.001}
Dataloader constructed!
Epoch: 0, batch loss: 1.42063 Loss Sum: 360.46535, accuracy : 0.24884, val loss: 30.24547, val accuracy: 0.17318
Final : 0.17924211987862498 [('val/VGG16/monotone/f1-score', 0.10396039603960397), ('val/VGG16/screenshot/f1-score', 0.2743988684582744), ('val/VGG16/unknown/f1-score', 0.20186915887850468)]
Epoch: 1, batch loss: 1.41172 Loss Sum: 359.31906, accuracy : 0.25749, val loss: 30.29892, val accuracy: 0.17471
Final : 0.1923927828163102 [('val/VGG16/monotone/f1-score', 0.13333333333333333), ('val/VGG16/screenshot/f1-score', 0.26458036984352773), ('val/VGG16/unknown/f1-score', 0.20186915887850468)]
Epoch: 2, batch loss: 1.39641 Loss Sum: 359.02017, accuracy : 0.25596, val loss: 30.01325, val accuracy: 0.21149
Final : 0.24654946932423671 [('val/VGG16/monotone/f1-score', 0.2188295165394402), ('val/VGG16/screenshot/f1-score', 0.2817294281729428), ('val/VGG16/unknown/f1-score', 0.24309392265193372)]
Epoch: 3, batch loss: 1.42601 Loss Sum: 358.74667, accuracy : 0.26053, val loss: 30.05629, val accuracy: 0.21533
Final : 0.22333305851863777 [('val/VGG16/monotone/f1-score', 0.13953488372093023), ('val/VGG16/screenshot/f1-score', 0.3210884353741496), ('val/VGG16/unknown/f1-score', 0.24862888482632542)]
---train finished---
Trying to save to /tmp/tmpomc9wv6p/model
Too long checkpoint name: VGG16_64_[0.3, 0.2, 0.2, 0.3]_[3, 1]_1.0_9.999999999999999e-05_[1.00600004196167, 1.079699993133545, 1.0401999950408936, 1.2753000259399414]_SGD_2_2_100.0 not saved
Done
VGG16 Loaded!
{'batch_size': 64,
 'class_ratio': [0.3, 0.2, 0.2, 0.3],
 'epoch': [3, 1],
 'gamma': 0.1,
 'learning_rate': 1e-05,
 'loss_cls_weight': tensor([1., 1., 1., 1.]),
 'optimizer': 'Adamax',
 'step_size': 10,
 'transforms': [1,
                Compose(
    ColorJitter(brightness=None, contrast=None, saturation=[0.95, 1.05], hue=[-0.05, 0.05])
    RandomHorizontalFlip(p=0.5)
    RandomRotation(degrees=(-20, 20), resample=2, expand=False)
    ToTensor()
    Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])
)],
 'weight_decay': 0}
Dataloader constructed!
Epoch: 0, batch loss: 0.30308 Loss Sum: 131.76251, accuracy : 0.80203, val loss: 8.48350, val accuracy: 0.83602
Final : 0.8892326347014902 [('val/VGG16/monotone/f1-score', 0.9142857142857144), ('val/VGG16/screenshot/f1-score', 0.8823529411764706), ('val/VGG16/unknown/f1-score', 0.8716094032549728)]
Epoch: 1, batch loss: 0.09854 Loss Sum: 66.29676, accuracy : 0.90342, val loss: 8.34282, val accuracy: 0.84521
Final : 0.8955520716796873 [('val/VGG16/monotone/f1-score', 0.9275362318840579), ('val/VGG16/screenshot/f1-score', 0.88), ('val/VGG16/unknown/f1-score', 0.879951980792317)]
Epoch: 2, batch loss: 0.16488 Loss Sum: 56.90394, accuracy : 0.92064, val loss: 7.12058, val accuracy: 0.86897
Final : 0.9126657988197279 [('val/VGG16/monotone/f1-score', 0.9343065693430657), ('val/VGG16/screenshot/f1-score', 0.903954802259887), ('val/VGG16/unknown/f1-score', 0.900117508813161)]
Epoch: 3, batch loss: 0.19939 Loss Sum: 49.59120, accuracy : 0.92874, val loss: 6.87171, val accuracy: 0.88889
Final : 0.9198526205138857 [('val/VGG16/monotone/f1-score', 0.9275362318840579), ('val/VGG16/screenshot/f1-score', 0.9158878504672897), ('val/VGG16/unknown/f1-score', 0.9161816065192083)]
---train finished---
Trying to save to /tmp/tmp1q5l2soe/model
Too long checkpoint name: VGG16_64_[0.3, 0.2, 0.2, 0.3]_[3, 1]_1.0_0.001_[1.0, 1.0, 1.0, 1.0]_Adamax_10_1_0 not saved
Done
VGG16 Loaded!
{'batch_size': 64,
 'class_ratio': [0.3, 0.2, 0.2, 0.3],
 'epoch': [3, 1],
 'gamma': 0.1,
 'learning_rate': 1e-05,
 'loss_cls_weight': tensor([1., 1., 1., 1.]),
 'optimizer': 'Adamax',
 'step_size': 10,
 'transforms': [1,
                Compose(
    ColorJitter(brightness=None, contrast=None, saturation=[0.95, 1.05], hue=[-0.05, 0.05])
    RandomHorizontalFlip(p=0.5)
    RandomRotation(degrees=(-20, 20), resample=2, expand=False)
    ToTensor()
    Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])
)],
 'weight_decay': 0.001}
Dataloader constructed!
Epoch: 0, batch loss: 0.25660 Loss Sum: 136.09672, accuracy : 0.78937, val loss: 6.41614, val accuracy: 0.87586
Final : 0.910005325167357 [('val/VGG16/monotone/f1-score', 0.9175627240143369), ('val/VGG16/screenshot/f1-score', 0.90625), ('val/VGG16/unknown/f1-score', 0.90625)]
Epoch: 1, batch loss: 0.33269 Loss Sum: 68.49046, accuracy : 0.90105, val loss: 8.12301, val accuracy: 0.84598
Final : 0.9008740578210043 [('val/VGG16/monotone/f1-score', 0.9280575539568345), ('val/VGG16/screenshot/f1-score', 0.8955223880597014), ('val/VGG16/unknown/f1-score', 0.8797127468581688)]
Epoch: 2, batch loss: 0.17594 Loss Sum: 58.07431, accuracy : 0.91687, val loss: 5.79352, val accuracy: 0.89732
Final : 0.9289085204761764 [('val/VGG16/monotone/f1-score', 0.9446494464944649), ('val/VGG16/screenshot/f1-score', 0.9184060721062619), ('val/VGG16/unknown/f1-score', 0.9238754325259516)]
Epoch: 3, batch loss: 0.38200 Loss Sum: 50.78667, accuracy : 0.92685, val loss: 6.10806, val accuracy: 0.88736
Final : 0.921114939103212 [('val/VGG16/monotone/f1-score', 0.9411764705882353), ('val/VGG16/screenshot/f1-score', 0.9077212806026365), ('val/VGG16/unknown/f1-score', 0.9147826086956521)]
---train finished---