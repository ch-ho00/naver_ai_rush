Downloading: "https://download.pytorch.org/models/resnet50-19c8e357.pth" to /home/nsml/.cache/torch/checkpoints/resnet50-19c8e357.pth
/opt/conda/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1221: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
ResNet50 Loaded!
{'batch_size': 64,
 'class_ratio': [0.3, 0.2, 0.2, 0.3],
 'epoch': [3, 1],
 'gamma': 0.1,
 'learning_rate': 0.0001,
 'loss_cls_weight': tensor([1., 1., 1., 1.]),
 'optimizer': 'Adamax',
 'step_size': 10,
 'transforms': [1,
                Compose(
    ColorJitter(brightness=None, contrast=None, saturation=[0.95, 1.05], hue=[-0.05, 0.05])
    RandomHorizontalFlip(p=0.5)
    RandomRotation(degrees=(-20, 20), resample=2, expand=False)
    ToTensor()
    Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])
)],
 'weight_decay': 0}
Dataloader constructed!
Epoch: 0, batch loss: 0.79071 Loss Sum: 266.82757, accuracy : 0.60759, val loss: 20.10896, val accuracy: 0.58084
Final : 0.7386440439053348 [('val/ResNet50/monotone/f1-score', 0.8013029315960911), ('val/ResNet50/screenshot/f1-score', 0.8063241106719369), ('val/ResNet50/unknown/f1-score', 0.6237337192474675)]
Epoch: 1, batch loss: 0.67752 Loss Sum: 176.63381, accuracy : 0.80733, val loss: 17.43493, val accuracy: 0.64291
Final : 0.7623087406907743 [('val/ResNet50/monotone/f1-score', 0.7804878048780487), ('val/ResNet50/screenshot/f1-score', 0.8266666666666668), ('val/ResNet50/unknown/f1-score', 0.6865879082696318)]
Epoch: 2, batch loss: 0.46362 Loss Sum: 144.44100, accuracy : 0.83270, val loss: 16.00410, val accuracy: 0.66590
Final : 0.7701853751553741 [('val/ResNet50/monotone/f1-score', 0.771604938271605), ('val/ResNet50/screenshot/f1-score', 0.8275862068965517), ('val/ResNet50/unknown/f1-score', 0.7154471544715447)]
Epoch: 3, batch loss: 0.21803 Loss Sum: 49.35811, accuracy : 0.93026, val loss: 16.24904, val accuracy: 0.72720
Final : 0.8579467059712251 [('val/ResNet50/monotone/f1-score', 0.8927335640138409), ('val/ResNet50/screenshot/f1-score', 0.9245283018867925), ('val/ResNet50/unknown/f1-score', 0.7651363938789089)]
---train finished---
Trying to save to /tmp/tmp48mrndhr/model
Too long checkpoint name: ResNet50_64_[0.3, 0.2, 0.2, 0.3]_[3, 1]_1.0_0.01_[1.0, 1.0, 1.0, 1.0]_Adamax_10_1_0 not saved
Done
ResNet50 Loaded!
{'batch_size': 64,
 'class_ratio': [0.3, 0.2, 0.2, 0.3],
 'epoch': [3, 1],
 'gamma': 0.1,
 'learning_rate': 0.0001,
 'loss_cls_weight': tensor([1., 1., 1., 1.]),
 'optimizer': 'Adamax',
 'step_size': 10,
 'transforms': [1,
                Compose(
    ColorJitter(brightness=None, contrast=None, saturation=[0.95, 1.05], hue=[-0.05, 0.05])
    RandomHorizontalFlip(p=0.5)
    RandomRotation(degrees=(-20, 20), resample=2, expand=False)
    ToTensor()
    Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])
)],
 'weight_decay': 0.001}
Dataloader constructed!
Epoch: 0, batch loss: 0.75582 Loss Sum: 262.20180, accuracy : 0.63352, val loss: 19.75324, val accuracy: 0.61839
Final : 0.7383215055665701 [('val/ResNet50/monotone/f1-score', 0.75), ('val/ResNet50/screenshot/f1-score', 0.8111332007952287), ('val/ResNet50/unknown/f1-score', 0.6615811373092927)]
Epoch: 1, batch loss: 0.64449 Loss Sum: 174.49545, accuracy : 0.81846, val loss: 17.45098, val accuracy: 0.63602
Final : 0.7576853540420292 [('val/ResNet50/monotone/f1-score', 0.7826086956521738), ('val/ResNet50/screenshot/f1-score', 0.8089430894308942), ('val/ResNet50/unknown/f1-score', 0.6870748299319728)]
Epoch: 2, batch loss: 0.51353 Loss Sum: 142.29750, accuracy : 0.83709, val loss: 17.55791, val accuracy: 0.60230
Final : 0.7462578723101443 [('val/ResNet50/monotone/f1-score', 0.7753846153846154), ('val/ResNet50/screenshot/f1-score', 0.8458646616541353), ('val/ResNet50/unknown/f1-score', 0.6336489439184267)]
Epoch: 3, batch loss: 0.20566 Loss Sum: 51.02932, accuracy : 0.92843, val loss: 14.86725, val accuracy: 0.74330
Final : 0.8781334138643505 [('val/ResNet50/monotone/f1-score', 0.9163636363636364), ('val/ResNet50/screenshot/f1-score', 0.9447619047619048), ('val/ResNet50/unknown/f1-score', 0.7821522309711287)]
---train finished---
Trying to save to /tmp/tmprc1uwx3j/model
Too long checkpoint name: ResNet50_64_[0.3, 0.2, 0.2, 0.3]_[3, 1]_1.0_0.01_[1.0, 1.0, 1.0, 1.0]_Adamax_10_1_100.0 not saved
Done
ResNet50 Loaded!
{'batch_size': 64,
 'class_ratio': [0.3, 0.2, 0.2, 0.3],
 'epoch': [3, 1],
 'gamma': 0.1,
 'learning_rate': 0.0001,
 'loss_cls_weight': tensor([1., 1., 1., 1.]),
 'optimizer': 'Adamax',
 'step_size': 10,
 'transforms': [2,
                Compose(
    RandomAffine(degrees=(0, 0), scale=(0.75, 1.25))
    RandomPerspective(p=0.4)
    RandomHorizontalFlip(p=0.5)
    ToTensor()
    Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])
)],
 'weight_decay': 0}
Dataloader constructed!
Epoch: 0, batch loss: 0.84510 Loss Sum: 268.87386, accuracy : 0.60839, val loss: 19.65779, val accuracy: 0.64521
Final : 0.7806572386102413 [('val/ResNet50/monotone/f1-score', 0.8581560283687943), ('val/ResNet50/screenshot/f1-score', 0.7851239669421487), ('val/ResNet50/unknown/f1-score', 0.7061170212765959)]
Epoch: 1, batch loss: 0.56700 Loss Sum: 185.04285, accuracy : 0.80617, val loss: 18.15629, val accuracy: 0.62375
Final : 0.7562172072697874 [('val/ResNet50/monotone/f1-score', 0.8152866242038217), ('val/ResNet50/screenshot/f1-score', 0.7864271457085829), ('val/ResNet50/unknown/f1-score', 0.6744827586206897)]
Epoch: 2, batch loss: 0.68716 Loss Sum: 152.69236, accuracy : 0.82948, val loss: 17.73787, val accuracy: 0.61456
Final : 0.7655994138070555 [('val/ResNet50/monotone/f1-score', 0.8167202572347266), ('val/ResNet50/screenshot/f1-score', 0.8402366863905325), ('val/ResNet50/unknown/f1-score', 0.6539278131634819)]
Epoch: 3, batch loss: 0.31126 Loss Sum: 57.97221, accuracy : 0.91796, val loss: 17.24531, val accuracy: 0.72950
Final : 0.8595150277074338 [('val/ResNet50/monotone/f1-score', 0.889655172413793), ('val/ResNet50/screenshot/f1-score', 0.9325842696629213), ('val/ResNet50/unknown/f1-score', 0.7653333333333333)]
---train finished---
Trying to save to /tmp/tmp1d191fh8/model
Too long checkpoint name: ResNet50_64_[0.3, 0.2, 0.2, 0.3]_[3, 1]_1.0_0.01_[1.0, 1.0, 1.0, 1.0]_Adamax_10_2_0 not saved
Done
ResNet50 Loaded!
{'batch_size': 64,
 'class_ratio': [0.3, 0.2, 0.2, 0.3],
 'epoch': [3, 1],
 'gamma': 0.1,
 'learning_rate': 0.0001,
 'loss_cls_weight': tensor([1., 1., 1., 1.]),
 'optimizer': 'Adamax',
 'step_size': 10,
 'transforms': [2,
                Compose(
    RandomAffine(degrees=(0, 0), scale=(0.75, 1.25))
    RandomPerspective(p=0.4)
    RandomHorizontalFlip(p=0.5)
    ToTensor()
    Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])
)],
 'weight_decay': 0.001}
Dataloader constructed!
Epoch: 0, batch loss: 0.86488 Loss Sum: 270.15546, accuracy : 0.62135, val loss: 19.77991, val accuracy: 0.63218
Final : 0.7753612297364728 [('val/ResNet50/monotone/f1-score', 0.8833922261484098), ('val/ResNet50/screenshot/f1-score', 0.7543103448275863), ('val/ResNet50/unknown/f1-score', 0.6995336442371752)]
Epoch: 1, batch loss: 0.64005 Loss Sum: 182.46407, accuracy : 0.81980, val loss: 18.91113, val accuracy: 0.58851
Final : 0.7436120481777989 [('val/ResNet50/monotone/f1-score', 0.8126984126984128), ('val/ResNet50/screenshot/f1-score', 0.81203007518797), ('val/ResNet50/unknown/f1-score', 0.6230712711241735)]
Epoch: 2, batch loss: 0.50136 Loss Sum: 148.99564, accuracy : 0.83587, val loss: 17.26576, val accuracy: 0.63295
Final : 0.7664582005264736 [('val/ResNet50/monotone/f1-score', 0.8126984126984128), ('val/ResNet50/screenshot/f1-score', 0.8140900195694716), ('val/ResNet50/unknown/f1-score', 0.6805555555555555)]
Epoch: 3, batch loss: 0.10836 Loss Sum: 55.26957, accuracy : 0.92180, val loss: 16.98867, val accuracy: 0.73410
Final : 0.866034801748589 [('val/ResNet50/monotone/f1-score', 0.9084507042253521), ('val/ResNet50/screenshot/f1-score', 0.9265536723163842), ('val/ResNet50/unknown/f1-score', 0.771674387822634)]
---train finished---
Trying to save to /tmp/tmpxi1qjf31/model
Too long checkpoint name: ResNet50_64_[0.3, 0.2, 0.2, 0.3]_[3, 1]_1.0_0.01_[1.0, 1.0, 1.0, 1.0]_Adamax_10_2_100.0 not saved
Done
ResNet50 Loaded!
{'batch_size': 64,
 'class_ratio': [0.3, 0.2, 0.2, 0.3],
 'epoch': [3, 1],
 'gamma': 0.1,
 'learning_rate': 0.0001,
 'loss_cls_weight': tensor([1., 1., 1., 1.]),
 'optimizer': 'Adamax',
 'step_size': 2,
 'transforms': [1,
                Compose(
    ColorJitter(brightness=None, contrast=None, saturation=[0.95, 1.05], hue=[-0.05, 0.05])
    RandomHorizontalFlip(p=0.5)
    RandomRotation(degrees=(-20, 20), resample=2, expand=False)
    ToTensor()
    Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])
)],
 'weight_decay': 0}
Dataloader constructed!
Epoch: 0, batch loss: 0.80081 Loss Sum: 252.34173, accuracy : 0.67271, val loss: 21.41628, val accuracy: 0.48582
Final : 0.6677465562809856 [('val/ResNet50/monotone/f1-score', 0.7735849056603774), ('val/ResNet50/screenshot/f1-score', 0.8160291438979964), ('val/ResNet50/unknown/f1-score', 0.4716516023007395)]
Epoch: 1, batch loss: 0.62260 Loss Sum: 169.95009, accuracy : 0.82248, val loss: 18.37912, val accuracy: 0.59464
Final : 0.7386064576823773 [('val/ResNet50/monotone/f1-score', 0.7720364741641338), ('val/ResNet50/screenshot/f1-score', 0.8330134357005757), ('val/ResNet50/unknown/f1-score', 0.6265409717186367)]
Epoch: 2, batch loss: 0.60650 Loss Sum: 149.12779, accuracy : 0.83776, val loss: 17.65654, val accuracy: 0.61609
Final : 0.7542458265432224 [('val/ResNet50/monotone/f1-score', 0.7925696594427245), ('val/ResNet50/screenshot/f1-score', 0.8249027237354085), ('val/ResNet50/unknown/f1-score', 0.6562942008486563)]
Epoch: 3, batch loss: 0.21341 Loss Sum: 87.20053, accuracy : 0.89673, val loss: 14.93250, val accuracy: 0.71111
Final : 0.8368548390542153 [('val/ResNet50/monotone/f1-score', 0.8657718120805369), ('val/ResNet50/screenshot/f1-score', 0.9029850746268657), ('val/ResNet50/unknown/f1-score', 0.7496635262449528)]
---train finished---
Trying to save to /tmp/tmp3mqk0ugr/model
Too long checkpoint name: ResNet50_64_[0.3, 0.2, 0.2, 0.3]_[3, 1]_1.0_0.01_[1.0, 1.0, 1.0, 1.0]_Adamax_2_1_0 not saved
Done
ResNet50 Loaded!
{'batch_size': 64,
 'class_ratio': [0.3, 0.2, 0.2, 0.3],
 'epoch': [3, 1],
 'gamma': 0.1,
 'learning_rate': 0.0001,
 'loss_cls_weight': tensor([1., 1., 1., 1.]),
 'optimizer': 'Adamax',
 'step_size': 2,
 'transforms': [1,
                Compose(
    ColorJitter(brightness=None, contrast=None, saturation=[0.95, 1.05], hue=[-0.05, 0.05])
    RandomHorizontalFlip(p=0.5)
    RandomRotation(degrees=(-20, 20), resample=2, expand=False)
    ToTensor()
    Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])
)],
 'weight_decay': 0.001}
Dataloader constructed!
Epoch: 0, batch loss: 0.80763 Loss Sum: 267.78076, accuracy : 0.59755, val loss: 19.90079, val accuracy: 0.57395
Final : 0.7102905628172345 [('val/ResNet50/monotone/f1-score', 0.7619047619047619), ('val/ResNet50/screenshot/f1-score', 0.7803030303030303), ('val/ResNet50/unknown/f1-score', 0.6027596223674655)]
Epoch: 1, batch loss: 0.71174 Loss Sum: 177.59995, accuracy : 0.80812, val loss: 17.16828, val accuracy: 0.65670
Final : 0.7759525351599521 [('val/ResNet50/monotone/f1-score', 0.7987012987012988), ('val/ResNet50/screenshot/f1-score', 0.8345864661654135), ('val/ResNet50/unknown/f1-score', 0.700889801505818)]
Epoch: 2, batch loss: 0.56419 Loss Sum: 154.73253, accuracy : 0.83246, val loss: 17.02256, val accuracy: 0.63755
Final : 0.767307936282581 [('val/ResNet50/monotone/f1-score', 0.7950310559006211), ('val/ResNet50/screenshot/f1-score', 0.8372093023255814), ('val/ResNet50/unknown/f1-score', 0.678720445062587)]
Epoch: 3, batch loss: 0.22975 Loss Sum: 90.39699, accuracy : 0.88760, val loss: 15.25652, val accuracy: 0.69425
Final : 0.8263991552933319 [('val/ResNet50/monotone/f1-score', 0.8514851485148515), ('val/ResNet50/screenshot/f1-score', 0.9067164179104479), ('val/ResNet50/unknown/f1-score', 0.7310061601642711)]
---train finished---
Trying to save to /tmp/tmpa4uz506p/model
Too long checkpoint name: ResNet50_64_[0.3, 0.2, 0.2, 0.3]_[3, 1]_1.0_0.01_[1.0, 1.0, 1.0, 1.0]_Adamax_2_1_100.0 not saved
Done
ResNet50 Loaded!
{'batch_size': 64,
 'class_ratio': [0.3, 0.2, 0.2, 0.3],
 'epoch': [3, 1],
 'gamma': 0.1,
 'learning_rate': 0.0001,
 'loss_cls_weight': tensor([1., 1., 1., 1.]),
 'optimizer': 'Adamax',
 'step_size': 2,
 'transforms': [2,
                Compose(
    RandomAffine(degrees=(0, 0), scale=(0.75, 1.25))
    RandomPerspective(p=0.4)
    RandomHorizontalFlip(p=0.5)
    ToTensor()
    Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])
)],
 'weight_decay': 0}
Dataloader constructed!
Epoch: 0, batch loss: 0.77873 Loss Sum: 263.42143, accuracy : 0.60364, val loss: 20.31647, val accuracy: 0.56628
Final : 0.7482054184532166 [('val/ResNet50/monotone/f1-score', 0.8531468531468531), ('val/ResNet50/screenshot/f1-score', 0.8080000000000002), ('val/ResNet50/unknown/f1-score', 0.6076134699853587)]
Epoch: 1, batch loss: 0.65578 Loss Sum: 183.42807, accuracy : 0.80404, val loss: 16.95965, val accuracy: 0.68812
Final : 0.7970399484048662 [('val/ResNet50/monotone/f1-score', 0.8205128205128205), ('val/ResNet50/screenshot/f1-score', 0.83203125), ('val/ResNet50/unknown/f1-score', 0.7416777629826898)]
Epoch: 2, batch loss: 0.59507 Loss Sum: 160.99512, accuracy : 0.82084, val loss: 17.78037, val accuracy: 0.63678
Final : 0.7705271372305312 [('val/ResNet50/monotone/f1-score', 0.8102893890675241), ('val/ResNet50/screenshot/f1-score', 0.8288973384030419), ('val/ResNet50/unknown/f1-score', 0.6811188811188812)]
Epoch: 3, batch loss: 0.19112 Loss Sum: 95.78799, accuracy : 0.88328, val loss: 16.17439, val accuracy: 0.67280
Final : 0.8147723269449924 [('val/ResNet50/monotone/f1-score', 0.8619528619528619), ('val/ResNet50/screenshot/f1-score', 0.8838951310861424), ('val/ResNet50/unknown/f1-score', 0.7099447513812156)]
---train finished---
Trying to save to /tmp/tmpvkeksv_6/model
Too long checkpoint name: ResNet50_64_[0.3, 0.2, 0.2, 0.3]_[3, 1]_1.0_0.01_[1.0, 1.0, 1.0, 1.0]_Adamax_2_2_0 not saved
Done
ResNet50 Loaded!
{'batch_size': 64,
 'class_ratio': [0.3, 0.2, 0.2, 0.3],
 'epoch': [3, 1],
 'gamma': 0.1,
 'learning_rate': 0.0001,
 'loss_cls_weight': tensor([1., 1., 1., 1.]),
 'optimizer': 'Adamax',
 'step_size': 2,
 'transforms': [2,
                Compose(
    RandomAffine(degrees=(0, 0), scale=(0.75, 1.25))
    RandomPerspective(p=0.4)
    RandomHorizontalFlip(p=0.5)
    ToTensor()
    Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])
)],
 'weight_decay': 0.001}
Dataloader constructed!
Epoch: 0, batch loss: 0.86137 Loss Sum: 259.27380, accuracy : 0.64143, val loss: 20.12917, val accuracy: 0.60153
Final : 0.7516478797458144 [('val/ResNet50/monotone/f1-score', 0.8300653594771242), ('val/ResNet50/screenshot/f1-score', 0.7946257197696737), ('val/ResNet50/unknown/f1-score', 0.6438258386866523)]
Epoch: 1, batch loss: 0.62540 Loss Sum: 179.70575, accuracy : 0.80702, val loss: 18.66110, val accuracy: 0.59310
Final : 0.7470951577143659 [('val/ResNet50/monotone/f1-score', 0.8037974683544304), ('val/ResNet50/screenshot/f1-score', 0.8223938223938224), ('val/ResNet50/unknown/f1-score', 0.6308139534883721)]
Epoch: 2, batch loss: 0.63294 Loss Sum: 157.79168, accuracy : 0.82406, val loss: 17.77711, val accuracy: 0.61303
Final : 0.7605649919109321 [('val/ResNet50/monotone/f1-score', 0.821656050955414), ('val/ResNet50/screenshot/f1-score', 0.8158415841584158), ('val/ResNet50/unknown/f1-score', 0.6563161609033168)]
Epoch: 3, batch loss: 0.30392 Loss Sum: 96.47890, accuracy : 0.88090, val loss: 15.42029, val accuracy: 0.69962
Final : 0.8295931843945539 [('val/ResNet50/monotone/f1-score', 0.8657718120805369), ('val/ResNet50/screenshot/f1-score', 0.8974358974358974), ('val/ResNet50/unknown/f1-score', 0.7348329925017042)]
---train finished---
Trying to save to /tmp/tmpv7h3ndzz/model
Too long checkpoint name: ResNet50_64_[0.3, 0.2, 0.2, 0.3]_[3, 1]_1.0_0.01_[1.0, 1.0, 1.0, 1.0]_Adamax_2_2_100.0 not saved
Done
ResNet50 Loaded!
{'batch_size': 64,
 'class_ratio': [0.3, 0.2, 0.2, 0.3],
 'epoch': [3, 1],
 'gamma': 0.1,
 'learning_rate': 0.0001,
 'loss_cls_weight': tensor([1., 1., 1., 1.]),
 'optimizer': 'Adam',
 'step_size': 10,
 'transforms': [1,
                Compose(
    ColorJitter(brightness=None, contrast=None, saturation=[0.95, 1.05], hue=[-0.05, 0.05])
    RandomHorizontalFlip(p=0.5)
    RandomRotation(degrees=(-20, 20), resample=2, expand=False)
    ToTensor()
    Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])
)],
 'weight_decay': 0}
Dataloader constructed!
Epoch: 0, batch loss: 0.53713 Loss Sum: 214.33803, accuracy : 0.72596, val loss: 17.75114, val accuracy: 0.60536
Final : 0.757615797444637 [('val/ResNet50/monotone/f1-score', 0.8155339805825242), ('val/ResNet50/screenshot/f1-score', 0.8287937743190661), ('val/ResNet50/unknown/f1-score', 0.6433666191155493)]
Epoch: 1, batch loss: 0.38122 Loss Sum: 130.18086, accuracy : 0.84634, val loss: 16.11452, val accuracy: 0.65977
Final : 0.7820940704391786 [('val/ResNet50/monotone/f1-score', 0.8063492063492063), ('val/ResNet50/screenshot/f1-score', 0.8487084870848708), ('val/ResNet50/unknown/f1-score', 0.6990291262135921)]
Epoch: 2, batch loss: 0.38530 Loss Sum: 109.74365, accuracy : 0.85820, val loss: 15.06749, val accuracy: 0.68812
Final : 0.7976145793569633 [('val/ResNet50/monotone/f1-score', 0.8178913738019169), ('val/ResNet50/screenshot/f1-score', 0.8457142857142858), ('val/ResNet50/unknown/f1-score', 0.7336010709504684)]
Epoch: 3, batch loss: 0.07490 Loss Sum: 50.29916, accuracy : 0.92837, val loss: 16.67410, val accuracy: 0.77011
Final : 0.8899400211407251 [('val/ResNet50/monotone/f1-score', 0.924731182795699), ('val/ResNet50/screenshot/f1-score', 0.9427480916030535), ('val/ResNet50/unknown/f1-score', 0.8084832904884319)]
---train finished---
Trying to save to /tmp/tmpl95wb4at/model
Too long checkpoint name: ResNet50_64_[0.3, 0.2, 0.2, 0.3]_[3, 1]_1.0_0.01_[1.0, 1.0, 1.0, 1.0]_Adam_10_1_0 not saved
Done
ResNet50 Loaded!
{'batch_size': 64,
 'class_ratio': [0.3, 0.2, 0.2, 0.3],
 'epoch': [3, 1],
 'gamma': 0.1,
 'learning_rate': 0.0001,
 'loss_cls_weight': tensor([1., 1., 1., 1.]),
 'optimizer': 'Adam',
 'step_size': 10,
 'transforms': [1,
                Compose(
    ColorJitter(brightness=None, contrast=None, saturation=[0.95, 1.05], hue=[-0.05, 0.05])
    RandomHorizontalFlip(p=0.5)
    RandomRotation(degrees=(-20, 20), resample=2, expand=False)
    ToTensor()
    Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])
)],
 'weight_decay': 0.001}
Dataloader constructed!
Epoch: 0, batch loss: 0.50139 Loss Sum: 208.63845, accuracy : 0.74093, val loss: 17.91416, val accuracy: 0.57701
Final : 0.725102868867595 [('val/ResNet50/monotone/f1-score', 0.7823343848580442), ('val/ResNet50/screenshot/f1-score', 0.7766179540709811), ('val/ResNet50/unknown/f1-score', 0.6274787535410765)]
Epoch: 1, batch loss: 0.44195 Loss Sum: 127.74796, accuracy : 0.84542, val loss: 15.11141, val accuracy: 0.67739
Final : 0.7935037965890749 [('val/ResNet50/monotone/f1-score', 0.8181818181818181), ('val/ResNet50/screenshot/f1-score', 0.834710743801653), ('val/ResNet50/unknown/f1-score', 0.731578947368421)]
Epoch: 2, batch loss: 0.50084 Loss Sum: 107.73175, accuracy : 0.86283, val loss: 15.07782, val accuracy: 0.68276
Final : 0.7899116076027806 [('val/ResNet50/monotone/f1-score', 0.8126984126984128), ('val/ResNet50/screenshot/f1-score', 0.823293172690763), ('val/ResNet50/unknown/f1-score', 0.7366336633663367)]
Epoch: 3, batch loss: 0.26669 Loss Sum: 50.89748, accuracy : 0.92983, val loss: 14.96768, val accuracy: 0.75632
Final : 0.8756257377604492 [('val/ResNet50/monotone/f1-score', 0.9045936395759718), ('val/ResNet50/screenshot/f1-score', 0.9340866290018832), ('val/ResNet50/unknown/f1-score', 0.7945383615084525)]
---train finished---
Trying to save to /tmp/tmpu0o_cxeg/model
Too long checkpoint name: ResNet50_64_[0.3, 0.2, 0.2, 0.3]_[3, 1]_1.0_0.01_[1.0, 1.0, 1.0, 1.0]_Adam_10_1_100.0 not saved
Done
ResNet50 Loaded!
{'batch_size': 64,
 'class_ratio': [0.3, 0.2, 0.2, 0.3],
 'epoch': [3, 1],
 'gamma': 0.1,
 'learning_rate': 0.0001,
 'loss_cls_weight': tensor([1., 1., 1., 1.]),
 'optimizer': 'Adam',
 'step_size': 10,
 'transforms': [2,
                Compose(
    RandomAffine(degrees=(0, 0), scale=(0.75, 1.25))
    RandomPerspective(p=0.4)
    RandomHorizontalFlip(p=0.5)
    ToTensor()
    Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])
)],
 'weight_decay': 0}
Dataloader constructed!
Epoch: 0, batch loss: 0.54449 Loss Sum: 221.36162, accuracy : 0.71294, val loss: 17.37997, val accuracy: 0.65134
Final : 0.7749756308262695 [('val/ResNet50/monotone/f1-score', 0.8126984126984128), ('val/ResNet50/screenshot/f1-score', 0.8208092485549134), ('val/ResNet50/unknown/f1-score', 0.6977381768334475)]
Epoch: 1, batch loss: 0.29563 Loss Sum: 135.55508, accuracy : 0.83958, val loss: 15.97706, val accuracy: 0.67969
Final : 0.7881629763866669 [('val/ResNet50/monotone/f1-score', 0.8102893890675241), ('val/ResNet50/screenshot/f1-score', 0.8308270676691729), ('val/ResNet50/unknown/f1-score', 0.7272727272727273)]
Epoch: 2, batch loss: 0.58428 Loss Sum: 113.58062, accuracy : 0.85796, val loss: 16.81245, val accuracy: 0.63985
Final : 0.7831022284354827 [('val/ResNet50/monotone/f1-score', 0.8476821192052979), ('val/ResNet50/screenshot/f1-score', 0.8390596745027125), ('val/ResNet50/unknown/f1-score', 0.6751954513148544)]
Epoch: 3, batch loss: 0.08087 Loss Sum: 58.73143, accuracy : 0.91602, val loss: 15.03744, val accuracy: 0.76169
Final : 0.882497226554343 [('val/ResNet50/monotone/f1-score', 0.924187725631769), ('val/ResNet50/screenshot/f1-score', 0.9272030651340997), ('val/ResNet50/unknown/f1-score', 0.8020565552699229)]
---train finished---
Trying to save to /tmp/tmpwpddyjor/model
Too long checkpoint name: ResNet50_64_[0.3, 0.2, 0.2, 0.3]_[3, 1]_1.0_0.01_[1.0, 1.0, 1.0, 1.0]_Adam_10_2_0 not saved
Done
ResNet50 Loaded!
{'batch_size': 64,
 'class_ratio': [0.3, 0.2, 0.2, 0.3],
 'epoch': [3, 1],
 'gamma': 0.1,
 'learning_rate': 0.0001,
 'loss_cls_weight': tensor([1., 1., 1., 1.]),
 'optimizer': 'Adam',
 'step_size': 10,
 'transforms': [2,
                Compose(
    RandomAffine(degrees=(0, 0), scale=(0.75, 1.25))
    RandomPerspective(p=0.4)
    RandomHorizontalFlip(p=0.5)
    ToTensor()
    Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])
)],
 'weight_decay': 0.001}
Dataloader constructed!
Epoch: 0, batch loss: 0.61152 Loss Sum: 233.93956, accuracy : 0.67630, val loss: 18.08109, val accuracy: 0.63755
Final : 0.7676739146134478 [('val/ResNet50/monotone/f1-score', 0.7938461538461539), ('val/ResNet50/screenshot/f1-score', 0.8378378378378379), ('val/ResNet50/unknown/f1-score', 0.6801959412176347)]
Epoch: 1, batch loss: 0.55388 Loss Sum: 141.00128, accuracy : 0.83922, val loss: 16.01387, val accuracy: 0.67126
Final : 0.7968696479115299 [('val/ResNet50/monotone/f1-score', 0.8421052631578948), ('val/ResNet50/screenshot/f1-score', 0.8299595141700404), ('val/ResNet50/unknown/f1-score', 0.724)]
Epoch: 2, batch loss: 0.51941 Loss Sum: 118.75974, accuracy : 0.84774, val loss: 16.61773, val accuracy: 0.64368
Final : 0.7916772298230128 [('val/ResNet50/monotone/f1-score', 0.8514851485148515), ('val/ResNet50/screenshot/f1-score', 0.861878453038674), ('val/ResNet50/unknown/f1-score', 0.6761162296243798)]
Epoch: 3, batch loss: 0.14635 Loss Sum: 61.50542, accuracy : 0.91474, val loss: 18.76740, val accuracy: 0.70192
Final : 0.8596667009857127 [('val/ResNet50/monotone/f1-score', 0.9343065693430657), ('val/ResNet50/screenshot/f1-score', 0.9165048543689319), ('val/ResNet50/unknown/f1-score', 0.7419354838709676)]
---train finished---
Trying to save to /tmp/tmpewvsw0iz/model
Too long checkpoint name: ResNet50_64_[0.3, 0.2, 0.2, 0.3]_[3, 1]_1.0_0.01_[1.0, 1.0, 1.0, 1.0]_Adam_10_2_100.0 not saved
Done
ResNet50 Loaded!
{'batch_size': 64,
 'class_ratio': [0.3, 0.2, 0.2, 0.3],
 'epoch': [3, 1],
 'gamma': 0.1,
 'learning_rate': 0.0001,
 'loss_cls_weight': tensor([1., 1., 1., 1.]),
 'optimizer': 'Adam',
 'step_size': 2,
 'transforms': [1,
                Compose(
    ColorJitter(brightness=None, contrast=None, saturation=[0.95, 1.05], hue=[-0.05, 0.05])
    RandomHorizontalFlip(p=0.5)
    RandomRotation(degrees=(-20, 20), resample=2, expand=False)
    ToTensor()
    Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])
)],
 'weight_decay': 0}
Dataloader constructed!
Epoch: 0, batch loss: 0.57598 Loss Sum: 219.74838, accuracy : 0.70302, val loss: 15.69928, val accuracy: 0.70268
Final : 0.7891815228832008 [('val/ResNet50/monotone/f1-score', 0.8076923076923077), ('val/ResNet50/screenshot/f1-score', 0.7974413646055437), ('val/ResNet50/unknown/f1-score', 0.7631080227416298)]
Epoch: 1, batch loss: 0.44066 Loss Sum: 131.44960, accuracy : 0.84506, val loss: 15.65971, val accuracy: 0.69272
Final : 0.7984070028596301 [('val/ResNet50/monotone/f1-score', 0.8231511254019293), ('val/ResNet50/screenshot/f1-score', 0.8422939068100358), ('val/ResNet50/unknown/f1-score', 0.7340569877883312)]
Epoch: 2, batch loss: 0.52204 Loss Sum: 115.95022, accuracy : 0.85893, val loss: 15.46223, val accuracy: 0.67203
Final : 0.7865319803966977 [('val/ResNet50/monotone/f1-score', 0.8012618296529967), ('val/ResNet50/screenshot/f1-score', 0.8461538461538461), ('val/ResNet50/unknown/f1-score', 0.7176709546377793)]
Epoch: 3, batch loss: 0.13664 Loss Sum: 63.49250, accuracy : 0.91675, val loss: 14.76973, val accuracy: 0.73870
Final : 0.8593852819222273 [('val/ResNet50/monotone/f1-score', 0.8775510204081634), ('val/ResNet50/screenshot/f1-score', 0.931297709923664), ('val/ResNet50/unknown/f1-score', 0.7766097240473062)]
---train finished---
Trying to save to /tmp/tmpaxoylwho/model
Too long checkpoint name: ResNet50_64_[0.3, 0.2, 0.2, 0.3]_[3, 1]_1.0_0.01_[1.0, 1.0, 1.0, 1.0]_Adam_2_1_0 not saved
Done
ResNet50 Loaded!
{'batch_size': 64,
 'class_ratio': [0.3, 0.2, 0.2, 0.3],
 'epoch': [3, 1],
 'gamma': 0.1,
 'learning_rate': 0.0001,
 'loss_cls_weight': tensor([1., 1., 1., 1.]),
 'optimizer': 'Adam',
 'step_size': 2,
 'transforms': [1,
                Compose(
    ColorJitter(brightness=None, contrast=None, saturation=[0.95, 1.05], hue=[-0.05, 0.05])
    RandomHorizontalFlip(p=0.5)
    RandomRotation(degrees=(-20, 20), resample=2, expand=False)
    ToTensor()
    Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])
)],
 'weight_decay': 0.001}
Dataloader constructed!
Epoch: 0, batch loss: 0.53586 Loss Sum: 206.82022, accuracy : 0.73546, val loss: 16.59014, val accuracy: 0.65517
Final : 0.7719651993785009 [('val/ResNet50/monotone/f1-score', 0.8025889967637541), ('val/ResNet50/screenshot/f1-score', 0.8087649402390438), ('val/ResNet50/unknown/f1-score', 0.7087248322147651)]
Epoch: 1, batch loss: 0.37209 Loss Sum: 127.19612, accuracy : 0.84293, val loss: 15.50228, val accuracy: 0.67893
Final : 0.7898721075564729 [('val/ResNet50/monotone/f1-score', 0.7912772585669782), ('val/ResNet50/screenshot/f1-score', 0.8588007736943907), ('val/ResNet50/unknown/f1-score', 0.7251856853477381)]
Epoch: 2, batch loss: 0.36918 Loss Sum: 111.99724, accuracy : 0.86179, val loss: 15.57663, val accuracy: 0.66590
Final : 0.782761558619411 [('val/ResNet50/monotone/f1-score', 0.7937499999999998), ('val/ResNet50/screenshot/f1-score', 0.8505747126436781), ('val/ResNet50/unknown/f1-score', 0.7103825136612021)]
Epoch: 3, batch loss: 0.30457 Loss Sum: 61.29873, accuracy : 0.91669, val loss: 15.85199, val accuracy: 0.71111
Final : 0.8429752429774713 [('val/ResNet50/monotone/f1-score', 0.8805460750853242), ('val/ResNet50/screenshot/f1-score', 0.9080675422138836), ('val/ResNet50/unknown/f1-score', 0.7491593813046402)]
---train finished---
Trying to save to /tmp/tmpovwfn0j9/model
Too long checkpoint name: ResNet50_64_[0.3, 0.2, 0.2, 0.3]_[3, 1]_1.0_0.01_[1.0, 1.0, 1.0, 1.0]_Adam_2_1_100.0 not saved
Done
ResNet50 Loaded!
{'batch_size': 64,
 'class_ratio': [0.3, 0.2, 0.2, 0.3],
 'epoch': [3, 1],
 'gamma': 0.1,
 'learning_rate': 0.0001,
 'loss_cls_weight': tensor([1., 1., 1., 1.]),
 'optimizer': 'Adam',
 'step_size': 2,
 'transforms': [2,
                Compose(
    RandomAffine(degrees=(0, 0), scale=(0.75, 1.25))
    RandomPerspective(p=0.4)
    RandomHorizontalFlip(p=0.5)
    ToTensor()
    Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])
)],
 'weight_decay': 0}
Dataloader constructed!
Epoch: 0, batch loss: 0.55571 Loss Sum: 221.87053, accuracy : 0.70326, val loss: 18.70903, val accuracy: 0.59310
Final : 0.7273022664781815 [('val/ResNet50/monotone/f1-score', 0.7463556851311952), ('val/ResNet50/screenshot/f1-score', 0.8339483394833949), ('val/ResNet50/unknown/f1-score', 0.6181015452538632)]
Epoch: 1, batch loss: 0.41600 Loss Sum: 135.75775, accuracy : 0.83922, val loss: 17.05298, val accuracy: 0.62682
Final : 0.7753782300786416 [('val/ResNet50/monotone/f1-score', 0.8311688311688311), ('val/ResNet50/screenshot/f1-score', 0.852994555353902), ('val/ResNet50/unknown/f1-score', 0.6575144508670521)]
Epoch: 2, batch loss: 0.46581 Loss Sum: 119.26851, accuracy : 0.85473, val loss: 16.59188, val accuracy: 0.63602
Final : 0.7751465876767674 [('val/ResNet50/monotone/f1-score', 0.8311688311688311), ('val/ResNet50/screenshot/f1-score', 0.8194174757281554), ('val/ResNet50/unknown/f1-score', 0.6838440111420613)]
Epoch: 3, batch loss: 0.30555 Loss Sum: 68.67312, accuracy : 0.90823, val loss: 16.55437, val accuracy: 0.70575
Final : 0.8392163151764157 [('val/ResNet50/monotone/f1-score', 0.8686868686868687), ('val/ResNet50/screenshot/f1-score', 0.9182156133828997), ('val/ResNet50/unknown/f1-score', 0.7409925220938136)]
---train finished---
Trying to save to /tmp/tmpu5thltqw/model
Too long checkpoint name: ResNet50_64_[0.3, 0.2, 0.2, 0.3]_[3, 1]_1.0_0.01_[1.0, 1.0, 1.0, 1.0]_Adam_2_2_0 not saved
Done
ResNet50 Loaded!
{'batch_size': 64,
 'class_ratio': [0.3, 0.2, 0.2, 0.3],
 'epoch': [3, 1],
 'gamma': 0.1,
 'learning_rate': 0.0001,
 'loss_cls_weight': tensor([1., 1., 1., 1.]),
 'optimizer': 'Adam',
 'step_size': 2,
 'transforms': [2,
                Compose(
    RandomAffine(degrees=(0, 0), scale=(0.75, 1.25))
    RandomPerspective(p=0.4)
    RandomHorizontalFlip(p=0.5)
    ToTensor()
    Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])
)],
 'weight_decay': 0.001}
Dataloader constructed!
Epoch: 0, batch loss: 0.62376 Loss Sum: 227.72356, accuracy : 0.69858, val loss: 17.53828, val accuracy: 0.65364
Final : 0.7808958366729866 [('val/ResNet50/monotone/f1-score', 0.8289473684210527), ('val/ResNet50/screenshot/f1-score', 0.8153846153846153), ('val/ResNet50/unknown/f1-score', 0.704514363885089)]
Epoch: 1, batch loss: 0.55213 Loss Sum: 137.35539, accuracy : 0.84262, val loss: 17.17718, val accuracy: 0.62529
Final : 0.7639533170595979 [('val/ResNet50/monotone/f1-score', 0.7889908256880734), ('val/ResNet50/screenshot/f1-score', 0.84765625), ('val/ResNet50/unknown/f1-score', 0.6666666666666666)]
Epoch: 2, batch loss: 0.34429 Loss Sum: 121.35059, accuracy : 0.85309, val loss: 16.01658, val accuracy: 0.67586
Final : 0.7974652253170076 [('val/ResNet50/monotone/f1-score', 0.8311688311688311), ('val/ResNet50/screenshot/f1-score', 0.8462998102466793), ('val/ResNet50/unknown/f1-score', 0.7209775967413443)]
Epoch: 3, batch loss: 0.23714 Loss Sum: 69.63531, accuracy : 0.90683, val loss: 15.23444, val accuracy: 0.72337
Final : 0.8502316588240363 [('val/ResNet50/monotone/f1-score', 0.8827586206896552), ('val/ResNet50/screenshot/f1-score', 0.9108159392789373), ('val/ResNet50/unknown/f1-score', 0.7644326476443265)]
---train finished---
Trying to save to /tmp/tmp5h_u2g88/model
Too long checkpoint name: ResNet50_64_[0.3, 0.2, 0.2, 0.3]_[3, 1]_1.0_0.01_[1.0, 1.0, 1.0, 1.0]_Adam_2_2_100.0 not saved
Done
ResNet50 Loaded!
{'batch_size': 64,
 'class_ratio': [0.3, 0.2, 0.2, 0.3],
 'epoch': [3, 1],
 'gamma': 0.1,
 'learning_rate': 0.0001,
 'loss_cls_weight': tensor([1., 1., 1., 1.]),
 'optimizer': 'SGD',
 'step_size': 10,
 'transforms': [1,
                Compose(
    ColorJitter(brightness=None, contrast=None, saturation=[0.95, 1.05], hue=[-0.05, 0.05])
    RandomHorizontalFlip(p=0.5)
    RandomRotation(degrees=(-20, 20), resample=2, expand=False)
    ToTensor()
    Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])
)],
 'weight_decay': 0}
Dataloader constructed!
Epoch: 0, batch loss: 0.87911 Loss Sum: 256.89395, accuracy : 0.65086, val loss: 19.60173, val accuracy: 0.59234
Final : 0.7520368742313458 [('val/ResNet50/monotone/f1-score', 0.8155339805825242), ('val/ResNet50/screenshot/f1-score', 0.8310679611650484), ('val/ResNet50/unknown/f1-score', 0.6275362318840579)]
Epoch: 1, batch loss: 0.59103 Loss Sum: 172.39322, accuracy : 0.81542, val loss: 17.99816, val accuracy: 0.61992
Final : 0.7617117024075215 [('val/ResNet50/monotone/f1-score', 0.7987220447284344), ('val/ResNet50/screenshot/f1-score', 0.8394584139264991), ('val/ResNet50/unknown/f1-score', 0.6591390261115032)]
Epoch: 2, batch loss: 0.50525 Loss Sum: 144.30890, accuracy : 0.83751, val loss: 17.27330, val accuracy: 0.61762
Final : 0.75695874857678 [('val/ResNet50/monotone/f1-score', 0.7861635220125787), ('val/ResNet50/screenshot/f1-score', 0.838206627680312), ('val/ResNet50/unknown/f1-score', 0.6581920903954802)]
Epoch: 3, batch loss: 0.33698 Loss Sum: 111.09007, accuracy : 0.86672, val loss: 14.43145, val accuracy: 0.70498
Final : 0.8215683668470497 [('val/ResNet50/monotone/f1-score', 0.8431372549019608), ('val/ResNet50/screenshot/f1-score', 0.88268156424581), ('val/ResNet50/unknown/f1-score', 0.7451244115669133)]
---train finished---
Trying to save to /tmp/tmp8giezb8c/model
Too long checkpoint name: ResNet50_64_[0.3, 0.2, 0.2, 0.3]_[3, 1]_1.0_0.01_[1.0, 1.0, 1.0, 1.0]_SGD_10_1_0 not saved
Done
ResNet50 Loaded!
{'batch_size': 64,
 'class_ratio': [0.3, 0.2, 0.2, 0.3],
 'epoch': [3, 1],
 'gamma': 0.1,
 'learning_rate': 0.0001,
 'loss_cls_weight': tensor([1., 1., 1., 1.]),
 'optimizer': 'SGD',
 'step_size': 10,
 'transforms': [1,
                Compose(
    ColorJitter(brightness=None, contrast=None, saturation=[0.95, 1.05], hue=[-0.05, 0.05])
    RandomHorizontalFlip(p=0.5)
    RandomRotation(degrees=(-20, 20), resample=2, expand=False)
    ToTensor()
    Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])
)],
 'weight_decay': 0.001}
Dataloader constructed!
Epoch: 0, batch loss: 1.09767 Loss Sum: 320.79409, accuracy : 0.39563, val loss: 24.65767, val accuracy: 0.46513
Final : 0.5601113969007426 [('val/ResNet50/monotone/f1-score', 0.5245901639344261), ('val/ResNet50/screenshot/f1-score', 0.5684754521963824), ('val/ResNet50/unknown/f1-score', 0.589238845144357)]
Epoch: 1, batch loss: 0.99820 Loss Sum: 274.20172, accuracy : 0.64192, val loss: 23.36896, val accuracy: 0.48429
Final : 0.6911930783546806 [('val/ResNet50/monotone/f1-score', 0.8592057761732852), ('val/ResNet50/screenshot/f1-score', 0.739606126914661), ('val/ResNet50/unknown/f1-score', 0.5196374622356495)]
Epoch: 2, batch loss: 0.82652 Loss Sum: 241.40797, accuracy : 0.75189, val loss: 21.27710, val accuracy: 0.60460
Final : 0.7606681607534749 [('val/ResNet50/monotone/f1-score', 0.8661971830985916), ('val/ResNet50/screenshot/f1-score', 0.7653276955602537), ('val/ResNet50/unknown/f1-score', 0.6639288158795346)]
Epoch: 3, batch loss: 0.78229 Loss Sum: 205.35533, accuracy : 0.79844, val loss: 19.68741, val accuracy: 0.57088
Final : 0.7431785028525173 [('val/ResNet50/monotone/f1-score', 0.8378378378378379), ('val/ResNet50/screenshot/f1-score', 0.8), ('val/ResNet50/unknown/f1-score', 0.6123919308357348)]
---train finished---
Trying to save to /tmp/tmpdcchxu7v/model
Too long checkpoint name: ResNet50_64_[0.3, 0.2, 0.2, 0.3]_[3, 1]_1.0_0.01_[1.0, 1.0, 1.0, 1.0]_SGD_10_1_100.0 not saved
Done
ResNet50 Loaded!
{'batch_size': 64,
 'class_ratio': [0.3, 0.2, 0.2, 0.3],
 'epoch': [3, 1],
 'gamma': 0.1,
 'learning_rate': 0.0001,
 'loss_cls_weight': tensor([1., 1., 1., 1.]),
 'optimizer': 'SGD',
 'step_size': 10,
 'transforms': [2,
                Compose(
    RandomAffine(degrees=(0, 0), scale=(0.75, 1.25))
    RandomPerspective(p=0.4)
    RandomHorizontalFlip(p=0.5)
    ToTensor()
    Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])
)],
 'weight_decay': 0}
Dataloader constructed!
Epoch: 0, batch loss: 0.94763 Loss Sum: 264.55811, accuracy : 0.63285, val loss: 22.01719, val accuracy: 0.46590
Final : 0.6771926766359657 [('val/ResNet50/monotone/f1-score', 0.8275862068965516), ('val/ResNet50/screenshot/f1-score', 0.7991967871485944), ('val/ResNet50/unknown/f1-score', 0.46953696181965876)]
Epoch: 1, batch loss: 0.65784 Loss Sum: 181.61702, accuracy : 0.81110, val loss: 18.48249, val accuracy: 0.60920
Final : 0.7648509056168246 [('val/ResNet50/monotone/f1-score', 0.8466666666666667), ('val/ResNet50/screenshot/f1-score', 0.8146718146718146), ('val/ResNet50/unknown/f1-score', 0.6486870120652946)]
Epoch: 2, batch loss: 0.45128 Loss Sum: 151.96317, accuracy : 0.83216, val loss: 17.49470, val accuracy: 0.61379
Final : 0.7705622399787307 [('val/ResNet50/monotone/f1-score', 0.8273615635179153), ('val/ResNet50/screenshot/f1-score', 0.84765625), ('val/ResNet50/unknown/f1-score', 0.6523911491791577)]
Epoch: 3, batch loss: 0.35522 Loss Sum: 115.51820, accuracy : 0.86417, val loss: 14.68697, val accuracy: 0.70651
Final : 0.8206159098163516 [('val/ResNet50/monotone/f1-score', 0.8514851485148515), ('val/ResNet50/screenshot/f1-score', 0.8662900188323917), ('val/ResNet50/unknown/f1-score', 0.7491683300066533)]
---train finished---
Trying to save to /tmp/tmphvxmao_s/model
Too long checkpoint name: ResNet50_64_[0.3, 0.2, 0.2, 0.3]_[3, 1]_1.0_0.01_[1.0, 1.0, 1.0, 1.0]_SGD_10_2_0 not saved
Done
ResNet50 Loaded!
{'batch_size': 64,
 'class_ratio': [0.3, 0.2, 0.2, 0.3],
 'epoch': [3, 1],
 'gamma': 0.1,
 'learning_rate': 0.0001,
 'loss_cls_weight': tensor([1., 1., 1., 1.]),
 'optimizer': 'SGD',
 'step_size': 10,
 'transforms': [2,
                Compose(
    RandomAffine(degrees=(0, 0), scale=(0.75, 1.25))
    RandomPerspective(p=0.4)
    RandomHorizontalFlip(p=0.5)
    ToTensor()
    Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])
)],
 'weight_decay': 0.001}
Dataloader constructed!
Epoch: 0, batch loss: 1.15644 Loss Sum: 321.51258, accuracy : 0.39374, val loss: 24.78156, val accuracy: 0.44215
Final : 0.5185761683138067 [('val/ResNet50/monotone/f1-score', 0.5257142857142858), ('val/ResNet50/screenshot/f1-score', 0.4512534818941504), ('val/ResNet50/unknown/f1-score', 0.5878510777269758)]
Epoch: 1, batch loss: 1.04353 Loss Sum: 281.00796, accuracy : 0.60875, val loss: 23.49370, val accuracy: 0.50038
Final : 0.6877403747083679 [('val/ResNet50/monotone/f1-score', 0.8050847457627118), ('val/ResNet50/screenshot/f1-score', 0.6976744186046511), ('val/ResNet50/unknown/f1-score', 0.5791341376863023)]
Epoch: 2, batch loss: 0.92720 Loss Sum: 252.38423, accuracy : 0.70180, val loss: 21.91407, val accuracy: 0.56169
Final : 0.7409931036565708 [('val/ResNet50/monotone/f1-score', 0.8679245283018868), ('val/ResNet50/screenshot/f1-score', 0.7622950819672131), ('val/ResNet50/unknown/f1-score', 0.6149466192170818)]
Epoch: 3, batch loss: 0.75430 Loss Sum: 218.22091, accuracy : 0.77154, val loss: 20.26924, val accuracy: 0.57778
Final : 0.7557855238862023 [('val/ResNet50/monotone/f1-score', 0.8621908127208481), ('val/ResNet50/screenshot/f1-score', 0.8063872255489021), ('val/ResNet50/unknown/f1-score', 0.6209386281588448)]
---train finished---
Trying to save to /tmp/tmpfvwpnpwy/model
Too long checkpoint name: ResNet50_64_[0.3, 0.2, 0.2, 0.3]_[3, 1]_1.0_0.01_[1.0, 1.0, 1.0, 1.0]_SGD_10_2_100.0 not saved
Done
ResNet50 Loaded!
{'batch_size': 64,
 'class_ratio': [0.3, 0.2, 0.2, 0.3],
 'epoch': [3, 1],
 'gamma': 0.1,
 'learning_rate': 0.0001,
 'loss_cls_weight': tensor([1., 1., 1., 1.]),
 'optimizer': 'SGD',
 'step_size': 2,
 'transforms': [1,
                Compose(
    ColorJitter(brightness=None, contrast=None, saturation=[0.95, 1.05], hue=[-0.05, 0.05])
    RandomHorizontalFlip(p=0.5)
    RandomRotation(degrees=(-20, 20), resample=2, expand=False)
    ToTensor()
    Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])
)],
 'weight_decay': 0}
Dataloader constructed!
Epoch: 0, batch loss: 1.32494 Loss Sum: 340.88060, accuracy : 0.31451, val loss: 26.03112, val accuracy: 0.36628
Final : 0.18528041750356478 [('val/ResNet50/monotone/f1-score', 0.04477611940298507), ('val/ResNet50/screenshot/f1-score', 0.25153374233128833), ('val/ResNet50/unknown/f1-score', 0.564736499674691)]
Epoch: 1, batch loss: 1.15605 Loss Sum: 311.75387, accuracy : 0.43141, val loss: 24.68620, val accuracy: 0.46820
Final : 0.5623494005962114 [('val/ResNet50/monotone/f1-score', 0.5164835164835164), ('val/ResNet50/screenshot/f1-score', 0.5699481865284974), ('val/ResNet50/unknown/f1-score', 0.6041250831669993)]
Epoch: 2, batch loss: 1.10908 Loss Sum: 298.27573, accuracy : 0.51102, val loss: 24.59096, val accuracy: 0.46743
Final : 0.5865218117232784 [('val/ResNet50/monotone/f1-score', 0.5591397849462365), ('val/ResNet50/screenshot/f1-score', 0.606516290726817), ('val/ResNet50/unknown/f1-score', 0.5949625595643294)]
Epoch: 3, batch loss: 1.10349 Loss Sum: 294.60193, accuracy : 0.54217, val loss: 24.50875, val accuracy: 0.47050
Final : 0.625360163732835 [('val/ResNet50/monotone/f1-score', 0.7014218009478673), ('val/ResNet50/screenshot/f1-score', 0.6091127098321343), ('val/ResNet50/unknown/f1-score', 0.5724185724185724)]
---train finished---
Trying to save to /tmp/tmp9ykprq3u/model
Too long checkpoint name: ResNet50_64_[0.3, 0.2, 0.2, 0.3]_[3, 1]_1.0_0.01_[1.0, 1.0, 1.0, 1.0]_SGD_2_1_0 not saved
Done
ResNet50 Loaded!
{'batch_size': 64,
 'class_ratio': [0.3, 0.2, 0.2, 0.3],
 'epoch': [3, 1],
 'gamma': 0.1,
 'learning_rate': 0.0001,
 'loss_cls_weight': tensor([1., 1., 1., 1.]),
 'optimizer': 'SGD',
 'step_size': 2,
 'transforms': [1,
                Compose(
    ColorJitter(brightness=None, contrast=None, saturation=[0.95, 1.05], hue=[-0.05, 0.05])
    RandomHorizontalFlip(p=0.5)
    RandomRotation(degrees=(-20, 20), resample=2, expand=False)
    ToTensor()
    Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])
)],
 'weight_decay': 0.001}
Dataloader constructed!
Epoch: 0, batch loss: 0.79006 Loss Sum: 248.28527, accuracy : 0.68093, val loss: 19.66439, val accuracy: 0.58391
Final : 0.7236988625826781 [('val/ResNet50/monotone/f1-score', 0.7650602409638555), ('val/ResNet50/screenshot/f1-score', 0.7935871743486973), ('val/ResNet50/unknown/f1-score', 0.6242857142857143)]
Epoch: 1, batch loss: 0.56066 Loss Sum: 169.54354, accuracy : 0.81786, val loss: 16.96930, val accuracy: 0.64291
Final : 0.7652325018927688 [('val/ResNet50/monotone/f1-score', 0.7888198757763975), ('val/ResNet50/screenshot/f1-score', 0.8223552894211578), ('val/ResNet50/unknown/f1-score', 0.6907849829351536)]
Epoch: 2, batch loss: 0.58654 Loss Sum: 151.16458, accuracy : 0.83076, val loss: 17.45986, val accuracy: 0.62529
Final : 0.7537656134017038 [('val/ResNet50/monotone/f1-score', 0.7777777777777778), ('val/ResNet50/screenshot/f1-score', 0.821917808219178), ('val/ResNet50/unknown/f1-score', 0.6699232379623168)]
Epoch: 3, batch loss: 0.50171 Loss Sum: 145.51723, accuracy : 0.83617, val loss: 17.29504, val accuracy: 0.62835
Final : 0.7623847187101858 [('val/ResNet50/monotone/f1-score', 0.7925696594427245), ('val/ResNet50/screenshot/f1-score', 0.8339920948616601), ('val/ResNet50/unknown/f1-score', 0.670383275261324)]
---train finished---
Trying to save to /tmp/tmpv27i68tb/model
Too long checkpoint name: ResNet50_64_[0.3, 0.2, 0.2, 0.3]_[3, 1]_1.0_0.01_[1.0, 1.0, 1.0, 1.0]_SGD_2_1_100.0 not saved
Done
ResNet50 Loaded!
{'batch_size': 64,
 'class_ratio': [0.3, 0.2, 0.2, 0.3],
 'epoch': [3, 1],
 'gamma': 0.1,
 'learning_rate': 0.0001,
 'loss_cls_weight': tensor([1., 1., 1., 1.]),
 'optimizer': 'SGD',
 'step_size': 2,
 'transforms': [2,
                Compose(
    RandomAffine(degrees=(0, 0), scale=(0.75, 1.25))
    RandomPerspective(p=0.4)
    RandomHorizontalFlip(p=0.5)
    ToTensor()
    Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])
)],
 'weight_decay': 0}
Dataloader constructed!
Epoch: 0, batch loss: 1.02102 Loss Sum: 270.83350, accuracy : 0.61100, val loss: 21.13276, val accuracy: 0.55249
Final : 0.7257123832484659 [('val/ResNet50/monotone/f1-score', 0.8078175895765473), ('val/ResNet50/screenshot/f1-score', 0.803960396039604), ('val/ResNet50/unknown/f1-score', 0.5884988797610157)]
Epoch: 1, batch loss: 0.62212 Loss Sum: 182.75750, accuracy : 0.80781, val loss: 18.80477, val accuracy: 0.60690
Final : 0.7531629675945987 [('val/ResNet50/monotone/f1-score', 0.7876923076923078), ('val/ResNet50/screenshot/f1-score', 0.8473282442748091), ('val/ResNet50/unknown/f1-score', 0.6401158580738595)]
Epoch: 2, batch loss: 0.57107 Loss Sum: 162.43037, accuracy : 0.83009, val loss: 18.11157, val accuracy: 0.62529
Final : 0.7714581316199071 [('val/ResNet50/monotone/f1-score', 0.8262295081967214), ('val/ResNet50/screenshot/f1-score', 0.8323699421965319), ('val/ResNet50/unknown/f1-score', 0.6676056338028169)]
Epoch: 3, batch loss: 0.65630 Loss Sum: 155.32948, accuracy : 0.83429, val loss: 17.64944, val accuracy: 0.63448
Final : 0.7737323429137274 [('val/ResNet50/monotone/f1-score', 0.8141025641025641), ('val/ResNet50/screenshot/f1-score', 0.8359375), ('val/ResNet50/unknown/f1-score', 0.6806429070580012)]
---train finished---
Trying to save to /tmp/tmpblud094x/model
Too long checkpoint name: ResNet50_64_[0.3, 0.2, 0.2, 0.3]_[3, 1]_1.0_0.01_[1.0, 1.0, 1.0, 1.0]_SGD_2_2_0 not saved
Done
ResNet50 Loaded!
{'batch_size': 64,
 'class_ratio': [0.3, 0.2, 0.2, 0.3],
 'epoch': [3, 1],
 'gamma': 0.1,
 'learning_rate': 0.0001,
 'loss_cls_weight': tensor([1., 1., 1., 1.]),
 'optimizer': 'SGD',
 'step_size': 2,
 'transforms': [2,
                Compose(
    RandomAffine(degrees=(0, 0), scale=(0.75, 1.25))
    RandomPerspective(p=0.4)
    RandomHorizontalFlip(p=0.5)
    ToTensor()
    Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])
)],
 'weight_decay': 0.001}
Dataloader constructed!
Epoch: 0, batch loss: 0.33790 Loss Sum: 178.73351, accuracy : 0.73515, val loss: 12.81293, val accuracy: 0.74023
Final : 0.8160425522179929 [('val/ResNet50/monotone/f1-score', 0.8284789644012944), ('val/ResNet50/screenshot/f1-score', 0.8268839103869654), ('val/ResNet50/unknown/f1-score', 0.7932542161149282)]
Epoch: 1, batch loss: 0.39446 Loss Sum: 97.72809, accuracy : 0.85875, val loss: 15.51268, val accuracy: 0.70575
Final : 0.8133976815908291 [('val/ResNet50/monotone/f1-score', 0.8269230769230769), ('val/ResNet50/screenshot/f1-score', 0.8721804511278196), ('val/ResNet50/unknown/f1-score', 0.7461692205196536)]
Epoch: 2, batch loss: 0.38482 Loss Sum: 89.19888, accuracy : 0.87378, val loss: 15.10368, val accuracy: 0.69885
Final : 0.8201840454249723 [('val/ResNet50/monotone/f1-score', 0.862876254180602), ('val/ResNet50/screenshot/f1-score', 0.8614232209737828), ('val/ResNet50/unknown/f1-score', 0.7422818791946308)]
Epoch: 3, batch loss: 0.32579 Loss Sum: 84.45199, accuracy : 0.87920, val loss: 15.77768, val accuracy: 0.69962
Final : 0.8298660847473565 [('val/ResNet50/monotone/f1-score', 0.8775510204081634), ('val/ResNet50/screenshot/f1-score', 0.8810408921933086), ('val/ResNet50/unknown/f1-score', 0.7391891891891892)]
---train finished---
Trying to save to /tmp/tmprj9jw1y2/model
Too long checkpoint name: ResNet50_64_[0.3, 0.2, 0.2, 0.3]_[3, 1]_1.0_0.01_[1.0, 1.0, 1.0, 1.0]_SGD_2_2_100.0 not saved
Done
ResNet50 Loaded!
{'batch_size': 64,
 'class_ratio': [0.3, 0.2, 0.2, 0.3],
 'epoch': [3, 1],
 'gamma': 0.1,
 'learning_rate': 0.0001,
 'loss_cls_weight': tensor([1.0060, 1.0797, 1.0402, 1.2753]),
 'optimizer': 'Adamax',
 'step_size': 10,
 'transforms': [1,
                Compose(
    ColorJitter(brightness=None, contrast=None, saturation=[0.95, 1.05], hue=[-0.05, 0.05])
    RandomHorizontalFlip(p=0.5)
    RandomRotation(degrees=(-20, 20), resample=2, expand=False)
    ToTensor()
    Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])
)],
 'weight_decay': 0}
Dataloader constructed!
Epoch: 0, batch loss: 0.77051 Loss Sum: 259.58095, accuracy : 0.61605, val loss: 19.24921, val accuracy: 0.63985
Final : 0.7503759617848212 [('val/ResNet50/monotone/f1-score', 0.75625), ('val/ResNet50/screenshot/f1-score', 0.7948164146868251), ('val/ResNet50/unknown/f1-score', 0.7029177718832893)]
Epoch: 1, batch loss: 0.62463 Loss Sum: 176.39495, accuracy : 0.79935, val loss: 17.18278, val accuracy: 0.66360
Final : 0.7749599373811916 [('val/ResNet50/monotone/f1-score', 0.8012618296529967), ('val/ResNet50/screenshot/f1-score', 0.8096192384769539), ('val/ResNet50/unknown/f1-score', 0.7174348697394789)]
Epoch: 2, batch loss: 0.51059 Loss Sum: 145.22090, accuracy : 0.82425, val loss: 14.12930, val accuracy: 0.75019
Final : 0.8193886009271795 [('val/ResNet50/monotone/f1-score', 0.8246753246753246), ('val/ResNet50/screenshot/f1-score', 0.831013916500994), ('val/ResNet50/unknown/f1-score', 0.8027465667915107)]
Epoch: 3, batch loss: 0.13264 Loss Sum: 51.88330, accuracy : 0.92825, val loss: 15.84518, val accuracy: 0.76322
Final : 0.8767686454121465 [('val/ResNet50/monotone/f1-score', 0.9020979020979021), ('val/ResNet50/screenshot/f1-score', 0.9318181818181819), ('val/ResNet50/unknown/f1-score', 0.8018076178179471)]
---train finished---
Trying to save to /tmp/tmpge_361la/model
Too long checkpoint name: ResNet50_64_[0.3, 0.2, 0.2, 0.3]_[3, 1]_1.0_0.01_[1.00600004196167, 1.079699993133545, 1.0401999950408936, 1.2753000259399414]_Adamax_10_1_0 not saved
Done
ResNet50 Loaded!
{'batch_size': 64,
 'class_ratio': [0.3, 0.2, 0.2, 0.3],
 'epoch': [3, 1],
 'gamma': 0.1,
 'learning_rate': 0.0001,
 'loss_cls_weight': tensor([1.0060, 1.0797, 1.0402, 1.2753]),
 'optimizer': 'Adamax',
 'step_size': 10,
 'transforms': [1,
                Compose(
    ColorJitter(brightness=None, contrast=None, saturation=[0.95, 1.05], hue=[-0.05, 0.05])
    RandomHorizontalFlip(p=0.5)
    RandomRotation(degrees=(-20, 20), resample=2, expand=False)
    ToTensor()
    Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])
)],
 'weight_decay': 0.001}
Dataloader constructed!
Epoch: 0, batch loss: 0.80104 Loss Sum: 254.39190, accuracy : 0.62470, val loss: 18.15625, val accuracy: 0.69962
Final : 0.7674071053333125 [('val/ResNet50/monotone/f1-score', 0.78125), ('val/ResNet50/screenshot/f1-score', 0.7605042016806722), ('val/ResNet50/unknown/f1-score', 0.7606516290726817)]
Epoch: 1, batch loss: 0.67799 Loss Sum: 173.12477, accuracy : 0.81013, val loss: 16.44533, val accuracy: 0.69272
Final : 0.7913548709994616 [('val/ResNet50/monotone/f1-score', 0.8242811501597443), ('val/ResNet50/screenshot/f1-score', 0.8016359918200409), ('val/ResNet50/unknown/f1-score', 0.75)]
Epoch: 2, batch loss: 0.52538 Loss Sum: 142.06961, accuracy : 0.83715, val loss: 15.17814, val accuracy: 0.70805
Final : 0.7914909438664641 [('val/ResNet50/monotone/f1-score', 0.7962962962962964), ('val/ResNet50/screenshot/f1-score', 0.8205128205128205), ('val/ResNet50/unknown/f1-score', 0.7588881706528764)]
Epoch: 3, batch loss: 0.25964 Loss Sum: 52.31964, accuracy : 0.92752, val loss: 15.86459, val accuracy: 0.74253
Final : 0.8648797922980233 [('val/ResNet50/monotone/f1-score', 0.9020979020979021), ('val/ResNet50/screenshot/f1-score', 0.9211009174311927), ('val/ResNet50/unknown/f1-score', 0.7785855915399867)]
---train finished---
Trying to save to /tmp/tmpbtdpmwmi/model
Too long checkpoint name: ResNet50_64_[0.3, 0.2, 0.2, 0.3]_[3, 1]_1.0_0.01_[1.00600004196167, 1.079699993133545, 1.0401999950408936, 1.2753000259399414]_Adamax_10_1_100.0 not saved
Done
ResNet50 Loaded!
{'batch_size': 64,
 'class_ratio': [0.3, 0.2, 0.2, 0.3],
 'epoch': [3, 1],
 'gamma': 0.1,
 'learning_rate': 0.0001,
 'loss_cls_weight': tensor([1.0060, 1.0797, 1.0402, 1.2753]),
 'optimizer': 'Adamax',
 'step_size': 10,
 'transforms': [2,
                Compose(
    RandomAffine(degrees=(0, 0), scale=(0.75, 1.25))
    RandomPerspective(p=0.4)
    RandomHorizontalFlip(p=0.5)
    ToTensor()
    Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])
)],
 'weight_decay': 0}
Dataloader constructed!
Epoch: 0, batch loss: 0.81339 Loss Sum: 258.38234, accuracy : 0.60766, val loss: 19.11773, val accuracy: 0.66897
Final : 0.7773180385128756 [('val/ResNet50/monotone/f1-score', 0.8600682593856656), ('val/ResNet50/screenshot/f1-score', 0.7418655097613883), ('val/ResNet50/unknown/f1-score', 0.7361022364217253)]
Epoch: 1, batch loss: 0.60774 Loss Sum: 180.07142, accuracy : 0.80191, val loss: 16.76906, val accuracy: 0.69962
Final : 0.7929509993410612 [('val/ResNet50/monotone/f1-score', 0.8012618296529967), ('val/ResNet50/screenshot/f1-score', 0.8278529980657641), ('val/ResNet50/unknown/f1-score', 0.7516425755584757)]
Epoch: 2, batch loss: 0.57535 Loss Sum: 150.15596, accuracy : 0.82644, val loss: 15.81841, val accuracy: 0.70651
Final : 0.8071894488573633 [('val/ResNet50/monotone/f1-score', 0.8273615635179153), ('val/ResNet50/screenshot/f1-score', 0.8362919132149901), ('val/ResNet50/unknown/f1-score', 0.7601043024771837)]
Epoch: 3, batch loss: 0.21418 Loss Sum: 58.04988, accuracy : 0.91930, val loss: 17.22373, val accuracy: 0.73333
Final : 0.8651800849799982 [('val/ResNet50/monotone/f1-score', 0.9052631578947368), ('val/ResNet50/screenshot/f1-score', 0.9272030651340997), ('val/ResNet50/unknown/f1-score', 0.7715602369980251)]
---train finished---
Trying to save to /tmp/tmptf_c5irm/model
Too long checkpoint name: ResNet50_64_[0.3, 0.2, 0.2, 0.3]_[3, 1]_1.0_0.01_[1.00600004196167, 1.079699993133545, 1.0401999950408936, 1.2753000259399414]_Adamax_10_2_0 not saved
Done
ResNet50 Loaded!
{'batch_size': 64,
 'class_ratio': [0.3, 0.2, 0.2, 0.3],
 'epoch': [3, 1],
 'gamma': 0.1,
 'learning_rate': 0.0001,
 'loss_cls_weight': tensor([1.0060, 1.0797, 1.0402, 1.2753]),
 'optimizer': 'Adamax',
 'step_size': 10,
 'transforms': [2,
                Compose(
    RandomAffine(degrees=(0, 0), scale=(0.75, 1.25))
    RandomPerspective(p=0.4)
    RandomHorizontalFlip(p=0.5)
    ToTensor()
    Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])
)],
 'weight_decay': 0.001}
Dataloader constructed!
Epoch: 0, batch loss: 0.81283 Loss Sum: 263.83644, accuracy : 0.58940, val loss: 19.04706, val accuracy: 0.67816
Final : 0.7868346688372515 [('val/ResNet50/monotone/f1-score', 0.8531468531468531), ('val/ResNet50/screenshot/f1-score', 0.7640449438202247), ('val/ResNet50/unknown/f1-score', 0.7473219911783238)]
Epoch: 1, batch loss: 0.69352 Loss Sum: 183.06565, accuracy : 0.79716, val loss: 16.97799, val accuracy: 0.67893
Final : 0.7972812027408873 [('val/ResNet50/monotone/f1-score', 0.8403908794788273), ('val/ResNet50/screenshot/f1-score', 0.8237704918032787), ('val/ResNet50/unknown/f1-score', 0.7320605661619486)]
Epoch: 2, batch loss: 0.48000 Loss Sum: 149.95688, accuracy : 0.82905, val loss: 15.72508, val accuracy: 0.70038
Final : 0.7976286782929704 [('val/ResNet50/monotone/f1-score', 0.8152866242038217), ('val/ResNet50/screenshot/f1-score', 0.8270377733598409), ('val/ResNet50/unknown/f1-score', 0.7526041666666666)]
Epoch: 3, batch loss: 0.18309 Loss Sum: 58.24895, accuracy : 0.91851, val loss: 17.90663, val accuracy: 0.72567
Final : 0.8464552550552821 [('val/ResNet50/monotone/f1-score', 0.86), ('val/ResNet50/screenshot/f1-score', 0.9219047619047619), ('val/ResNet50/unknown/f1-score', 0.7649402390438247)]
---train finished---
Trying to save to /tmp/tmprn535cxg/model
Too long checkpoint name: ResNet50_64_[0.3, 0.2, 0.2, 0.3]_[3, 1]_1.0_0.01_[1.00600004196167, 1.079699993133545, 1.0401999950408936, 1.2753000259399414]_Adamax_10_2_100.0 not saved
Done
ResNet50 Loaded!
{'batch_size': 64,
 'class_ratio': [0.3, 0.2, 0.2, 0.3],
 'epoch': [3, 1],
 'gamma': 0.1,
 'learning_rate': 0.0001,
 'loss_cls_weight': tensor([1.0060, 1.0797, 1.0402, 1.2753]),
 'optimizer': 'Adamax',
 'step_size': 2,
 'transforms': [1,
                Compose(
    ColorJitter(brightness=None, contrast=None, saturation=[0.95, 1.05], hue=[-0.05, 0.05])
    RandomHorizontalFlip(p=0.5)
    RandomRotation(degrees=(-20, 20), resample=2, expand=False)
    ToTensor()
    Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])
)],
 'weight_decay': 0}
Dataloader constructed!
Epoch: 0, batch loss: 0.76941 Loss Sum: 253.73275, accuracy : 0.62932, val loss: 18.46107, val accuracy: 0.67203
Final : 0.7662922145728894 [('val/ResNet50/monotone/f1-score', 0.7850467289719625), ('val/ResNet50/screenshot/f1-score', 0.7885010266940451), ('val/ResNet50/unknown/f1-score', 0.7269180754226268)]
Epoch: 1, batch loss: 0.69420 Loss Sum: 174.96079, accuracy : 0.80435, val loss: 16.47448, val accuracy: 0.68582
Final : 0.7826959252630165 [('val/ResNet50/monotone/f1-score', 0.8050314465408804), ('val/ResNet50/screenshot/f1-score', 0.8040816326530611), ('val/ResNet50/unknown/f1-score', 0.7407407407407408)]
Epoch: 2, batch loss: 0.58655 Loss Sum: 153.97759, accuracy : 0.82704, val loss: 16.18566, val accuracy: 0.68429
Final : 0.7878685568847418 [('val/ResNet50/monotone/f1-score', 0.8220064724919094), ('val/ResNet50/screenshot/f1-score', 0.8040816326530611), ('val/ResNet50/unknown/f1-score', 0.7399219765929779)]
Epoch: 3, batch loss: 0.20532 Loss Sum: 91.00308, accuracy : 0.89338, val loss: 14.08523, val accuracy: 0.72720
Final : 0.8393947762371446 [('val/ResNet50/monotone/f1-score', 0.8486842105263157), ('val/ResNet50/screenshot/f1-score', 0.9107806691449813), ('val/ResNet50/unknown/f1-score', 0.7651363938789089)]
---train finished---
Trying to save to /tmp/tmp78sn_oit/model
Too long checkpoint name: ResNet50_64_[0.3, 0.2, 0.2, 0.3]_[3, 1]_1.0_0.01_[1.00600004196167, 1.079699993133545, 1.0401999950408936, 1.2753000259399414]_Adamax_2_1_0 not saved
Done
ResNet50 Loaded!
{'batch_size': 64,
 'class_ratio': [0.3, 0.2, 0.2, 0.3],
 'epoch': [3, 1],
 'gamma': 0.1,
 'learning_rate': 0.0001,
 'loss_cls_weight': tensor([1.0060, 1.0797, 1.0402, 1.2753]),
 'optimizer': 'Adamax',
 'step_size': 2,
 'transforms': [1,
                Compose(
    ColorJitter(brightness=None, contrast=None, saturation=[0.95, 1.05], hue=[-0.05, 0.05])
    RandomHorizontalFlip(p=0.5)
    RandomRotation(degrees=(-20, 20), resample=2, expand=False)
    ToTensor()
    Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])
)],
 'weight_decay': 0.001}
Dataloader constructed!
Epoch: 0, batch loss: 0.72041 Loss Sum: 257.60850, accuracy : 0.60753, val loss: 18.61329, val accuracy: 0.66743
Final : 0.7748593223789538 [('val/ResNet50/monotone/f1-score', 0.8389261744966443), ('val/ResNet50/screenshot/f1-score', 0.7544642857142857), ('val/ResNet50/unknown/f1-score', 0.7350318471337579)]
Epoch: 1, batch loss: 0.62727 Loss Sum: 173.29612, accuracy : 0.80672, val loss: 15.20914, val accuracy: 0.73870
Final : 0.8147091098694381 [('val/ResNet50/monotone/f1-score', 0.8333333333333334), ('val/ResNet50/screenshot/f1-score', 0.816), ('val/ResNet50/unknown/f1-score', 0.7952410770194114)]
Epoch: 2, batch loss: 0.65086 Loss Sum: 152.24353, accuracy : 0.82528, val loss: 16.14327, val accuracy: 0.67739
Final : 0.7743982406999644 [('val/ResNet50/monotone/f1-score', 0.78125), ('val/ResNet50/screenshot/f1-score', 0.812), ('val/ResNet50/unknown/f1-score', 0.7320605661619486)]
Epoch: 3, batch loss: 0.26825 Loss Sum: 93.09719, accuracy : 0.89137, val loss: 14.65136, val accuracy: 0.71724
Final : 0.8427891462652594 [('val/ResNet50/monotone/f1-score', 0.8657718120805369), ('val/ResNet50/screenshot/f1-score', 0.9155722326454032), ('val/ResNet50/unknown/f1-score', 0.7551978537894031)]
---train finished---
Trying to save to /tmp/tmp3txesvfd/model
Too long checkpoint name: ResNet50_64_[0.3, 0.2, 0.2, 0.3]_[3, 1]_1.0_0.01_[1.00600004196167, 1.079699993133545, 1.0401999950408936, 1.2753000259399414]_Adamax_2_1_100.0 not saved
Done
ResNet50 Loaded!
{'batch_size': 64,
 'class_ratio': [0.3, 0.2, 0.2, 0.3],
 'epoch': [3, 1],
 'gamma': 0.1,
 'learning_rate': 0.0001,
 'loss_cls_weight': tensor([1.0060, 1.0797, 1.0402, 1.2753]),
 'optimizer': 'Adamax',
 'step_size': 2,
 'transforms': [2,
                Compose(
    RandomAffine(degrees=(0, 0), scale=(0.75, 1.25))
    RandomPerspective(p=0.4)
    RandomHorizontalFlip(p=0.5)
    ToTensor()
    Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])
)],
 'weight_decay': 0}
Dataloader constructed!
Epoch: 0, batch loss: 0.80878 Loss Sum: 265.48878, accuracy : 0.56944, val loss: 19.01318, val accuracy: 0.67816
Final : 0.7837692139131713 [('val/ResNet50/monotone/f1-score', 0.851063829787234), ('val/ResNet50/screenshot/f1-score', 0.756043956043956), ('val/ResNet50/unknown/f1-score', 0.7482649842271293)]
Epoch: 1, batch loss: 0.65228 Loss Sum: 185.85407, accuracy : 0.79120, val loss: 16.63788, val accuracy: 0.69425
Final : 0.8096808881336162 [('val/ResNet50/monotone/f1-score', 0.8698630136986302), ('val/ResNet50/screenshot/f1-score', 0.8110403397027601), ('val/ResNet50/unknown/f1-score', 0.7523992322456815)]
Epoch: 2, batch loss: 0.61841 Loss Sum: 163.85561, accuracy : 0.81262, val loss: 16.86542, val accuracy: 0.68812
Final : 0.8058613828006557 [('val/ResNet50/monotone/f1-score', 0.8533333333333334), ('val/ResNet50/screenshot/f1-score', 0.8249496981891347), ('val/ResNet50/unknown/f1-score', 0.743421052631579)]
Epoch: 3, batch loss: 0.41334 Loss Sum: 99.01271, accuracy : 0.88376, val loss: 15.19652, val accuracy: 0.71801
Final : 0.8373723038371165 [('val/ResNet50/monotone/f1-score', 0.8657718120805369), ('val/ResNet50/screenshot/f1-score', 0.8947368421052632), ('val/ResNet50/unknown/f1-score', 0.7579787234042553)]
---train finished---
Trying to save to /tmp/tmpym4rzbeo/model
Too long checkpoint name: ResNet50_64_[0.3, 0.2, 0.2, 0.3]_[3, 1]_1.0_0.01_[1.00600004196167, 1.079699993133545, 1.0401999950408936, 1.2753000259399414]_Adamax_2_2_0 not saved
Done
ResNet50 Loaded!
{'batch_size': 64,
 'class_ratio': [0.3, 0.2, 0.2, 0.3],
 'epoch': [3, 1],
 'gamma': 0.1,
 'learning_rate': 0.0001,
 'loss_cls_weight': tensor([1.0060, 1.0797, 1.0402, 1.2753]),
 'optimizer': 'Adamax',
 'step_size': 2,
 'transforms': [2,
                Compose(
    RandomAffine(degrees=(0, 0), scale=(0.75, 1.25))
    RandomPerspective(p=0.4)
    RandomHorizontalFlip(p=0.5)
    ToTensor()
    Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])
)],
 'weight_decay': 0.001}
Dataloader constructed!
Epoch: 0, batch loss: 0.85100 Loss Sum: 276.03080, accuracy : 0.56280, val loss: 17.66682, val accuracy: 0.80000
Final : 0.8231641877356136 [('val/ResNet50/monotone/f1-score', 0.8962962962962963), ('val/ResNet50/screenshot/f1-score', 0.7264367816091954), ('val/ResNet50/unknown/f1-score', 0.8566629339305711)]
Epoch: 1, batch loss: 0.67556 Loss Sum: 192.23562, accuracy : 0.78542, val loss: 17.17558, val accuracy: 0.70421
Final : 0.8037694564005929 [('val/ResNet50/monotone/f1-score', 0.8131147540983608), ('val/ResNet50/screenshot/f1-score', 0.8412698412698412), ('val/ResNet50/unknown/f1-score', 0.7591145833333334)]
Epoch: 2, batch loss: 0.62251 Loss Sum: 167.48859, accuracy : 0.82053, val loss: 16.98565, val accuracy: 0.69732
Final : 0.808784900304383 [('val/ResNet50/monotone/f1-score', 0.8619528619528619), ('val/ResNet50/screenshot/f1-score', 0.8198019801980198), ('val/ResNet50/unknown/f1-score', 0.7486979166666666)]
Epoch: 3, batch loss: 0.59447 Loss Sum: 99.39978, accuracy : 0.88455, val loss: 15.93596, val accuracy: 0.69732
Final : 0.8333543504470995 [('val/ResNet50/monotone/f1-score', 0.8797250859106528), ('val/ResNet50/screenshot/f1-score', 0.8926553672316384), ('val/ResNet50/unknown/f1-score', 0.7369844489519946)]
---train finished---
Trying to save to /tmp/tmp730qmw89/model
Too long checkpoint name: ResNet50_64_[0.3, 0.2, 0.2, 0.3]_[3, 1]_1.0_0.01_[1.00600004196167, 1.079699993133545, 1.0401999950408936, 1.2753000259399414]_Adamax_2_2_100.0 not saved
Done
ResNet50 Loaded!
{'batch_size': 64,
 'class_ratio': [0.3, 0.2, 0.2, 0.3],
 'epoch': [3, 1],
 'gamma': 0.1,
 'learning_rate': 0.0001,
 'loss_cls_weight': tensor([1.0060, 1.0797, 1.0402, 1.2753]),
 'optimizer': 'Adam',
 'step_size': 10,
 'transforms': [1,
                Compose(
    ColorJitter(brightness=None, contrast=None, saturation=[0.95, 1.05], hue=[-0.05, 0.05])
    RandomHorizontalFlip(p=0.5)
    RandomRotation(degrees=(-20, 20), resample=2, expand=False)
    ToTensor()
    Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])
)],
 'weight_decay': 0}
Dataloader constructed!
Epoch: 0, batch loss: 0.59612 Loss Sum: 212.32968, accuracy : 0.70783, val loss: 15.46988, val accuracy: 0.71264
Final : 0.7942684506757545 [('val/ResNet50/monotone/f1-score', 0.7961783439490446), ('val/ResNet50/screenshot/f1-score', 0.8164948453608247), ('val/ResNet50/unknown/f1-score', 0.7707936507936508)]
Epoch: 1, batch loss: 0.46819 Loss Sum: 130.26445, accuracy : 0.84232, val loss: 13.24795, val accuracy: 0.74789
Final : 0.8191650877364635 [('val/ResNet50/monotone/f1-score', 0.8266666666666665), ('val/ResNet50/screenshot/f1-score', 0.8275862068965516), ('val/ResNet50/unknown/f1-score', 0.8034717916924985)]
Epoch: 2, batch loss: 0.34175 Loss Sum: 108.37180, accuracy : 0.86350, val loss: 15.07677, val accuracy: 0.70805
Final : 0.8155620622849188 [('val/ResNet50/monotone/f1-score', 0.8181818181818181), ('val/ResNet50/screenshot/f1-score', 0.8795411089866157), ('val/ResNet50/unknown/f1-score', 0.7538155275381553)]
Epoch: 3, batch loss: 0.12189 Loss Sum: 51.09158, accuracy : 0.93014, val loss: 17.01405, val accuracy: 0.75556
Final : 0.8838122499594829 [('val/ResNet50/monotone/f1-score', 0.927007299270073), ('val/ResNet50/screenshot/f1-score', 0.9366602687140115), ('val/ResNet50/unknown/f1-score', 0.7950872656755009)]
---train finished---
Trying to save to /tmp/tmpnjt2v2in/model
Too long checkpoint name: ResNet50_64_[0.3, 0.2, 0.2, 0.3]_[3, 1]_1.0_0.01_[1.00600004196167, 1.079699993133545, 1.0401999950408936, 1.2753000259399414]_Adam_10_1_0 not saved
Done
ResNet50 Loaded!
{'batch_size': 64,
 'class_ratio': [0.3, 0.2, 0.2, 0.3],
 'epoch': [3, 1],
 'gamma': 0.1,
 'learning_rate': 0.0001,
 'loss_cls_weight': tensor([1.0060, 1.0797, 1.0402, 1.2753]),
 'optimizer': 'Adam',
 'step_size': 10,
 'transforms': [1,
                Compose(
    ColorJitter(brightness=None, contrast=None, saturation=[0.95, 1.05], hue=[-0.05, 0.05])
    RandomHorizontalFlip(p=0.5)
    RandomRotation(degrees=(-20, 20), resample=2, expand=False)
    ToTensor()
    Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])
)],
 'weight_decay': 0.001}
Dataloader constructed!
Epoch: 0, batch loss: 0.61603 Loss Sum: 221.47955, accuracy : 0.68841, val loss: 17.63098, val accuracy: 0.64138
Final : 0.7534996948279344 [('val/ResNet50/monotone/f1-score', 0.7582089552238805), ('val/ResNet50/screenshot/f1-score', 0.8208092485549134), ('val/ResNet50/unknown/f1-score', 0.6874135546334716)]
Epoch: 1, batch loss: 0.50838 Loss Sum: 133.06500, accuracy : 0.83946, val loss: 14.11407, val accuracy: 0.74100
Final : 0.8201683569612802 [('val/ResNet50/monotone/f1-score', 0.8205128205128205), ('val/ResNet50/screenshot/f1-score', 0.8522072936660269), ('val/ResNet50/unknown/f1-score', 0.7890025575447571)]
Epoch: 2, batch loss: 0.48884 Loss Sum: 110.96875, accuracy : 0.86082, val loss: 14.50653, val accuracy: 0.70115
Final : 0.8063408885120238 [('val/ResNet50/monotone/f1-score', 0.8246753246753246), ('val/ResNet50/screenshot/f1-score', 0.842315369261477), ('val/ResNet50/unknown/f1-score', 0.7547416612164813)]
Epoch: 3, batch loss: 0.09962 Loss Sum: 52.20060, accuracy : 0.92582, val loss: 17.35762, val accuracy: 0.77625
Final : 0.8924261578046531 [('val/ResNet50/monotone/f1-score', 0.9288389513108615), ('val/ResNet50/screenshot/f1-score', 0.9333333333333332), ('val/ResNet50/unknown/f1-score', 0.8198599618077657)]
---train finished---
Trying to save to /tmp/tmpavmvj496/model
Too long checkpoint name: ResNet50_64_[0.3, 0.2, 0.2, 0.3]_[3, 1]_1.0_0.01_[1.00600004196167, 1.079699993133545, 1.0401999950408936, 1.2753000259399414]_Adam_10_1_100.0 not saved
Done
ResNet50 Loaded!
{'batch_size': 64,
 'class_ratio': [0.3, 0.2, 0.2, 0.3],
 'epoch': [3, 1],
 'gamma': 0.1,
 'learning_rate': 0.0001,
 'loss_cls_weight': tensor([1.0060, 1.0797, 1.0402, 1.2753]),
 'optimizer': 'Adam',
 'step_size': 10,
 'transforms': [2,
                Compose(
    RandomAffine(degrees=(0, 0), scale=(0.75, 1.25))
    RandomPerspective(p=0.4)
    RandomHorizontalFlip(p=0.5)
    ToTensor()
    Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])
)],
 'weight_decay': 0}
Dataloader constructed!
Epoch: 0, batch loss: 0.69501 Loss Sum: 222.77569, accuracy : 0.68853, val loss: 17.24089, val accuracy: 0.66437
Final : 0.7861513892573097 [('val/ResNet50/monotone/f1-score', 0.821656050955414), ('val/ResNet50/screenshot/f1-score', 0.820618556701031), ('val/ResNet50/unknown/f1-score', 0.7205882352941176)]
Epoch: 1, batch loss: 0.53990 Loss Sum: 138.81533, accuracy : 0.83319, val loss: 14.86275, val accuracy: 0.70345
Final : 0.8131669375808005 [('val/ResNet50/monotone/f1-score', 0.862876254180602), ('val/ResNet50/screenshot/f1-score', 0.8258317025440314), ('val/ResNet50/unknown/f1-score', 0.7545691906005223)]
Epoch: 2, batch loss: 0.50152 Loss Sum: 117.13039, accuracy : 0.85029, val loss: 14.04154, val accuracy: 0.72490
Final : 0.8202502891097538 [('val/ResNet50/monotone/f1-score', 0.8504983388704319), ('val/ResNet50/screenshot/f1-score', 0.8401486988847583), ('val/ResNet50/unknown/f1-score', 0.7723418134377038)]
Epoch: 3, batch loss: 0.14451 Loss Sum: 59.25756, accuracy : 0.91687, val loss: 16.82838, val accuracy: 0.75939
Final : 0.8759383744072081 [('val/ResNet50/monotone/f1-score', 0.8958333333333334), ('val/ResNet50/screenshot/f1-score', 0.9386973180076629), ('val/ResNet50/unknown/f1-score', 0.7992227979274612)]
---train finished---
Trying to save to /tmp/tmpxenwbcdn/model
Too long checkpoint name: ResNet50_64_[0.3, 0.2, 0.2, 0.3]_[3, 1]_1.0_0.01_[1.00600004196167, 1.079699993133545, 1.0401999950408936, 1.2753000259399414]_Adam_10_2_0 not saved
Done
ResNet50 Loaded!
{'batch_size': 64,
 'class_ratio': [0.3, 0.2, 0.2, 0.3],
 'epoch': [3, 1],
 'gamma': 0.1,
 'learning_rate': 0.0001,
 'loss_cls_weight': tensor([1.0060, 1.0797, 1.0402, 1.2753]),
 'optimizer': 'Adam',
 'step_size': 10,
 'transforms': [2,
                Compose(
    RandomAffine(degrees=(0, 0), scale=(0.75, 1.25))
    RandomPerspective(p=0.4)
    RandomHorizontalFlip(p=0.5)
    ToTensor()
    Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])
)],
 'weight_decay': 0.001}
Dataloader constructed!
Epoch: 0, batch loss: 0.59364 Loss Sum: 216.46380, accuracy : 0.71306, val loss: 17.99449, val accuracy: 0.64061
Final : 0.7757351819688084 [('val/ResNet50/monotone/f1-score', 0.821656050955414), ('val/ResNet50/screenshot/f1-score', 0.8216432865731463), ('val/ResNet50/unknown/f1-score', 0.6914600550964187)]
Epoch: 1, batch loss: 0.47794 Loss Sum: 135.47434, accuracy : 0.83222, val loss: 16.08792, val accuracy: 0.68352
Final : 0.8039378447907697 [('val/ResNet50/monotone/f1-score', 0.8366013071895425), ('val/ResNet50/screenshot/f1-score', 0.8494208494208494), ('val/ResNet50/unknown/f1-score', 0.7311827956989247)]
Epoch: 2, batch loss: 0.39486 Loss Sum: 115.23356, accuracy : 0.84646, val loss: 14.64446, val accuracy: 0.72644
Final : 0.8247206883424725 [('val/ResNet50/monotone/f1-score', 0.8514851485148515), ('val/ResNet50/screenshot/f1-score', 0.8529411764705882), ('val/ResNet50/unknown/f1-score', 0.7723684210526317)]
Epoch: 3, batch loss: 0.10327 Loss Sum: 60.27310, accuracy : 0.91450, val loss: 16.72583, val accuracy: 0.76782
Final : 0.8795994122693119 [('val/ResNet50/monotone/f1-score', 0.9084507042253521), ('val/ResNet50/screenshot/f1-score', 0.9266409266409266), ('val/ResNet50/unknown/f1-score', 0.8084291187739464)]
---train finished---
Trying to save to /tmp/tmp9duev8tb/model
Too long checkpoint name: ResNet50_64_[0.3, 0.2, 0.2, 0.3]_[3, 1]_1.0_0.01_[1.00600004196167, 1.079699993133545, 1.0401999950408936, 1.2753000259399414]_Adam_10_2_100.0 not saved
Done
ResNet50 Loaded!
{'batch_size': 64,
 'class_ratio': [0.3, 0.2, 0.2, 0.3],
 'epoch': [3, 1],
 'gamma': 0.1,
 'learning_rate': 0.0001,
 'loss_cls_weight': tensor([1.0060, 1.0797, 1.0402, 1.2753]),
 'optimizer': 'Adam',
 'step_size': 2,
 'transforms': [1,
                Compose(
    ColorJitter(brightness=None, contrast=None, saturation=[0.95, 1.05], hue=[-0.05, 0.05])
    RandomHorizontalFlip(p=0.5)
    RandomRotation(degrees=(-20, 20), resample=2, expand=False)
    ToTensor()
    Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])
)],
 'weight_decay': 0}
Dataloader constructed!
Epoch: 0, batch loss: 0.63654 Loss Sum: 218.15976, accuracy : 0.70247, val loss: 16.50604, val accuracy: 0.68276
Final : 0.7801616358826827 [('val/ResNet50/monotone/f1-score', 0.8037974683544304), ('val/ResNet50/screenshot/f1-score', 0.7975708502024291), ('val/ResNet50/unknown/f1-score', 0.7406923579359894)]
Epoch: 1, batch loss: 0.47514 Loss Sum: 131.54624, accuracy : 0.83800, val loss: 15.39136, val accuracy: 0.68276
Final : 0.7975225845395932 [('val/ResNet50/monotone/f1-score', 0.839344262295082), ('val/ResNet50/screenshot/f1-score', 0.8221343873517787), ('val/ResNet50/unknown/f1-score', 0.7350993377483444)]
Epoch: 2, batch loss: 0.47145 Loss Sum: 116.45103, accuracy : 0.85230, val loss: 14.86318, val accuracy: 0.69962
Final : 0.8008710662954652 [('val/ResNet50/monotone/f1-score', 0.8129032258064516), ('val/ResNet50/screenshot/f1-score', 0.8396039603960397), ('val/ResNet50/unknown/f1-score', 0.7526178010471205)]
Epoch: 3, batch loss: 0.24078 Loss Sum: 66.26927, accuracy : 0.91431, val loss: 13.71813, val accuracy: 0.76628
Final : 0.8663063257450743 [('val/ResNet50/monotone/f1-score', 0.8865979381443299), ('val/ResNet50/screenshot/f1-score', 0.9107806691449813), ('val/ResNet50/unknown/f1-score', 0.8051446945337621)]
---train finished---
Trying to save to /tmp/tmpxx_mi2zw/model
Too long checkpoint name: ResNet50_64_[0.3, 0.2, 0.2, 0.3]_[3, 1]_1.0_0.01_[1.00600004196167, 1.079699993133545, 1.0401999950408936, 1.2753000259399414]_Adam_2_1_0 not saved
Done
ResNet50 Loaded!
{'batch_size': 64,
 'class_ratio': [0.3, 0.2, 0.2, 0.3],
 'epoch': [3, 1],
 'gamma': 0.1,
 'learning_rate': 0.0001,
 'loss_cls_weight': tensor([1.0060, 1.0797, 1.0402, 1.2753]),
 'optimizer': 'Adam',
 'step_size': 2,
 'transforms': [1,
                Compose(
    ColorJitter(brightness=None, contrast=None, saturation=[0.95, 1.05], hue=[-0.05, 0.05])
    RandomHorizontalFlip(p=0.5)
    RandomRotation(degrees=(-20, 20), resample=2, expand=False)
    ToTensor()
    Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])
)],
 'weight_decay': 0.001}
Dataloader constructed!
Epoch: 0, batch loss: 0.63802 Loss Sum: 215.24114, accuracy : 0.69438, val loss: 16.39001, val accuracy: 0.67893
Final : 0.7769034197812213 [('val/ResNet50/monotone/f1-score', 0.7852760736196318), ('val/ResNet50/screenshot/f1-score', 0.8114754098360656), ('val/ResNet50/unknown/f1-score', 0.7358738501971092)]
Epoch: 1, batch loss: 0.47739 Loss Sum: 132.71022, accuracy : 0.83684, val loss: 14.35641, val accuracy: 0.72720
Final : 0.8244407941676841 [('val/ResNet50/monotone/f1-score', 0.8523489932885905), ('val/ResNet50/screenshot/f1-score', 0.8443579766536965), ('val/ResNet50/unknown/f1-score', 0.7786357786357786)]
Epoch: 2, batch loss: 0.67061 Loss Sum: 118.06386, accuracy : 0.84804, val loss: 14.70256, val accuracy: 0.70651
Final : 0.8060156492110037 [('val/ResNet50/monotone/f1-score', 0.8152866242038217), ('val/ResNet50/screenshot/f1-score', 0.8493150684931506), ('val/ResNet50/unknown/f1-score', 0.7562254259501965)]
Epoch: 3, batch loss: 0.13424 Loss Sum: 67.25591, accuracy : 0.91115, val loss: 13.44097, val accuracy: 0.76092
Final : 0.8812460996852439 [('val/ResNet50/monotone/f1-score', 0.9142857142857144), ('val/ResNet50/screenshot/f1-score', 0.935361216730038), ('val/ResNet50/unknown/f1-score', 0.8002585649644471)]
---train finished---
Trying to save to /tmp/tmpzyntkgid/model
Too long checkpoint name: ResNet50_64_[0.3, 0.2, 0.2, 0.3]_[3, 1]_1.0_0.01_[1.00600004196167, 1.079699993133545, 1.0401999950408936, 1.2753000259399414]_Adam_2_1_100.0 not saved
Done
ResNet50 Loaded!
{'batch_size': 64,
 'class_ratio': [0.3, 0.2, 0.2, 0.3],
 'epoch': [3, 1],
 'gamma': 0.1,
 'learning_rate': 0.0001,
 'loss_cls_weight': tensor([1.0060, 1.0797, 1.0402, 1.2753]),
 'optimizer': 'Adam',
 'step_size': 2,
 'transforms': [2,
                Compose(
    RandomAffine(degrees=(0, 0), scale=(0.75, 1.25))
    RandomPerspective(p=0.4)
    RandomHorizontalFlip(p=0.5)
    ToTensor()
    Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])
)],
 'weight_decay': 0}
Dataloader constructed!
Epoch: 0, batch loss: 0.61661 Loss Sum: 219.67033, accuracy : 0.68896, val loss: 17.45638, val accuracy: 0.65900
Final : 0.7736836537725283 [('val/ResNet50/monotone/f1-score', 0.8), ('val/ResNet50/screenshot/f1-score', 0.8186915887850468), ('val/ResNet50/unknown/f1-score', 0.7070985527222605)]
Epoch: 1, batch loss: 0.50138 Loss Sum: 138.07896, accuracy : 0.83325, val loss: 14.50180, val accuracy: 0.72797
Final : 0.8318476320282523 [('val/ResNet50/monotone/f1-score', 0.8716216216216216), ('val/ResNet50/screenshot/f1-score', 0.8505747126436781), ('val/ResNet50/unknown/f1-score', 0.7764095917044718)]
Epoch: 2, batch loss: 0.43311 Loss Sum: 121.77105, accuracy : 0.84755, val loss: 15.10901, val accuracy: 0.70881
Final : 0.8073287984107285 [('val/ResNet50/monotone/f1-score', 0.8269230769230769), ('val/ResNet50/screenshot/f1-score', 0.8346456692913385), ('val/ResNet50/unknown/f1-score', 0.762402088772846)]
Epoch: 3, batch loss: 0.40662 Loss Sum: 72.02284, accuracy : 0.90360, val loss: 15.84776, val accuracy: 0.71494
Final : 0.8461451762096924 [('val/ResNet50/monotone/f1-score', 0.8835616438356165), ('val/ResNet50/screenshot/f1-score', 0.9121495327102804), ('val/ResNet50/unknown/f1-score', 0.7516778523489932)]
---train finished---
Trying to save to /tmp/tmpbloeb08w/model
Too long checkpoint name: ResNet50_64_[0.3, 0.2, 0.2, 0.3]_[3, 1]_1.0_0.01_[1.00600004196167, 1.079699993133545, 1.0401999950408936, 1.2753000259399414]_Adam_2_2_0 not saved
Done
ResNet50 Loaded!
{'batch_size': 64,
 'class_ratio': [0.3, 0.2, 0.2, 0.3],
 'epoch': [3, 1],
 'gamma': 0.1,
 'learning_rate': 0.0001,
 'loss_cls_weight': tensor([1.0060, 1.0797, 1.0402, 1.2753]),
 'optimizer': 'Adam',
 'step_size': 2,
 'transforms': [2,
                Compose(
    RandomAffine(degrees=(0, 0), scale=(0.75, 1.25))
    RandomPerspective(p=0.4)
    RandomHorizontalFlip(p=0.5)
    ToTensor()
    Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])
)],
 'weight_decay': 0.001}
Dataloader constructed!
Epoch: 0, batch loss: 0.61021 Loss Sum: 218.97246, accuracy : 0.69645, val loss: 16.83986, val accuracy: 0.67050
Final : 0.7880859256452165 [('val/ResNet50/monotone/f1-score', 0.8311688311688311), ('val/ResNet50/screenshot/f1-score', 0.8158415841584158), ('val/ResNet50/unknown/f1-score', 0.7218145430286859)]
Epoch: 1, batch loss: 0.49627 Loss Sum: 136.20378, accuracy : 0.83916, val loss: 14.51796, val accuracy: 0.71724
Final : 0.8234367595815482 [('val/ResNet50/monotone/f1-score', 0.8865979381443299), ('val/ResNet50/screenshot/f1-score', 0.8165680473372781), ('val/ResNet50/unknown/f1-score', 0.7712082262210798)]
Epoch: 2, batch loss: 0.36865 Loss Sum: 119.97864, accuracy : 0.85486, val loss: 15.76630, val accuracy: 0.68352
Final : 0.7934693821799549 [('val/ResNet50/monotone/f1-score', 0.8284789644012944), ('val/ResNet50/screenshot/f1-score', 0.8237547892720307), ('val/ResNet50/unknown/f1-score', 0.7319999999999999)]
Epoch: 3, batch loss: 0.12930 Loss Sum: 69.72540, accuracy : 0.90665, val loss: 14.90347, val accuracy: 0.74330
Final : 0.8541465411783679 [('val/ResNet50/monotone/f1-score', 0.8827586206896552), ('val/ResNet50/screenshot/f1-score', 0.8984962406015037), ('val/ResNet50/unknown/f1-score', 0.7856677524429968)]
---train finished---
Trying to save to /tmp/tmpxtuytmt1/model
Too long checkpoint name: ResNet50_64_[0.3, 0.2, 0.2, 0.3]_[3, 1]_1.0_0.01_[1.00600004196167, 1.079699993133545, 1.0401999950408936, 1.2753000259399414]_Adam_2_2_100.0 not saved
Done
ResNet50 Loaded!
{'batch_size': 64,
 'class_ratio': [0.3, 0.2, 0.2, 0.3],
 'epoch': [3, 1],
 'gamma': 0.1,
 'learning_rate': 0.0001,
 'loss_cls_weight': tensor([1.0060, 1.0797, 1.0402, 1.2753]),
 'optimizer': 'SGD',
 'step_size': 10,
 'transforms': [1,
                Compose(
    ColorJitter(brightness=None, contrast=None, saturation=[0.95, 1.05], hue=[-0.05, 0.05])
    RandomHorizontalFlip(p=0.5)
    RandomRotation(degrees=(-20, 20), resample=2, expand=False)
    ToTensor()
    Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])
)],
 'weight_decay': 0}
Dataloader constructed!
Epoch: 0, batch loss: 0.80721 Loss Sum: 263.77573, accuracy : 0.59238, val loss: 18.77004, val accuracy: 0.67126
Final : 0.772230849554956 [('val/ResNet50/monotone/f1-score', 0.8300653594771242), ('val/ResNet50/screenshot/f1-score', 0.7494456762749445), ('val/ResNet50/unknown/f1-score', 0.7402680280791322)]
Epoch: 1, batch loss: 0.68703 Loss Sum: 175.14161, accuracy : 0.81140, val loss: 15.93097, val accuracy: 0.73333
Final : 0.8176964814316232 [('val/ResNet50/monotone/f1-score', 0.8474576271186441), ('val/ResNet50/screenshot/f1-score', 0.8161616161616162), ('val/ResNet50/unknown/f1-score', 0.7904642409033878)]
Epoch: 2, batch loss: 0.54645 Loss Sum: 146.27098, accuracy : 0.83623, val loss: 14.68598, val accuracy: 0.74100
Final : 0.8227544391494009 [('val/ResNet50/monotone/f1-score', 0.8355263157894737), ('val/ResNet50/screenshot/f1-score', 0.8414872798434442), ('val/ResNet50/unknown/f1-score', 0.7921419518377693)]
Epoch: 3, batch loss: 0.26975 Loss Sum: 112.30949, accuracy : 0.86934, val loss: 12.80491, val accuracy: 0.75479
Final : 0.8487031423525798 [('val/ResNet50/monotone/f1-score', 0.862876254180602), ('val/ResNet50/screenshot/f1-score', 0.8841698841698841), ('val/ResNet50/unknown/f1-score', 0.8012779552715655)]
---train finished---
Trying to save to /tmp/tmpwq28uam_/model
Too long checkpoint name: ResNet50_64_[0.3, 0.2, 0.2, 0.3]_[3, 1]_1.0_0.01_[1.00600004196167, 1.079699993133545, 1.0401999950408936, 1.2753000259399414]_SGD_10_1_0 not saved
Done
ResNet50 Loaded!
{'batch_size': 64,
 'class_ratio': [0.3, 0.2, 0.2, 0.3],
 'epoch': [3, 1],
 'gamma': 0.1,
 'learning_rate': 0.0001,
 'loss_cls_weight': tensor([1.0060, 1.0797, 1.0402, 1.2753]),
 'optimizer': 'SGD',
 'step_size': 10,
 'transforms': [1,
                Compose(
    ColorJitter(brightness=None, contrast=None, saturation=[0.95, 1.05], hue=[-0.05, 0.05])
    RandomHorizontalFlip(p=0.5)
    RandomRotation(degrees=(-20, 20), resample=2, expand=False)
    ToTensor()
    Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])
)],
 'weight_decay': 0.001}
Dataloader constructed!
Epoch: 0, batch loss: 0.76235 Loss Sum: 261.83366, accuracy : 0.59713, val loss: 18.47761, val accuracy: 0.69885
Final : 0.7800345918213126 [('val/ResNet50/monotone/f1-score', 0.8012618296529967), ('val/ResNet50/screenshot/f1-score', 0.7782426778242678), ('val/ResNet50/unknown/f1-score', 0.7611181702668361)]
Epoch: 1, batch loss: 0.63906 Loss Sum: 176.82965, accuracy : 0.79948, val loss: 16.97485, val accuracy: 0.68199
Final : 0.7832860349720674 [('val/ResNet50/monotone/f1-score', 0.8126984126984128), ('val/ResNet50/screenshot/f1-score', 0.8023715415019763), ('val/ResNet50/unknown/f1-score', 0.7369808833223467)]
Epoch: 2, batch loss: 0.53288 Loss Sum: 147.11319, accuracy : 0.83575, val loss: 15.67301, val accuracy: 0.69962
Final : 0.8031020064131708 [('val/ResNet50/monotone/f1-score', 0.8220064724919094), ('val/ResNet50/screenshot/f1-score', 0.8360000000000001), ('val/ResNet50/unknown/f1-score', 0.7537557152188112)]
Epoch: 3, batch loss: 0.37273 Loss Sum: 112.00797, accuracy : 0.86812, val loss: 13.90972, val accuracy: 0.73946
Final : 0.8335472894744829 [('val/ResNet50/monotone/f1-score', 0.8571428571428571), ('val/ResNet50/screenshot/f1-score', 0.8598484848484849), ('val/ResNet50/unknown/f1-score', 0.7858064516129033)]
---train finished---
Trying to save to /tmp/tmpr07p2f_n/model
Too long checkpoint name: ResNet50_64_[0.3, 0.2, 0.2, 0.3]_[3, 1]_1.0_0.01_[1.00600004196167, 1.079699993133545, 1.0401999950408936, 1.2753000259399414]_SGD_10_1_100.0 not saved
Done
ResNet50 Loaded!
{'batch_size': 64,
 'class_ratio': [0.3, 0.2, 0.2, 0.3],
 'epoch': [3, 1],
 'gamma': 0.1,
 'learning_rate': 0.0001,
 'loss_cls_weight': tensor([1.0060, 1.0797, 1.0402, 1.2753]),
 'optimizer': 'SGD',
 'step_size': 10,
 'transforms': [2,
                Compose(
    RandomAffine(degrees=(0, 0), scale=(0.75, 1.25))
    RandomPerspective(p=0.4)
    RandomHorizontalFlip(p=0.5)
    ToTensor()
    Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])
)],
 'weight_decay': 0}
Dataloader constructed!
Epoch: 0, batch loss: 0.79349 Loss Sum: 265.14340, accuracy : 0.58684, val loss: 19.61830, val accuracy: 0.64674
Final : 0.7669294931875937 [('val/ResNet50/monotone/f1-score', 0.8127208480565371), ('val/ResNet50/screenshot/f1-score', 0.7708333333333333), ('val/ResNet50/unknown/f1-score', 0.7200529450694904)]
Epoch: 1, batch loss: 0.64438 Loss Sum: 186.25376, accuracy : 0.78731, val loss: 17.50854, val accuracy: 0.68046
Final : 0.7914543278542365 [('val/ResNet50/monotone/f1-score', 0.8116883116883116), ('val/ResNet50/screenshot/f1-score', 0.8310679611650484), ('val/ResNet50/unknown/f1-score', 0.7349397590361446)]
Epoch: 2, batch loss: 0.49949 Loss Sum: 156.09079, accuracy : 0.81792, val loss: 16.61919, val accuracy: 0.68736
Final : 0.7951999351543291 [('val/ResNet50/monotone/f1-score', 0.8169934640522876), ('val/ResNet50/screenshot/f1-score', 0.8294573643410853), ('val/ResNet50/unknown/f1-score', 0.7420212765957448)]
Epoch: 3, batch loss: 0.32828 Loss Sum: 118.40047, accuracy : 0.85662, val loss: 15.49780, val accuracy: 0.69272
Final : 0.8226391919766635 [('val/ResNet50/monotone/f1-score', 0.8657718120805369), ('val/ResNet50/screenshot/f1-score', 0.8725868725868725), ('val/ResNet50/unknown/f1-score', 0.7369127516778524)]
---train finished---
Trying to save to /tmp/tmpyu_oh9il/model
Too long checkpoint name: ResNet50_64_[0.3, 0.2, 0.2, 0.3]_[3, 1]_1.0_0.01_[1.00600004196167, 1.079699993133545, 1.0401999950408936, 1.2753000259399414]_SGD_10_2_0 not saved
Done
ResNet50 Loaded!
{'batch_size': 64,
 'class_ratio': [0.3, 0.2, 0.2, 0.3],
 'epoch': [3, 1],
 'gamma': 0.1,
 'learning_rate': 0.0001,
 'loss_cls_weight': tensor([1.0060, 1.0797, 1.0402, 1.2753]),
 'optimizer': 'SGD',
 'step_size': 10,
 'transforms': [2,
                Compose(
    RandomAffine(degrees=(0, 0), scale=(0.75, 1.25))
    RandomPerspective(p=0.4)
    RandomHorizontalFlip(p=0.5)
    ToTensor()
    Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])
)],
 'weight_decay': 0.001}
Dataloader constructed!
Epoch: 0, batch loss: 1.29409 Loss Sum: 332.18803, accuracy : 0.34707, val loss: 24.01262, val accuracy: 0.58391
Final : 0.0 [('val/ResNet50/monotone/f1-score', 0.0), ('val/ResNet50/screenshot/f1-score', 0.3018867924528302), ('val/ResNet50/unknown/f1-score', 0.7460815047021944)]
Epoch: 1, batch loss: 1.18800 Loss Sum: 310.26594, accuracy : 0.40007, val loss: 23.30457, val accuracy: 0.58927
Final : 0.4468259123187205 [('val/ResNet50/monotone/f1-score', 0.24489795918367346), ('val/ResNet50/screenshot/f1-score', 0.5013623978201635), ('val/ResNet50/unknown/f1-score', 0.7265711135611908)]
Epoch: 2, batch loss: 1.11272 Loss Sum: 291.94094, accuracy : 0.48905, val loss: 21.95515, val accuracy: 0.68659
Final : 0.6550199376276288 [('val/ResNet50/monotone/f1-score', 0.5837837837837838), ('val/ResNet50/screenshot/f1-score', 0.61139896373057), ('val/ResNet50/unknown/f1-score', 0.787384448069603)]
Epoch: 3, batch loss: 1.01045 Loss Sum: 268.23545, accuracy : 0.61678, val loss: 20.94251, val accuracy: 0.70345
Final : 0.7838490661453041 [('val/ResNet50/monotone/f1-score', 0.8429752066115702), ('val/ResNet50/screenshot/f1-score', 0.7318181818181818), ('val/ResNet50/unknown/f1-score', 0.7806912991656735)]
---train finished---
Trying to save to /tmp/tmpl2n0t5ft/model
Too long checkpoint name: ResNet50_64_[0.3, 0.2, 0.2, 0.3]_[3, 1]_1.0_0.01_[1.00600004196167, 1.079699993133545, 1.0401999950408936, 1.2753000259399414]_SGD_10_2_100.0 not saved
Done
ResNet50 Loaded!
{'batch_size': 64,
 'class_ratio': [0.3, 0.2, 0.2, 0.3],
 'epoch': [3, 1],
 'gamma': 0.1,
 'learning_rate': 0.0001,
 'loss_cls_weight': tensor([1.0060, 1.0797, 1.0402, 1.2753]),
 'optimizer': 'SGD',
 'step_size': 2,
 'transforms': [1,
                Compose(
    ColorJitter(brightness=None, contrast=None, saturation=[0.95, 1.05], hue=[-0.05, 0.05])
/opt/conda/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1221: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
    RandomHorizontalFlip(p=0.5)
    RandomRotation(degrees=(-20, 20), resample=2, expand=False)
    ToTensor()
    Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])
)],
 'weight_decay': 0}
Dataloader constructed!
Epoch: 0, batch loss: 1.16494 Loss Sum: 328.14228, accuracy : 0.33867, val loss: 23.06998, val accuracy: 0.63602
Final : 0.4682634688516767 [('val/ResNet50/monotone/f1-score', 0.6170212765957448), ('val/ResNet50/screenshot/f1-score', 0.21621621621621623), ('val/ResNet50/unknown/f1-score', 0.7696307852314093)]
Epoch: 1, batch loss: 1.06243 Loss Sum: 279.35932, accuracy : 0.55873, val loss: 21.87802, val accuracy: 0.67969
Final : 0.7589528673905843 [('val/ResNet50/monotone/f1-score', 0.8507462686567164), ('val/ResNet50/screenshot/f1-score', 0.6731234866828087), ('val/ResNet50/unknown/f1-score', 0.7633955448524984)]
Epoch: 2, batch loss: 1.02042 Loss Sum: 259.66296, accuracy : 0.68427, val loss: 21.37571, val accuracy: 0.71724
Final : 0.7854501748029924 [('val/ResNet50/monotone/f1-score', 0.9029850746268657), ('val/ResNet50/screenshot/f1-score', 0.6747572815533982), ('val/ResNet50/unknown/f1-score', 0.7952941176470588)]
Epoch: 3, batch loss: 0.98673 Loss Sum: 255.20315, accuracy : 0.68975, val loss: 21.07333, val accuracy: 0.70575
Final : 0.7787531622722802 [('val/ResNet50/monotone/f1-score', 0.8666666666666666), ('val/ResNet50/screenshot/f1-score', 0.6985645933014354), ('val/ResNet50/unknown/f1-score', 0.7800829875518672)]
---train finished---
Trying to save to /tmp/tmpnr72y9hu/model
Too long checkpoint name: ResNet50_64_[0.3, 0.2, 0.2, 0.3]_[3, 1]_1.0_0.01_[1.00600004196167, 1.079699993133545, 1.0401999950408936, 1.2753000259399414]_SGD_2_1_0 not saved
Done
ResNet50 Loaded!
{'batch_size': 64,
 'class_ratio': [0.3, 0.2, 0.2, 0.3],
 'epoch': [3, 1],
 'gamma': 0.1,
 'learning_rate': 0.0001,
 'loss_cls_weight': tensor([1.0060, 1.0797, 1.0402, 1.2753]),
 'optimizer': 'SGD',
 'step_size': 2,
 'transforms': [1,
                Compose(
    ColorJitter(brightness=None, contrast=None, saturation=[0.95, 1.05], hue=[-0.05, 0.05])
    RandomHorizontalFlip(p=0.5)
    RandomRotation(degrees=(-20, 20), resample=2, expand=False)
    ToTensor()
    Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])
)],
 'weight_decay': 0.001}
Dataloader constructed!
Epoch: 0, batch loss: 1.28349 Loss Sum: 344.01060, accuracy : 0.28840, val loss: 24.83056, val accuracy: 0.52337
Final : 0.1894950901738473 [('val/ResNet50/monotone/f1-score', 0.19310344827586207), ('val/ResNet50/screenshot/f1-score', 0.0498220640569395), ('val/ResNet50/unknown/f1-score', 0.7072649572649572)]
Epoch: 1, batch loss: 1.10491 Loss Sum: 313.12485, accuracy : 0.38401, val loss: 23.30744, val accuracy: 0.57548
Final : 0.43821832000753597 [('val/ResNet50/monotone/f1-score', 0.5310734463276836), ('val/ResNet50/screenshot/f1-score', 0.2191780821917808), ('val/ResNet50/unknown/f1-score', 0.7229693383539538)]
Epoch: 2, batch loss: 1.16511 Loss Sum: 299.37003, accuracy : 0.45539, val loss: 23.17243, val accuracy: 0.60460
Final : 0.5231870584739363 [('val/ResNet50/monotone/f1-score', 0.6387434554973822), ('val/ResNet50/screenshot/f1-score', 0.3042071197411004), ('val/ResNet50/unknown/f1-score', 0.737012987012987)]
Epoch: 3, batch loss: 1.17172 Loss Sum: 296.65787, accuracy : 0.48101, val loss: 23.02689, val accuracy: 0.61533
Final : 0.5808792718161383 [('val/ResNet50/monotone/f1-score', 0.7254901960784313), ('val/ResNet50/screenshot/f1-score', 0.3653250773993808), ('val/ResNet50/unknown/f1-score', 0.739514348785872)]
---train finished---
Trying to save to /tmp/tmp4x88chgf/model
Too long checkpoint name: ResNet50_64_[0.3, 0.2, 0.2, 0.3]_[3, 1]_1.0_0.01_[1.00600004196167, 1.079699993133545, 1.0401999950408936, 1.2753000259399414]_SGD_2_1_100.0 not saved
Done
ResNet50 Loaded!
{'batch_size': 64,
 'class_ratio': [0.3, 0.2, 0.2, 0.3],
 'epoch': [3, 1],
 'gamma': 0.1,
 'learning_rate': 0.0001,
 'loss_cls_weight': tensor([1.0060, 1.0797, 1.0402, 1.2753]),
 'optimizer': 'SGD',
 'step_size': 2,
 'transforms': [2,
                Compose(
    RandomAffine(degrees=(0, 0), scale=(0.75, 1.25))
    RandomPerspective(p=0.4)
    RandomHorizontalFlip(p=0.5)
    ToTensor()
    Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])
)],
 'weight_decay': 0}
Dataloader constructed!
Epoch: 0, batch loss: 1.27352 Loss Sum: 342.47095, accuracy : 0.29035, val loss: 24.29729, val accuracy: 0.54176
Final : 0.1850525706452957 [('val/ResNet50/monotone/f1-score', 0.13043478260869565), ('val/ResNet50/screenshot/f1-score', 0.06716417910447761), ('val/ResNet50/unknown/f1-score', 0.7233595800524936)]
Epoch: 1, batch loss: 1.28089 Loss Sum: 318.57902, accuracy : 0.35157, val loss: 23.63421, val accuracy: 0.56322
Final : 0.43022841628307285 [('val/ResNet50/monotone/f1-score', 0.4146341463414634), ('val/ResNet50/screenshot/f1-score', 0.2645161290322581), ('val/ResNet50/unknown/f1-score', 0.7260726072607262)]
Epoch: 2, batch loss: 1.20327 Loss Sum: 307.05206, accuracy : 0.40993, val loss: 23.38960, val accuracy: 0.57088
Final : 0.44327030104349985 [('val/ResNet50/monotone/f1-score', 0.44970414201183434), ('val/ResNet50/screenshot/f1-score', 0.2662337662337662), ('val/ResNet50/unknown/f1-score', 0.7274713271436374)]
Epoch: 3, batch loss: 1.17456 Loss Sum: 304.14933, accuracy : 0.41827, val loss: 23.13108, val accuracy: 0.60077
Final : 0.49640108159123647 [('val/ResNet50/monotone/f1-score', 0.4651162790697675), ('val/ResNet50/screenshot/f1-score', 0.3510971786833855), ('val/ResNet50/unknown/f1-score', 0.7490473598258031)]
---train finished---
Trying to save to /tmp/tmpa4wk__d7/model
Too long checkpoint name: ResNet50_64_[0.3, 0.2, 0.2, 0.3]_[3, 1]_1.0_0.01_[1.00600004196167, 1.079699993133545, 1.0401999950408936, 1.2753000259399414]_SGD_2_2_0 not saved
Done
ResNet50 Loaded!
{'batch_size': 64,
 'class_ratio': [0.3, 0.2, 0.2, 0.3],
 'epoch': [3, 1],
 'gamma': 0.1,
 'learning_rate': 0.0001,
 'loss_cls_weight': tensor([1.0060, 1.0797, 1.0402, 1.2753]),
 'optimizer': 'SGD',
 'step_size': 2,
 'transforms': [2,
                Compose(
    RandomAffine(degrees=(0, 0), scale=(0.75, 1.25))
    RandomPerspective(p=0.4)
    RandomHorizontalFlip(p=0.5)
    ToTensor()
    Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])
)],
 'weight_decay': 0.001}
Dataloader constructed!
Epoch: 0, batch loss: 1.33384 Loss Sum: 333.17172, accuracy : 0.33727, val loss: 24.20648, val accuracy: 0.55172
Final : 0.11620970472361128 [('val/ResNet50/monotone/f1-score', 0.030534351145038167), ('val/ResNet50/screenshot/f1-score', 0.0684931506849315), ('val/ResNet50/unknown/f1-score', 0.7503974562798092)]
Epoch: 1, batch loss: 1.17376 Loss Sum: 310.41473, accuracy : 0.39502, val loss: 23.06919, val accuracy: 0.59847
Final : 0.4494341847222921 [('val/ResNet50/monotone/f1-score', 0.4121212121212121), ('val/ResNet50/screenshot/f1-score', 0.2911392405063291), ('val/ResNet50/unknown/f1-score', 0.7566109012412304)]
Epoch: 2, batch loss: 1.18320 Loss Sum: 299.87956, accuracy : 0.45162, val loss: 22.99811, val accuracy: 0.60000
Final : 0.49400646534152304 [('val/ResNet50/monotone/f1-score', 0.4883720930232558), ('val/ResNet50/screenshot/f1-score', 0.3261538461538461), ('val/ResNet50/unknown/f1-score', 0.7568756875687569)]
Epoch: 3, batch loss: 1.20249 Loss Sum: 296.53335, accuracy : 0.47341, val loss: 22.92617, val accuracy: 0.62069
Final : 0.5424143485969882 [('val/ResNet50/monotone/f1-score', 0.5227272727272728), ('val/ResNet50/screenshot/f1-score', 0.3988095238095239), ('val/ResNet50/unknown/f1-score', 0.7655134541460735)]
---train finished---
Trying to save to /tmp/tmpw_d1opz9/model
Too long checkpoint name: ResNet50_64_[0.3, 0.2, 0.2, 0.3]_[3, 1]_1.0_0.01_[1.00600004196167, 1.079699993133545, 1.0401999950408936, 1.2753000259399414]_SGD_2_2_100.0 not saved
Done
ResNet50 Loaded!
{'batch_size': 64,
 'class_ratio': [0.3, 0.2, 0.2, 0.3],
 'epoch': [3, 1],
 'gamma': 0.1,
 'learning_rate': 1e-06,
 'loss_cls_weight': tensor([1., 1., 1., 1.]),
 'optimizer': 'Adamax',
 'step_size': 10,
 'transforms': [1,
                Compose(
    ColorJitter(brightness=None, contrast=None, saturation=[0.95, 1.05], hue=[-0.05, 0.05])
    RandomHorizontalFlip(p=0.5)
    RandomRotation(degrees=(-20, 20), resample=2, expand=False)
    ToTensor()
    Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])
)],
 'weight_decay': 0}
Dataloader constructed!
Epoch: 0, batch loss: 1.57259 Loss Sum: 384.74002, accuracy : 0.27507, val loss: 37.35698, val accuracy: 0.04828
Final : 0.022301782908927655 [('val/ResNet50/monotone/f1-score', 0.1532258064516129), ('val/ResNet50/screenshot/f1-score', 0.03344481605351171), ('val/ResNet50/unknown/f1-score', 0.0021645021645021645)]
Epoch: 1, batch loss: 1.51330 Loss Sum: 372.67969, accuracy : 0.31652, val loss: 35.35571, val accuracy: 0.05211
Final : 0.050110206260227864 [('val/ResNet50/monotone/f1-score', 0.20610687022900764), ('val/ResNet50/screenshot/f1-score', 0.05714285714285715), ('val/ResNet50/unknown/f1-score', 0.010683760683760682)]
Epoch: 2, batch loss: 1.39672 Loss Sum: 363.28239, accuracy : 0.33751, val loss: 33.71983, val accuracy: 0.04981
Final : 0.08548921302931854 [('val/ResNet50/monotone/f1-score', 0.18823529411764708), ('val/ResNet50/screenshot/f1-score', 0.1090909090909091), ('val/ResNet50/unknown/f1-score', 0.030425963488843813)]
Epoch: 3, batch loss: 1.13677 Loss Sum: 312.96093, accuracy : 0.55380, val loss: 28.17567, val accuracy: 0.25287
Final : 0.2874025579984144 [('val/ResNet50/monotone/f1-score', 0.6375321336760926), ('val/ResNet50/screenshot/f1-score', 0.7338709677419354), ('val/ResNet50/unknown/f1-score', 0.0507399577167019)]
---train finished---
Trying to save to /tmp/tmpnw1zdm70/model
Too long checkpoint name: ResNet50_64_[0.3, 0.2, 0.2, 0.3]_[3, 1]_1.0_9.999999999999999e-05_[1.0, 1.0, 1.0, 1.0]_Adamax_10_1_0 not saved
Done
ResNet50 Loaded!
{'batch_size': 64,
 'class_ratio': [0.3, 0.2, 0.2, 0.3],
 'epoch': [3, 1],
 'gamma': 0.1,
 'learning_rate': 1e-06,
 'loss_cls_weight': tensor([1., 1., 1., 1.]),
 'optimizer': 'Adamax',
 'step_size': 10,
 'transforms': [1,
                Compose(
    ColorJitter(brightness=None, contrast=None, saturation=[0.95, 1.05], hue=[-0.05, 0.05])
    RandomHorizontalFlip(p=0.5)
    RandomRotation(degrees=(-20, 20), resample=2, expand=False)
    ToTensor()
    Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])
)],
 'weight_decay': 0.001}
Dataloader constructed!
Epoch: 0, batch loss: 1.43102 Loss Sum: 353.69352, accuracy : 0.26083, val loss: 26.28458, val accuracy: 0.51724
Final : 0.10183389007831678 [('val/ResNet50/monotone/f1-score', 0.06711409395973154), ('val/ResNet50/screenshot/f1-score', 0.022304832713754646), ('val/ResNet50/unknown/f1-score', 0.7054468535166578)]
Epoch: 1, batch loss: 1.37513 Loss Sum: 349.89265, accuracy : 0.25998, val loss: 26.33988, val accuracy: 0.48889
Final : 0.10325764023812174 [('val/ResNet50/monotone/f1-score', 0.0425531914893617), ('val/ResNet50/screenshot/f1-score', 0.037453183520599245), ('val/ResNet50/unknown/f1-score', 0.6907894736842105)]
Epoch: 2, batch loss: 1.31338 Loss Sum: 345.98007, accuracy : 0.26424, val loss: 26.49059, val accuracy: 0.44291
Final : 0.0752740947672356 [('val/ResNet50/monotone/f1-score', 0.014705882352941175), ('val/ResNet50/screenshot/f1-score', 0.04444444444444444), ('val/ResNet50/unknown/f1-score', 0.6525714285714286)]
Epoch: 3, batch loss: 1.07582 Loss Sum: 303.40802, accuracy : 0.48972, val loss: 23.07673, val accuracy: 0.57088
Final : 0.7118935865071947 [('val/ResNet50/monotone/f1-score', 0.8294314381270903), ('val/ResNet50/screenshot/f1-score', 0.6761229314420804), ('val/ResNet50/unknown/f1-score', 0.6433378196500673)]
---train finished---
Trying to save to /tmp/tmptc5ql790/model
Too long checkpoint name: ResNet50_64_[0.3, 0.2, 0.2, 0.3]_[3, 1]_1.0_9.999999999999999e-05_[1.0, 1.0, 1.0, 1.0]_Adamax_10_1_100.0 not saved
Done
ResNet50 Loaded!
{'batch_size': 64,
 'class_ratio': [0.3, 0.2, 0.2, 0.3],
 'epoch': [3, 1],
 'gamma': 0.1,
 'learning_rate': 1e-06,
 'loss_cls_weight': tensor([1., 1., 1., 1.]),
 'optimizer': 'Adamax',
 'step_size': 10,
 'transforms': [2,
                Compose(
    RandomAffine(degrees=(0, 0), scale=(0.75, 1.25))
    RandomPerspective(p=0.4)
    RandomHorizontalFlip(p=0.5)
    ToTensor()
    Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])
)],
 'weight_decay': 0}
Dataloader constructed!
Epoch: 0, batch loss: 1.44271 Loss Sum: 359.41884, accuracy : 0.28712, val loss: 24.73987, val accuracy: 0.56169
Final : 0.29342344081726707 [('val/ResNet50/monotone/f1-score', 0.26519337016574585), ('val/ResNet50/screenshot/f1-score', 0.13190730837789663), ('val/ResNet50/unknown/f1-score', 0.722192369693713)]
Epoch: 1, batch loss: 1.29318 Loss Sum: 352.01770, accuracy : 0.29668, val loss: 24.98134, val accuracy: 0.58161
Final : 0.29484706347346556 [('val/ResNet50/monotone/f1-score', 0.3068181818181818), ('val/ResNet50/screenshot/f1-score', 0.11267605633802817), ('val/ResNet50/unknown/f1-score', 0.7414428646656135)]
Epoch: 2, batch loss: 1.40731 Loss Sum: 346.41523, accuracy : 0.30824, val loss: 25.19770, val accuracy: 0.57011
Final : 0.25764065694446014 [('val/ResNet50/monotone/f1-score', 0.2976190476190476), ('val/ResNet50/screenshot/f1-score', 0.07780320366132724), ('val/ResNet50/unknown/f1-score', 0.7385586533403472)]
Epoch: 3, batch loss: 1.06200 Loss Sum: 306.11743, accuracy : 0.49805, val loss: 22.49944, val accuracy: 0.70575
Final : 0.7604197771671856 [('val/ResNet50/monotone/f1-score', 0.8513513513513513), ('val/ResNet50/screenshot/f1-score', 0.6693711967545638), ('val/ResNet50/unknown/f1-score', 0.7715860379669321)]
---train finished---
Trying to save to /tmp/tmpq0l6xox9/model
Too long checkpoint name: ResNet50_64_[0.3, 0.2, 0.2, 0.3]_[3, 1]_1.0_9.999999999999999e-05_[1.0, 1.0, 1.0, 1.0]_Adamax_10_2_0 not saved
Done
ResNet50 Loaded!
{'batch_size': 64,
 'class_ratio': [0.3, 0.2, 0.2, 0.3],
 'epoch': [3, 1],
 'gamma': 0.1,
 'learning_rate': 1e-06,
 'loss_cls_weight': tensor([1., 1., 1., 1.]),
 'optimizer': 'Adamax',
 'step_size': 10,
 'transforms': [2,
                Compose(
    RandomAffine(degrees=(0, 0), scale=(0.75, 1.25))
    RandomPerspective(p=0.4)
    RandomHorizontalFlip(p=0.5)
    ToTensor()
    Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])
)],
 'weight_decay': 0.001}
Dataloader constructed!
Epoch: 0, batch loss: 1.39324 Loss Sum: 354.05580, accuracy : 0.28962, val loss: 28.50200, val accuracy: 0.35862
Final : 0.17808488859484897 [('val/ResNet50/monotone/f1-score', 0.25196850393700787), ('val/ResNet50/screenshot/f1-score', 0.03883495145631068), ('val/ResNet50/unknown/f1-score', 0.5771812080536913)]
Epoch: 1, batch loss: 1.39075 Loss Sum: 349.34137, accuracy : 0.30088, val loss: 27.89295, val accuracy: 0.36782
Final : 0.14922907275373187 [('val/ResNet50/monotone/f1-score', 0.1758241758241758), ('val/ResNet50/screenshot/f1-score', 0.03164556962025316), ('val/ResNet50/unknown/f1-score', 0.597267404033832)]
Epoch: 2, batch loss: 1.37335 Loss Sum: 345.20881, accuracy : 0.30757, val loss: 27.59926, val accuracy: 0.36935
Final : 0.1775748054541328 [('val/ResNet50/monotone/f1-score', 0.2484472049689441), ('val/ResNet50/screenshot/f1-score', 0.03773584905660377), ('val/ResNet50/unknown/f1-score', 0.5972495088408645)]
Epoch: 3, batch loss: 1.07258 Loss Sum: 309.00995, accuracy : 0.50639, val loss: 24.33258, val accuracy: 0.52797
Final : 0.6982124351894538 [('val/ResNet50/monotone/f1-score', 0.8307692307692307), ('val/ResNet50/screenshot/f1-score', 0.6710526315789473), ('val/ResNet50/unknown/f1-score', 0.6105563480741797)]
---train finished---
Trying to save to /tmp/tmp_t28n3td/model
Too long checkpoint name: ResNet50_64_[0.3, 0.2, 0.2, 0.3]_[3, 1]_1.0_9.999999999999999e-05_[1.0, 1.0, 1.0, 1.0]_Adamax_10_2_100.0 not saved
Done
ResNet50 Loaded!
{'batch_size': 64,
 'class_ratio': [0.3, 0.2, 0.2, 0.3],
 'epoch': [3, 1],
 'gamma': 0.1,
 'learning_rate': 1e-06,
 'loss_cls_weight': tensor([1., 1., 1., 1.]),
 'optimizer': 'Adamax',
 'step_size': 2,
 'transforms': [1,
                Compose(
    ColorJitter(brightness=None, contrast=None, saturation=[0.95, 1.05], hue=[-0.05, 0.05])
    RandomHorizontalFlip(p=0.5)
    RandomRotation(degrees=(-20, 20), resample=2, expand=False)
    ToTensor()
    Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])
)],
 'weight_decay': 0}
Dataloader constructed!
Epoch: 0, batch loss: 1.55322 Loss Sum: 377.43756, accuracy : 0.28438, val loss: 24.02748, val accuracy: 0.60613
Final : 0.2368751514639653 [('val/ResNet50/monotone/f1-score', 0.13333333333333333), ('val/ResNet50/screenshot/f1-score', 0.13129102844638948), ('val/ResNet50/unknown/f1-score', 0.759249873289407)]
Epoch: 1, batch loss: 1.34121 Loss Sum: 368.42958, accuracy : 0.29059, val loss: 24.31495, val accuracy: 0.62375
Final : 0.2508738397726506 [('val/ResNet50/monotone/f1-score', 0.1871345029239766), ('val/ResNet50/screenshot/f1-score', 0.10952380952380954), ('val/ResNet50/unknown/f1-score', 0.7703777335984096)]
Epoch: 2, batch loss: 1.41900 Loss Sum: 363.78102, accuracy : 0.29522, val loss: 24.39989, val accuracy: 0.60307
Final : 0.22455043626656201 [('val/ResNet50/monotone/f1-score', 0.17341040462427745), ('val/ResNet50/screenshot/f1-score', 0.08636363636363635), ('val/ResNet50/unknown/f1-score', 0.7560240963855422)]
Epoch: 3, batch loss: 1.39652 Loss Sum: 358.04493, accuracy : 0.31262, val loss: 23.96683, val accuracy: 0.63985
Final : 0.3166836486887122 [('val/ResNet50/monotone/f1-score', 0.3212435233160622), ('val/ResNet50/screenshot/f1-score', 0.1271393643031785), ('val/ResNet50/unknown/f1-score', 0.7776111944027987)]
---train finished---
Trying to save to /tmp/tmptpg3ms7x/model
Too long checkpoint name: ResNet50_64_[0.3, 0.2, 0.2, 0.3]_[3, 1]_1.0_9.999999999999999e-05_[1.0, 1.0, 1.0, 1.0]_Adamax_2_1_0 not saved
Done
ResNet50 Loaded!
{'batch_size': 64,
 'class_ratio': [0.3, 0.2, 0.2, 0.3],
 'epoch': [3, 1],
 'gamma': 0.1,
 'learning_rate': 1e-06,
 'loss_cls_weight': tensor([1., 1., 1., 1.]),
 'optimizer': 'Adamax',
 'step_size': 2,
 'transforms': [1,
                Compose(
    ColorJitter(brightness=None, contrast=None, saturation=[0.95, 1.05], hue=[-0.05, 0.05])
    RandomHorizontalFlip(p=0.5)
    RandomRotation(degrees=(-20, 20), resample=2, expand=False)
    ToTensor()
    Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])
)],
 'weight_decay': 0.001}
Dataloader constructed!
Epoch: 0, batch loss: 1.44045 Loss Sum: 364.27943, accuracy : 0.23089, val loss: 30.09613, val accuracy: 0.20153
Final : 0.1832574824527436 [('val/ResNet50/monotone/f1-score', 0.09375), ('val/ResNet50/screenshot/f1-score', 0.28316326530612246), ('val/ResNet50/unknown/f1-score', 0.23183391003460208)]
Epoch: 1, batch loss: 1.38573 Loss Sum: 356.05888, accuracy : 0.28597, val loss: 29.17779, val accuracy: 0.26437
Final : 0.2518769140347852 [('val/ResNet50/monotone/f1-score', 0.1507936507936508), ('val/ResNet50/screenshot/f1-score', 0.297029702970297), ('val/ResNet50/unknown/f1-score', 0.3567649281934996)]
Epoch: 2, batch loss: 1.35763 Loss Sum: 352.35885, accuracy : 0.30568, val loss: 29.26054, val accuracy: 0.22912
Final : 0.18513278745751569 [('val/ResNet50/monotone/f1-score', 0.0823045267489712), ('val/ResNet50/screenshot/f1-score', 0.2339373970345964), ('val/ResNet50/unknown/f1-score', 0.32955404383975817)]
Epoch: 3, batch loss: 1.36242 Loss Sum: 347.13572, accuracy : 0.34275, val loss: 28.73751, val accuracy: 0.29962
Final : 0.34878145744053796 [('val/ResNet50/monotone/f1-score', 0.30400000000000005), ('val/ResNet50/screenshot/f1-score', 0.3794871794871795), ('val/ResNet50/unknown/f1-score', 0.3677811550151976)]
---train finished---
Trying to save to /tmp/tmpbv5asgdy/model
Too long checkpoint name: ResNet50_64_[0.3, 0.2, 0.2, 0.3]_[3, 1]_1.0_9.999999999999999e-05_[1.0, 1.0, 1.0, 1.0]_Adamax_2_1_100.0 not saved
Done
ResNet50 Loaded!
{'batch_size': 64,
 'class_ratio': [0.3, 0.2, 0.2, 0.3],
 'epoch': [3, 1],
 'gamma': 0.1,
 'learning_rate': 1e-06,
 'loss_cls_weight': tensor([1., 1., 1., 1.]),
 'optimizer': 'Adamax',
 'step_size': 2,
 'transforms': [2,
                Compose(
    RandomAffine(degrees=(0, 0), scale=(0.75, 1.25))
    RandomPerspective(p=0.4)
    RandomHorizontalFlip(p=0.5)
    ToTensor()
    Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])
)],
 'weight_decay': 0}
Dataloader constructed!
Epoch: 0, batch loss: 1.45642 Loss Sum: 373.43790, accuracy : 0.18774, val loss: 28.18032, val accuracy: 0.27586
Final : 0.1395219618383034 [('val/ResNet50/monotone/f1-score', 0.13997879109225875), ('val/ResNet50/screenshot/f1-score', 0.044585987261146494), ('val/ResNet50/unknown/f1-score', 0.43517816527672476)]
Epoch: 1, batch loss: 1.33944 Loss Sum: 362.58511, accuracy : 0.24629, val loss: 27.44754, val accuracy: 0.41839
Final : 0.24542668007693114 [('val/ResNet50/monotone/f1-score', 0.1941747572815534), ('val/ResNet50/screenshot/f1-score', 0.1268882175226586), ('val/ResNet50/unknown/f1-score', 0.6)]
Epoch: 2, batch loss: 1.37668 Loss Sum: 358.23856, accuracy : 0.27848, val loss: 27.51815, val accuracy: 0.43831
Final : 0.21443301931687073 [('val/ResNet50/monotone/f1-score', 0.19298245614035087), ('val/ResNet50/screenshot/f1-score', 0.08150470219435736), ('val/ResNet50/unknown/f1-score', 0.626865671641791)]
Epoch: 3, batch loss: 1.31172 Loss Sum: 352.49503, accuracy : 0.30532, val loss: 27.12493, val accuracy: 0.45824
Final : 0.3061395955037117 [('val/ResNet50/monotone/f1-score', 0.24390243902439024), ('val/ResNet50/screenshot/f1-score', 0.18857142857142858), ('val/ResNet50/unknown/f1-score', 0.6238303181534622)]
---train finished---
Trying to save to /tmp/tmplny328f4/model
Too long checkpoint name: ResNet50_64_[0.3, 0.2, 0.2, 0.3]_[3, 1]_1.0_9.999999999999999e-05_[1.0, 1.0, 1.0, 1.0]_Adamax_2_2_0 not saved
Done
ResNet50 Loaded!
{'batch_size': 64,
 'class_ratio': [0.3, 0.2, 0.2, 0.3],
 'epoch': [3, 1],
 'gamma': 0.1,
 'learning_rate': 1e-06,
 'loss_cls_weight': tensor([1., 1., 1., 1.]),
 'optimizer': 'Adamax',
 'step_size': 2,
 'transforms': [2,
                Compose(
    RandomAffine(degrees=(0, 0), scale=(0.75, 1.25))
    RandomPerspective(p=0.4)
    RandomHorizontalFlip(p=0.5)
    ToTensor()
    Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])
)],
 'weight_decay': 0.001}
Dataloader constructed!
Epoch: 0, batch loss: 1.37801 Loss Sum: 362.86987, accuracy : 0.26777, val loss: 26.69229, val accuracy: 0.53870
Final : 0.2238662907204966 [('val/ResNet50/monotone/f1-score', 0.26666666666666666), ('val/ResNet50/screenshot/f1-score', 0.059850374064837904), ('val/ResNet50/unknown/f1-score', 0.7029598308668076)]
Epoch: 1, batch loss: 1.37857 Loss Sum: 356.33836, accuracy : 0.27720, val loss: 26.70451, val accuracy: 0.52950
Final : 0.22113180535561797 [('val/ResNet50/monotone/f1-score', 0.24050632911392406), ('val/ResNet50/screenshot/f1-score', 0.064), ('val/ResNet50/unknown/f1-score', 0.7025013304949441)]
Epoch: 2, batch loss: 1.36016 Loss Sum: 353.53340, accuracy : 0.27939, val loss: 26.64743, val accuracy: 0.52261
Final : 0.23846903433970532 [('val/ResNet50/monotone/f1-score', 0.25316455696202533), ('val/ResNet50/screenshot/f1-score', 0.07712082262210797), ('val/ResNet50/unknown/f1-score', 0.6945786366076222)]
Epoch: 3, batch loss: 1.36255 Loss Sum: 349.08616, accuracy : 0.29686, val loss: 26.34423, val accuracy: 0.53103
Final : 0.2703994639183841 [('val/ResNet50/monotone/f1-score', 0.28402366863905326), ('val/ResNet50/screenshot/f1-score', 0.09917355371900827), ('val/ResNet50/unknown/f1-score', 0.7018867924528301)]
---train finished---
Trying to save to /tmp/tmpucs69uo5/model
Too long checkpoint name: ResNet50_64_[0.3, 0.2, 0.2, 0.3]_[3, 1]_1.0_9.999999999999999e-05_[1.0, 1.0, 1.0, 1.0]_Adamax_2_2_100.0 not saved
Done
ResNet50 Loaded!
{'batch_size': 64,
 'class_ratio': [0.3, 0.2, 0.2, 0.3],
 'epoch': [3, 1],
 'gamma': 0.1,
 'learning_rate': 1e-06,
 'loss_cls_weight': tensor([1., 1., 1., 1.]),
 'optimizer': 'Adam',
 'step_size': 10,
 'transforms': [1,
                Compose(
    ColorJitter(brightness=None, contrast=None, saturation=[0.95, 1.05], hue=[-0.05, 0.05])
    RandomHorizontalFlip(p=0.5)
    RandomRotation(degrees=(-20, 20), resample=2, expand=False)
    ToTensor()
    Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])
)],
 'weight_decay': 0}
Dataloader constructed!
Epoch: 0, batch loss: 1.30445 Loss Sum: 354.90984, accuracy : 0.26814, val loss: 25.45917, val accuracy: 0.53487
Final : 0.18685922932188634 [('val/ResNet50/monotone/f1-score', 0.05673758865248227), ('val/ResNet50/screenshot/f1-score', 0.16541353383458646), ('val/ResNet50/unknown/f1-score', 0.6951871657754011)]
Epoch: 1, batch loss: 1.36236 Loss Sum: 344.05381, accuracy : 0.28980, val loss: 25.78513, val accuracy: 0.52337
Final : 0.17219584426780243 [('val/ResNet50/monotone/f1-score', 0.055944055944055944), ('val/ResNet50/screenshot/f1-score', 0.12935323383084577), ('val/ResNet50/unknown/f1-score', 0.7055645596974608)]
Epoch: 2, batch loss: 1.31036 Loss Sum: 336.11465, accuracy : 0.30617, val loss: 26.03311, val accuracy: 0.46590
Final : 0.17820828698301164 [('val/ResNet50/monotone/f1-score', 0.07142857142857142), ('val/ResNet50/screenshot/f1-score', 0.12048192771084337), ('val/ResNet50/unknown/f1-score', 0.6576424139875916)]
Epoch: 3, batch loss: 0.76127 Loss Sum: 253.50737, accuracy : 0.68434, val loss: 19.64248, val accuracy: 0.58084
Final : 0.7277895885484629 [('val/ResNet50/monotone/f1-score', 0.7730061349693252), ('val/ResNet50/screenshot/f1-score', 0.8250460405156538), ('val/ResNet50/unknown/f1-score', 0.6044444444444446)]
---train finished---
Trying to save to /tmp/tmphcoxrxx8/model
Too long checkpoint name: ResNet50_64_[0.3, 0.2, 0.2, 0.3]_[3, 1]_1.0_9.999999999999999e-05_[1.0, 1.0, 1.0, 1.0]_Adam_10_1_0 not saved
Done
ResNet50 Loaded!
{'batch_size': 64,
 'class_ratio': [0.3, 0.2, 0.2, 0.3],
 'epoch': [3, 1],
 'gamma': 0.1,
 'learning_rate': 1e-06,
 'loss_cls_weight': tensor([1., 1., 1., 1.]),
 'optimizer': 'Adam',
 'step_size': 10,
 'transforms': [1,
                Compose(
    ColorJitter(brightness=None, contrast=None, saturation=[0.95, 1.05], hue=[-0.05, 0.05])
    RandomHorizontalFlip(p=0.5)
    RandomRotation(degrees=(-20, 20), resample=2, expand=False)
    ToTensor()
    Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])
)],
 'weight_decay': 0.001}
Dataloader constructed!
Epoch: 0, batch loss: 1.41997 Loss Sum: 376.22505, accuracy : 0.20661, val loss: 29.24705, val accuracy: 0.23218
Final : 0.07943662702129385 [('val/ResNet50/monotone/f1-score', 0.014084507042253521), ('val/ResNet50/screenshot/f1-score', 0.35335195530726254), ('val/ResNet50/unknown/f1-score', 0.10071942446043165)]
Epoch: 1, batch loss: 1.40544 Loss Sum: 356.73214, accuracy : 0.25341, val loss: 27.77402, val accuracy: 0.35096
Final : 0.27072877671169593 [('val/ResNet50/monotone/f1-score', 0.12413793103448276), ('val/ResNet50/screenshot/f1-score', 0.44256120527306964), ('val/ResNet50/unknown/f1-score', 0.36118143459915614)]
Epoch: 2, batch loss: 1.31289 Loss Sum: 344.97652, accuracy : 0.33240, val loss: 26.78777, val accuracy: 0.45364
Final : 0.38238390755943175 [('val/ResNet50/monotone/f1-score', 0.18666666666666668), ('val/ResNet50/screenshot/f1-score', 0.5344827586206896), ('val/ResNet50/unknown/f1-score', 0.5604002859185132)]
Epoch: 3, batch loss: 0.79778 Loss Sum: 259.04529, accuracy : 0.68038, val loss: 20.04000, val accuracy: 0.54406
Final : 0.7054564229359891 [('val/ResNet50/monotone/f1-score', 0.7743902439024389), ('val/ResNet50/screenshot/f1-score', 0.8359788359788359), ('val/ResNet50/unknown/f1-score', 0.5423197492163009)]
---train finished---
Trying to save to /tmp/tmp7g57k1dd/model
Too long checkpoint name: ResNet50_64_[0.3, 0.2, 0.2, 0.3]_[3, 1]_1.0_9.999999999999999e-05_[1.0, 1.0, 1.0, 1.0]_Adam_10_1_100.0 not saved
Done
ResNet50 Loaded!
{'batch_size': 64,
 'class_ratio': [0.3, 0.2, 0.2, 0.3],
 'epoch': [3, 1],
 'gamma': 0.1,
 'learning_rate': 1e-06,
 'loss_cls_weight': tensor([1., 1., 1., 1.]),
 'optimizer': 'Adam',
 'step_size': 10,
 'transforms': [2,
                Compose(
    RandomAffine(degrees=(0, 0), scale=(0.75, 1.25))
    RandomPerspective(p=0.4)
    RandomHorizontalFlip(p=0.5)
    ToTensor()
    Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])
)],
 'weight_decay': 0}
Dataloader constructed!
Epoch: 0, batch loss: 1.35982 Loss Sum: 356.48947, accuracy : 0.28073, val loss: 29.85016, val accuracy: 0.17165
Final : 0.0 [('val/ResNet50/monotone/f1-score', 0.0), ('val/ResNet50/screenshot/f1-score', 0.35775862068965514), ('val/ResNet50/unknown/f1-score', 0.11599999999999999)]
Epoch: 1, batch loss: 1.27388 Loss Sum: 345.32093, accuracy : 0.33806, val loss: 28.37054, val accuracy: 0.21456
Final : 0.11697124135969555 [('val/ResNet50/monotone/f1-score', 0.015384615384615384), ('val/ResNet50/screenshot/f1-score', 0.3274647887323944), ('val/ResNet50/unknown/f1-score', 0.31767719897523483)]
Epoch: 2, batch loss: 1.28898 Loss Sum: 337.40249, accuracy : 0.35492, val loss: 27.42400, val accuracy: 0.27203
Final : 0.19365117016415553 [('val/ResNet50/monotone/f1-score', 0.06015037593984962), ('val/ResNet50/screenshot/f1-score', 0.27601809954751133), ('val/ResNet50/unknown/f1-score', 0.43740573152337864)]
Epoch: 3, batch loss: 0.88792 Loss Sum: 268.24820, accuracy : 0.65232, val loss: 21.40920, val accuracy: 0.52184
Final : 0.7250242692549759 [('val/ResNet50/monotone/f1-score', 0.8842105263157894), ('val/ResNet50/screenshot/f1-score', 0.8243992606284658), ('val/ResNet50/unknown/f1-score', 0.5228346456692913)]
---train finished---
Trying to save to /tmp/tmpp5781l_z/model
Too long checkpoint name: ResNet50_64_[0.3, 0.2, 0.2, 0.3]_[3, 1]_1.0_9.999999999999999e-05_[1.0, 1.0, 1.0, 1.0]_Adam_10_2_0 not saved
Done
ResNet50 Loaded!
{'batch_size': 64,
 'class_ratio': [0.3, 0.2, 0.2, 0.3],
 'epoch': [3, 1],
 'gamma': 0.1,
 'learning_rate': 1e-06,
 'loss_cls_weight': tensor([1., 1., 1., 1.]),
 'optimizer': 'Adam',
 'step_size': 10,
 'transforms': [2,
                Compose(
    RandomAffine(degrees=(0, 0), scale=(0.75, 1.25))
    RandomPerspective(p=0.4)
    RandomHorizontalFlip(p=0.5)
    ToTensor()
    Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])
)],
 'weight_decay': 0.001}
Dataloader constructed!
Epoch: 0, batch loss: 1.42118 Loss Sum: 363.71730, accuracy : 0.27288, val loss: 28.83658, val accuracy: 0.33103
Final : 0.0 [('val/ResNet50/monotone/f1-score', 0.0881057268722467), ('val/ResNet50/screenshot/f1-score', 0.0), ('val/ResNet50/unknown/f1-score', 0.5626666666666668)]
Epoch: 1, batch loss: 1.36034 Loss Sum: 355.11476, accuracy : 0.30009, val loss: 28.18531, val accuracy: 0.34559
Final : 0.0 [('val/ResNet50/monotone/f1-score', 0.03921568627450981), ('val/ResNet50/screenshot/f1-score', 0.0), ('val/ResNet50/unknown/f1-score', 0.5821962313190383)]
Epoch: 2, batch loss: 1.29005 Loss Sum: 348.09400, accuracy : 0.31055, val loss: 27.78448, val accuracy: 0.34483
Final : 0.05650624935286261 [('val/ResNet50/monotone/f1-score', 0.0425531914893617), ('val/ResNet50/screenshot/f1-score', 0.007220216606498195), ('val/ResNet50/unknown/f1-score', 0.5872284397630019)]
Epoch: 3, batch loss: 0.94518 Loss Sum: 274.80576, accuracy : 0.62208, val loss: 21.22173, val accuracy: 0.55862
Final : 0.7306709590743216 [('val/ResNet50/monotone/f1-score', 0.8269230769230769), ('val/ResNet50/screenshot/f1-score', 0.7866108786610878), ('val/ResNet50/unknown/f1-score', 0.5997088791848617)]
---train finished---
Trying to save to /tmp/tmpvz4jzx75/model
Too long checkpoint name: ResNet50_64_[0.3, 0.2, 0.2, 0.3]_[3, 1]_1.0_9.999999999999999e-05_[1.0, 1.0, 1.0, 1.0]_Adam_10_2_100.0 not saved
Done
ResNet50 Loaded!
{'batch_size': 64,
 'class_ratio': [0.3, 0.2, 0.2, 0.3],
 'epoch': [3, 1],
 'gamma': 0.1,
 'learning_rate': 1e-06,
 'loss_cls_weight': tensor([1., 1., 1., 1.]),
 'optimizer': 'Adam',
 'step_size': 2,
 'transforms': [1,
                Compose(
    ColorJitter(brightness=None, contrast=None, saturation=[0.95, 1.05], hue=[-0.05, 0.05])
    RandomHorizontalFlip(p=0.5)
    RandomRotation(degrees=(-20, 20), resample=2, expand=False)
    ToTensor()
    Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])
)],
 'weight_decay': 0}
Dataloader constructed!
Epoch: 0, batch loss: 1.37862 Loss Sum: 361.12149, accuracy : 0.24994, val loss: 29.99830, val accuracy: 0.14176
Final : 0.06395529975523269 [('val/ResNet50/monotone/f1-score', 0.13861386138613863), ('val/ResNet50/screenshot/f1-score', 0.006211180124223603), ('val/ResNet50/unknown/f1-score', 0.3038427167113494)]
Epoch: 1, batch loss: 1.37931 Loss Sum: 351.66373, accuracy : 0.26722, val loss: 28.52954, val accuracy: 0.24521
Final : 0.10870941645452406 [('val/ResNet50/monotone/f1-score', 0.14193548387096774), ('val/ResNet50/screenshot/f1-score', 0.019108280254777073), ('val/ResNet50/unknown/f1-score', 0.4736842105263158)]
Epoch: 2, batch loss: 1.36757 Loss Sum: 347.06490, accuracy : 0.27203, val loss: 28.48101, val accuracy: 0.25747
Final : 0.0800233098413138 [('val/ResNet50/monotone/f1-score', 0.15384615384615385), ('val/ResNet50/screenshot/f1-score', 0.006734006734006734), ('val/ResNet50/unknown/f1-score', 0.49464012251148554)]
Epoch: 3, batch loss: 1.28236 Loss Sum: 337.07728, accuracy : 0.31159, val loss: 27.42776, val accuracy: 0.29195
Final : 0.257688273001958 [('val/ResNet50/monotone/f1-score', 0.4795918367346939), ('val/ResNet50/screenshot/f1-score', 0.0721311475409836), ('val/ResNet50/unknown/f1-score', 0.49464012251148554)]
---train finished---
Trying to save to /tmp/tmpgej8k0yf/model
Too long checkpoint name: ResNet50_64_[0.3, 0.2, 0.2, 0.3]_[3, 1]_1.0_9.999999999999999e-05_[1.0, 1.0, 1.0, 1.0]_Adam_2_1_0 not saved
Done
ResNet50 Loaded!
{'batch_size': 64,
 'class_ratio': [0.3, 0.2, 0.2, 0.3],
 'epoch': [3, 1],
 'gamma': 0.1,
 'learning_rate': 1e-06,
 'loss_cls_weight': tensor([1., 1., 1., 1.]),
 'optimizer': 'Adam',
 'step_size': 2,
 'transforms': [1,
                Compose(
    ColorJitter(brightness=None, contrast=None, saturation=[0.95, 1.05], hue=[-0.05, 0.05])
    RandomHorizontalFlip(p=0.5)
    RandomRotation(degrees=(-20, 20), resample=2, expand=False)
    ToTensor()
    Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])
)],
 'weight_decay': 0.001}
Dataloader constructed!
Epoch: 0, batch loss: 1.37681 Loss Sum: 368.00232, accuracy : 0.18361, val loss: 27.39826, val accuracy: 0.40230
Final : 0.12072396655810785 [('val/ResNet50/monotone/f1-score', 0.016666666666666666), ('val/ResNet50/screenshot/f1-score', 0.182312925170068), ('val/ResNet50/unknown/f1-score', 0.579047619047619)]
Epoch: 1, batch loss: 1.40273 Loss Sum: 354.21150, accuracy : 0.27647, val loss: 27.05420, val accuracy: 0.46743
Final : 0.0 [('val/ResNet50/monotone/f1-score', 0.0), ('val/ResNet50/screenshot/f1-score', 0.16907216494845362), ('val/ResNet50/unknown/f1-score', 0.6480637813211845)]
Epoch: 2, batch loss: 1.35140 Loss Sum: 348.56304, accuracy : 0.31926, val loss: 26.98394, val accuracy: 0.46743
Final : 0.11173489282027776 [('val/ResNet50/monotone/f1-score', 0.012048192771084338), ('val/ResNet50/screenshot/f1-score', 0.1782608695652174), ('val/ResNet50/unknown/f1-score', 0.649514008004574)]
Epoch: 3, batch loss: 1.27100 Loss Sum: 338.03420, accuracy : 0.35534, val loss: 26.11362, val accuracy: 0.52107
Final : 0.3773877504935084 [('val/ResNet50/monotone/f1-score', 0.23170731707317074), ('val/ResNet50/screenshot/f1-score', 0.34394904458598724), ('val/ResNet50/unknown/f1-score', 0.6744186046511628)]
---train finished---
Trying to save to /tmp/tmps6u24bx6/model
Too long checkpoint name: ResNet50_64_[0.3, 0.2, 0.2, 0.3]_[3, 1]_1.0_9.999999999999999e-05_[1.0, 1.0, 1.0, 1.0]_Adam_2_1_100.0 not saved
Done
ResNet50 Loaded!
{'batch_size': 64,
 'class_ratio': [0.3, 0.2, 0.2, 0.3],
 'epoch': [3, 1],
 'gamma': 0.1,
 'learning_rate': 1e-06,
 'loss_cls_weight': tensor([1., 1., 1., 1.]),
 'optimizer': 'Adam',
 'step_size': 2,
 'transforms': [2,
                Compose(
    RandomAffine(degrees=(0, 0), scale=(0.75, 1.25))
    RandomPerspective(p=0.4)
    RandomHorizontalFlip(p=0.5)
    ToTensor()
    Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])
)],
 'weight_decay': 0}
Dataloader constructed!
Epoch: 0, batch loss: 1.37280 Loss Sum: 358.75092, accuracy : 0.26442, val loss: 28.74579, val accuracy: 0.28889
Final : 0.0967967618990299 [('val/ResNet50/monotone/f1-score', 0.0101010101010101), ('val/ResNet50/screenshot/f1-score', 0.1859504132231405), ('val/ResNet50/unknown/f1-score', 0.48285922684172133)]
Epoch: 1, batch loss: 1.35116 Loss Sum: 349.42075, accuracy : 0.31360, val loss: 27.69818, val accuracy: 0.32567
Final : 0.14039667061177466 [('val/ResNet50/monotone/f1-score', 0.027210884353741496), ('val/ResNet50/screenshot/f1-score', 0.1935483870967742), ('val/ResNet50/unknown/f1-score', 0.5254582484725051)]
Epoch: 2, batch loss: 1.38256 Loss Sum: 345.13879, accuracy : 0.33118, val loss: 27.67621, val accuracy: 0.35096
Final : 0.16186280599656447 [('val/ResNet50/monotone/f1-score', 0.052980132450331126), ('val/ResNet50/screenshot/f1-score', 0.14124293785310735), ('val/ResNet50/unknown/f1-score', 0.5667107001321003)]
Epoch: 3, batch loss: 1.27809 Loss Sum: 336.27182, accuracy : 0.36636, val loss: 26.79315, val accuracy: 0.37548
Final : 0.3524791671821092 [('val/ResNet50/monotone/f1-score', 0.1935483870967742), ('val/ResNet50/screenshot/f1-score', 0.41909814323607425), ('val/ResNet50/unknown/f1-score', 0.5398773006134969)]
---train finished---
Trying to save to /tmp/tmph4qtnzme/model
Too long checkpoint name: ResNet50_64_[0.3, 0.2, 0.2, 0.3]_[3, 1]_1.0_9.999999999999999e-05_[1.0, 1.0, 1.0, 1.0]_Adam_2_2_0 not saved
Done
ResNet50 Loaded!
{'batch_size': 64,
 'class_ratio': [0.3, 0.2, 0.2, 0.3],
 'epoch': [3, 1],
 'gamma': 0.1,
 'learning_rate': 1e-06,
 'loss_cls_weight': tensor([1., 1., 1., 1.]),
 'optimizer': 'Adam',
 'step_size': 2,
 'transforms': [2,
                Compose(
    RandomAffine(degrees=(0, 0), scale=(0.75, 1.25))
    RandomPerspective(p=0.4)
    RandomHorizontalFlip(p=0.5)
    ToTensor()
    Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])
)],
 'weight_decay': 0.001}
Dataloader constructed!
Epoch: 0, batch loss: 1.38465 Loss Sum: 362.17955, accuracy : 0.22274, val loss: 29.29755, val accuracy: 0.21609
Final : 0.1366122385853551 [('val/ResNet50/monotone/f1-score', 0.07258064516129031), ('val/ResNet50/screenshot/f1-score', 0.08837209302325581), ('val/ResNet50/unknown/f1-score', 0.3974960876369327)]
Epoch: 1, batch loss: 1.34851 Loss Sum: 351.89972, accuracy : 0.27994, val loss: 28.15803, val accuracy: 0.29502
Final : 0.17257147061680436 [('val/ResNet50/monotone/f1-score', 0.1095890410958904), ('val/ResNet50/screenshot/f1-score', 0.09411764705882353), ('val/ResNet50/unknown/f1-score', 0.4982746721877157)]
Epoch: 2, batch loss: 1.28482 Loss Sum: 347.44459, accuracy : 0.29455, val loss: 28.03160, val accuracy: 0.30115
Final : 0.1644489872161342 [('val/ResNet50/monotone/f1-score', 0.09722222222222222), ('val/ResNet50/screenshot/f1-score', 0.08902077151335312), ('val/ResNet50/unknown/f1-score', 0.5138504155124654)]
Epoch: 3, batch loss: 1.32056 Loss Sum: 338.68717, accuracy : 0.34056, val loss: 27.07313, val accuracy: 0.36858
Final : 0.3730957062275187 [('val/ResNet50/monotone/f1-score', 0.28025477707006374), ('val/ResNet50/screenshot/f1-score', 0.34375), ('val/ResNet50/unknown/f1-score', 0.5390946502057613)]
---train finished---
Trying to save to /tmp/tmpeufaklim/model
Too long checkpoint name: ResNet50_64_[0.3, 0.2, 0.2, 0.3]_[3, 1]_1.0_9.999999999999999e-05_[1.0, 1.0, 1.0, 1.0]_Adam_2_2_100.0 not saved
Done
ResNet50 Loaded!
{'batch_size': 64,
 'class_ratio': [0.3, 0.2, 0.2, 0.3],
 'epoch': [3, 1],
 'gamma': 0.1,
 'learning_rate': 1e-06,
 'loss_cls_weight': tensor([1., 1., 1., 1.]),
 'optimizer': 'SGD',
 'step_size': 10,
 'transforms': [1,
                Compose(
    ColorJitter(brightness=None, contrast=None, saturation=[0.95, 1.05], hue=[-0.05, 0.05])
    RandomHorizontalFlip(p=0.5)
    RandomRotation(degrees=(-20, 20), resample=2, expand=False)
    ToTensor()
    Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])
)],
 'weight_decay': 0}
Dataloader constructed!
Epoch: 0, batch loss: 1.44315 Loss Sum: 376.81267, accuracy : 0.16547, val loss: 32.90175, val accuracy: 0.08276
Final : 0.07013398244724284 [('val/ResNet50/monotone/f1-score', 0.1466798810703667), ('val/ResNet50/screenshot/f1-score', 0.055445544554455446), ('val/ResNet50/unknown/f1-score', 0.042417815482502653)]
Epoch: 1, batch loss: 1.46503 Loss Sum: 373.32943, accuracy : 0.17703, val loss: 32.55175, val accuracy: 0.09119
Final : 0.09140572264887134 [('val/ResNet50/monotone/f1-score', 0.13800424628450106), ('val/ResNet50/screenshot/f1-score', 0.078125), ('val/ResNet50/unknown/f1-score', 0.07083333333333333)]
Epoch: 2, batch loss: 1.45268 Loss Sum: 370.86974, accuracy : 0.17989, val loss: 32.14236, val accuracy: 0.08352
Final : 0.08771049442890624 [('val/ResNet50/monotone/f1-score', 0.12626832018038328), ('val/ResNet50/screenshot/f1-score', 0.07797270955165692), ('val/ResNet50/unknown/f1-score', 0.06853582554517135)]
Epoch: 3, batch loss: 1.43101 Loss Sum: 367.77609, accuracy : 0.19426, val loss: 31.71934, val accuracy: 0.09425
Final : 0.0968413472405931 [('val/ResNet50/monotone/f1-score', 0.12958435207823962), ('val/ResNet50/screenshot/f1-score', 0.0652591170825336), ('val/ResNet50/unknown/f1-score', 0.10739614994934145)]
---train finished---
Trying to save to /tmp/tmpkl5x47s9/model
Too long checkpoint name: ResNet50_64_[0.3, 0.2, 0.2, 0.3]_[3, 1]_1.0_9.999999999999999e-05_[1.0, 1.0, 1.0, 1.0]_SGD_10_1_0 not saved
Done
ResNet50 Loaded!
{'batch_size': 64,
 'class_ratio': [0.3, 0.2, 0.2, 0.3],
 'epoch': [3, 1],
 'gamma': 0.1,
 'learning_rate': 1e-06,
 'loss_cls_weight': tensor([1., 1., 1., 1.]),
 'optimizer': 'SGD',
 'step_size': 10,
 'transforms': [1,
                Compose(
    ColorJitter(brightness=None, contrast=None, saturation=[0.95, 1.05], hue=[-0.05, 0.05])
    RandomHorizontalFlip(p=0.5)
    RandomRotation(degrees=(-20, 20), resample=2, expand=False)
    ToTensor()
    Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])
)],
 'weight_decay': 0.001}
Dataloader constructed!
Epoch: 0, batch loss: 1.33364 Loss Sum: 340.67374, accuracy : 0.37543, val loss: 26.65293, val accuracy: 0.35096
Final : 0.1257293385424681 [('val/ResNet50/monotone/f1-score', 0.24203821656050956), ('val/ResNet50/screenshot/f1-score', 0.014760147601476014), ('val/ResNet50/unknown/f1-score', 0.5563335455124124)]
Epoch: 1, batch loss: 1.13276 Loss Sum: 312.97812, accuracy : 0.43872, val loss: 25.32542, val accuracy: 0.36858
Final : 0.3922891531618584 [('val/ResNet50/monotone/f1-score', 0.5294117647058824), ('val/ResNet50/screenshot/f1-score', 0.21671826625386997), ('val/ResNet50/unknown/f1-score', 0.5261744966442953)]
Epoch: 2, batch loss: 1.03293 Loss Sum: 288.41502, accuracy : 0.58124, val loss: 24.48673, val accuracy: 0.43525
Final : 0.582660576141066 [('val/ResNet50/monotone/f1-score', 0.7209302325581395), ('val/ResNet50/screenshot/f1-score', 0.5179487179487179), ('val/ResNet50/unknown/f1-score', 0.5297450424929178)]
Epoch: 3, batch loss: 1.01603 Loss Sum: 263.32908, accuracy : 0.67977, val loss: 22.99017, val accuracy: 0.51648
Final : 0.6836431753731166 [('val/ResNet50/monotone/f1-score', 0.7676767676767676), ('val/ResNet50/screenshot/f1-score', 0.7288888888888888), ('val/ResNet50/unknown/f1-score', 0.5710165825522711)]
---train finished---
Trying to save to /tmp/tmp3fc3a0xa/model
Too long checkpoint name: ResNet50_64_[0.3, 0.2, 0.2, 0.3]_[3, 1]_1.0_9.999999999999999e-05_[1.0, 1.0, 1.0, 1.0]_SGD_10_1_100.0 not saved
Done
ResNet50 Loaded!
{'batch_size': 64,
 'class_ratio': [0.3, 0.2, 0.2, 0.3],
 'epoch': [3, 1],
 'gamma': 0.1,
 'learning_rate': 1e-06,
 'loss_cls_weight': tensor([1., 1., 1., 1.]),
 'optimizer': 'SGD',
 'step_size': 10,
 'transforms': [2,
                Compose(
    RandomAffine(degrees=(0, 0), scale=(0.75, 1.25))
    RandomPerspective(p=0.4)
    RandomHorizontalFlip(p=0.5)
    ToTensor()
    Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])
)],
 'weight_decay': 0}
Dataloader constructed!
Epoch: 0, batch loss: 1.19199 Loss Sum: 345.16808, accuracy : 0.31585, val loss: 25.93161, val accuracy: 0.39540
Final : 0.0 [('val/ResNet50/monotone/f1-score', 0.0), ('val/ResNet50/screenshot/f1-score', 0.2019543973941368), ('val/ResNet50/unknown/f1-score', 0.6062500000000001)]
Epoch: 1, batch loss: 1.16475 Loss Sum: 318.95977, accuracy : 0.41030, val loss: 24.89237, val accuracy: 0.44904
Final : 0.39118131540064405 [('val/ResNet50/monotone/f1-score', 0.18309859154929578), ('val/ResNet50/screenshot/f1-score', 0.5363408521303258), ('val/ResNet50/unknown/f1-score', 0.6095487246566383)]
Epoch: 2, batch loss: 1.10612 Loss Sum: 297.60555, accuracy : 0.52653, val loss: 24.18885, val accuracy: 0.49195
Final : 0.6006819526719996 [('val/ResNet50/monotone/f1-score', 0.5333333333333333), ('val/ResNet50/screenshot/f1-score', 0.6681514476614699), ('val/ResNet50/unknown/f1-score', 0.6082191780821918)]
Epoch: 3, batch loss: 0.99550 Loss Sum: 274.82516, accuracy : 0.64831, val loss: 23.03450, val accuracy: 0.53410
Final : 0.7141528031483078 [('val/ResNet50/monotone/f1-score', 0.803347280334728), ('val/ResNet50/screenshot/f1-score', 0.75564681724846), ('val/ResNet50/unknown/f1-score', 0.6)]
---train finished---
Trying to save to /tmp/tmpinr5pnww/model
Too long checkpoint name: ResNet50_64_[0.3, 0.2, 0.2, 0.3]_[3, 1]_1.0_9.999999999999999e-05_[1.0, 1.0, 1.0, 1.0]_SGD_10_2_0 not saved
Done
ResNet50 Loaded!
{'batch_size': 64,
 'class_ratio': [0.3, 0.2, 0.2, 0.3],
 'epoch': [3, 1],
 'gamma': 0.1,
 'learning_rate': 1e-06,
 'loss_cls_weight': tensor([1., 1., 1., 1.]),
 'optimizer': 'SGD',
 'step_size': 10,
 'transforms': [2,
                Compose(
    RandomAffine(degrees=(0, 0), scale=(0.75, 1.25))
    RandomPerspective(p=0.4)
    RandomHorizontalFlip(p=0.5)
    ToTensor()
    Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])
)],
 'weight_decay': 0.001}
Dataloader constructed!
Epoch: 0, batch loss: 1.40289 Loss Sum: 369.93582, accuracy : 0.24227, val loss: 30.50768, val accuracy: 0.19540
Final : 0.06972606806948942 [('val/ResNet50/monotone/f1-score', 0.18335089567966278), ('val/ResNet50/screenshot/f1-score', 0.006349206349206349), ('val/ResNet50/unknown/f1-score', 0.2911944202266783)]
Epoch: 1, batch loss: 1.43384 Loss Sum: 368.58081, accuracy : 0.25183, val loss: 30.44581, val accuracy: 0.20153
Final : 0.10353054639624842 [('val/ResNet50/monotone/f1-score', 0.2011173184357542), ('val/ResNet50/screenshot/f1-score', 0.018808777429467086), ('val/ResNet50/unknown/f1-score', 0.29335634167385677)]
Epoch: 2, batch loss: 1.40477 Loss Sum: 367.08079, accuracy : 0.26175, val loss: 30.28226, val accuracy: 0.22605
Final : 0.1080240825754376 [('val/ResNet50/monotone/f1-score', 0.20024125452352232), ('val/ResNet50/screenshot/f1-score', 0.018072289156626505), ('val/ResNet50/unknown/f1-score', 0.34833333333333333)]
Epoch: 3, batch loss: 1.43425 Loss Sum: 365.26111, accuracy : 0.26917, val loss: 30.18818, val accuracy: 0.22299
Final : 0.07445231882710887 [('val/ResNet50/monotone/f1-score', 0.2038709677419355), ('val/ResNet50/screenshot/f1-score', 0.005780346820809248), ('val/ResNet50/unknown/f1-score', 0.3502074688796681)]
---train finished---
Trying to save to /tmp/tmpekcc307q/model
Too long checkpoint name: ResNet50_64_[0.3, 0.2, 0.2, 0.3]_[3, 1]_1.0_9.999999999999999e-05_[1.0, 1.0, 1.0, 1.0]_SGD_10_2_100.0 not saved
Done
ResNet50 Loaded!
{'batch_size': 64,
 'class_ratio': [0.3, 0.2, 0.2, 0.3],
 'epoch': [3, 1],
 'gamma': 0.1,
 'learning_rate': 1e-06,
 'loss_cls_weight': tensor([1., 1., 1., 1.]),
 'optimizer': 'SGD',
 'step_size': 2,
 'transforms': [1,
                Compose(
    ColorJitter(brightness=None, contrast=None, saturation=[0.95, 1.05], hue=[-0.05, 0.05])
    RandomHorizontalFlip(p=0.5)
    RandomRotation(degrees=(-20, 20), resample=2, expand=False)
    ToTensor()
    Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])
)],
 'weight_decay': 0}
Dataloader constructed!
Epoch: 0, batch loss: 1.27280 Loss Sum: 364.34260, accuracy : 0.24976, val loss: 26.37632, val accuracy: 0.46897
Final : 0.0 [('val/ResNet50/monotone/f1-score', 0.0), ('val/ResNet50/screenshot/f1-score', 0.11311053984575836), ('val/ResNet50/unknown/f1-score', 0.667420814479638)]
Epoch: 1, batch loss: 1.35235 Loss Sum: 359.29438, accuracy : 0.25365, val loss: 26.79615, val accuracy: 0.43372
Final : 0.0 [('val/ResNet50/monotone/f1-score', 0.0), ('val/ResNet50/screenshot/f1-score', 0.1037463976945245), ('val/ResNet50/unknown/f1-score', 0.6398131932282546)]
Epoch: 2, batch loss: 1.28635 Loss Sum: 357.21553, accuracy : 0.25310, val loss: 26.71832, val accuracy: 0.45287
Final : 0.0 [('val/ResNet50/monotone/f1-score', 0.0), ('val/ResNet50/screenshot/f1-score', 0.10714285714285715), ('val/ResNet50/unknown/f1-score', 0.656733524355301)]
Epoch: 3, batch loss: 1.41087 Loss Sum: 356.57133, accuracy : 0.26083, val loss: 26.82416, val accuracy: 0.41762
Final : 0.0 [('val/ResNet50/monotone/f1-score', 0.0), ('val/ResNet50/screenshot/f1-score', 0.07536231884057971), ('val/ResNet50/unknown/f1-score', 0.6269888037713612)]
---train finished---
Trying to save to /tmp/tmpkv3_ism0/model
Too long checkpoint name: ResNet50_64_[0.3, 0.2, 0.2, 0.3]_[3, 1]_1.0_9.999999999999999e-05_[1.0, 1.0, 1.0, 1.0]_SGD_2_1_0 not saved
Done
ResNet50 Loaded!
{'batch_size': 64,
 'class_ratio': [0.3, 0.2, 0.2, 0.3],
 'epoch': [3, 1],
 'gamma': 0.1,
 'learning_rate': 1e-06,
 'loss_cls_weight': tensor([1., 1., 1., 1.]),
 'optimizer': 'SGD',
 'step_size': 2,
 'transforms': [1,
                Compose(
    ColorJitter(brightness=None, contrast=None, saturation=[0.95, 1.05], hue=[-0.05, 0.05])
    RandomHorizontalFlip(p=0.5)
    RandomRotation(degrees=(-20, 20), resample=2, expand=False)
    ToTensor()
    Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])
)],
 'weight_decay': 0.001}
Dataloader constructed!
Epoch: 0, batch loss: 1.37038 Loss Sum: 359.14436, accuracy : 0.22748, val loss: 28.69068, val accuracy: 0.27203
Final : 0.22674600473744752 [('val/ResNet50/monotone/f1-score', 0.12051649928263988), ('val/ResNet50/screenshot/f1-score', 0.2469879518072289), ('val/ResNet50/unknown/f1-score', 0.39164866810655147)]
Epoch: 1, batch loss: 1.39867 Loss Sum: 349.59948, accuracy : 0.28864, val loss: 28.08808, val accuracy: 0.32414
Final : 0.21322486447258054 [('val/ResNet50/monotone/f1-score', 0.08780487804878048), ('val/ResNet50/screenshot/f1-score', 0.2298136645962733), ('val/ResNet50/unknown/f1-score', 0.4804177545691906)]
Epoch: 2, batch loss: 1.33279 Loss Sum: 345.83909, accuracy : 0.31615, val loss: 28.14096, val accuracy: 0.32644
Final : 0.21576727982255928 [('val/ResNet50/monotone/f1-score', 0.09207161125319693), ('val/ResNet50/screenshot/f1-score', 0.22641509433962265), ('val/ResNet50/unknown/f1-score', 0.48186528497409326)]
Epoch: 3, batch loss: 1.37096 Loss Sum: 345.08699, accuracy : 0.32163, val loss: 27.96369, val accuracy: 0.34176
Final : 0.24155488422355492 [('val/ResNet50/monotone/f1-score', 0.1319261213720317), ('val/ResNet50/screenshot/f1-score', 0.2151898734177215), ('val/ResNet50/unknown/f1-score', 0.4964720974983965)]
---train finished---
Trying to save to /tmp/tmpxmuhhawh/model
Too long checkpoint name: ResNet50_64_[0.3, 0.2, 0.2, 0.3]_[3, 1]_1.0_9.999999999999999e-05_[1.0, 1.0, 1.0, 1.0]_SGD_2_1_100.0 not saved
Done
ResNet50 Loaded!
{'batch_size': 64,
 'class_ratio': [0.3, 0.2, 0.2, 0.3],
 'epoch': [3, 1],
 'gamma': 0.1,
 'learning_rate': 1e-06,
 'loss_cls_weight': tensor([1., 1., 1., 1.]),
 'optimizer': 'SGD',
 'step_size': 2,
 'transforms': [2,
                Compose(
    RandomAffine(degrees=(0, 0), scale=(0.75, 1.25))
    RandomPerspective(p=0.4)
    RandomHorizontalFlip(p=0.5)
    ToTensor()
    Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])
)],
 'weight_decay': 0}
Dataloader constructed!
Epoch: 0, batch loss: 1.34484 Loss Sum: 340.70416, accuracy : 0.37159, val loss: 28.22499, val accuracy: 0.30421
Final : 0.17952306903359028 [('val/ResNet50/monotone/f1-score', 0.3898305084745763), ('val/ResNet50/screenshot/f1-score', 0.02857142857142857), ('val/ResNet50/unknown/f1-score', 0.5194610778443115)]
Epoch: 1, batch loss: 1.33127 Loss Sum: 339.65536, accuracy : 0.37421, val loss: 28.04741, val accuracy: 0.30651
Final : 0.11327654981716034 [('val/ResNet50/monotone/f1-score', 0.3876651982378854), ('val/ResNet50/screenshot/f1-score', 0.0070921985815602835), ('val/ResNet50/unknown/f1-score', 0.5286671630677587)]
Epoch: 2, batch loss: 1.27900 Loss Sum: 339.24948, accuracy : 0.37403, val loss: 28.12985, val accuracy: 0.31418
Final : 0.150428466606096 [('val/ResNet50/monotone/f1-score', 0.44725738396624476), ('val/ResNet50/screenshot/f1-score', 0.014492753623188406), ('val/ResNet50/unknown/f1-score', 0.5251479289940828)]
Epoch: 3, batch loss: 1.35666 Loss Sum: 338.91575, accuracy : 0.37640, val loss: 28.02431, val accuracy: 0.30881
Final : 0.171411496716877 [('val/ResNet50/monotone/f1-score', 0.45132743362831856), ('val/ResNet50/screenshot/f1-score', 0.02158273381294964), ('val/ResNet50/unknown/f1-score', 0.517037037037037)]
---train finished---
Trying to save to /tmp/tmpcjwteax4/model
Too long checkpoint name: ResNet50_64_[0.3, 0.2, 0.2, 0.3]_[3, 1]_1.0_9.999999999999999e-05_[1.0, 1.0, 1.0, 1.0]_SGD_2_2_0 not saved
Done
ResNet50 Loaded!
{'batch_size': 64,
 'class_ratio': [0.3, 0.2, 0.2, 0.3],
 'epoch': [3, 1],
 'gamma': 0.1,
 'learning_rate': 1e-06,
 'loss_cls_weight': tensor([1., 1., 1., 1.]),
 'optimizer': 'SGD',
 'step_size': 2,
 'transforms': [2,
                Compose(
    RandomAffine(degrees=(0, 0), scale=(0.75, 1.25))
    RandomPerspective(p=0.4)
    RandomHorizontalFlip(p=0.5)
    ToTensor()
    Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])
)],
 'weight_decay': 0.001}
Dataloader constructed!
Epoch: 0, batch loss: 1.27960 Loss Sum: 352.48627, accuracy : 0.29467, val loss: 27.19312, val accuracy: 0.27663
Final : 0.12622703247717415 [('val/ResNet50/monotone/f1-score', 0.08888888888888888), ('val/ResNet50/screenshot/f1-score', 0.04411764705882353), ('val/ResNet50/unknown/f1-score', 0.5128581925055106)]
Epoch: 1, batch loss: 1.31084 Loss Sum: 325.90166, accuracy : 0.35267, val loss: 25.15229, val accuracy: 0.43295
Final : 0.3822781319922519 [('val/ResNet50/monotone/f1-score', 0.1958041958041958), ('val/ResNet50/screenshot/f1-score', 0.45892351274787535), ('val/ResNet50/unknown/f1-score', 0.6216931216931216)]
Epoch: 2, batch loss: 1.20744 Loss Sum: 313.49859, accuracy : 0.42369, val loss: 25.25185, val accuracy: 0.40000
Final : 0.37349220848930176 [('val/ResNet50/monotone/f1-score', 0.20833333333333334), ('val/ResNet50/screenshot/f1-score', 0.4293785310734463), ('val/ResNet50/unknown/f1-score', 0.5824324324324324)]
Epoch: 3, batch loss: 1.22081 Loss Sum: 310.93897, accuracy : 0.43683, val loss: 25.00257, val accuracy: 0.44521
Final : 0.4731137643418595 [('val/ResNet50/monotone/f1-score', 0.36477987421383645), ('val/ResNet50/screenshot/f1-score', 0.46239554317548737), ('val/ResNet50/unknown/f1-score', 0.6278447121820615)]
---train finished---
Trying to save to /tmp/tmp66tvzpe8/model
Too long checkpoint name: ResNet50_64_[0.3, 0.2, 0.2, 0.3]_[3, 1]_1.0_9.999999999999999e-05_[1.0, 1.0, 1.0, 1.0]_SGD_2_2_100.0 not saved
Done
ResNet50 Loaded!
{'batch_size': 64,
 'class_ratio': [0.3, 0.2, 0.2, 0.3],
 'epoch': [3, 1],
 'gamma': 0.1,
 'learning_rate': 1e-06,
 'loss_cls_weight': tensor([1.0060, 1.0797, 1.0402, 1.2753]),
 'optimizer': 'Adamax',
 'step_size': 10,
 'transforms': [1,
                Compose(
    ColorJitter(brightness=None, contrast=None, saturation=[0.95, 1.05], hue=[-0.05, 0.05])
    RandomHorizontalFlip(p=0.5)
    RandomRotation(degrees=(-20, 20), resample=2, expand=False)
    ToTensor()
    Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])
)],
 'weight_decay': 0}
Dataloader constructed!
Epoch: 0, batch loss: 1.40073 Loss Sum: 362.46132, accuracy : 0.22608, val loss: 29.25839, val accuracy: 0.25517
Final : 0.15799218752789876 [('val/ResNet50/monotone/f1-score', 0.0546875), ('val/ResNet50/screenshot/f1-score', 0.16964285714285715), ('val/ResNet50/unknown/f1-score', 0.42509225092250924)]
Epoch: 1, batch loss: 1.35401 Loss Sum: 355.85508, accuracy : 0.26229, val loss: 28.26147, val accuracy: 0.32261
Final : 0.11911773975986113 [('val/ResNet50/monotone/f1-score', 0.02395209580838323), ('val/ResNet50/screenshot/f1-score', 0.13477088948787064), ('val/ResNet50/unknown/f1-score', 0.5235880398671096)]
Epoch: 2, batch loss: 1.32949 Loss Sum: 350.71603, accuracy : 0.28566, val loss: 27.37761, val accuracy: 0.40613
Final : 0.0 [('val/ResNet50/monotone/f1-score', 0.0), ('val/ResNet50/screenshot/f1-score', 0.09554140127388534), ('val/ResNet50/unknown/f1-score', 0.6227327690447401)]
Epoch: 3, batch loss: 1.09126 Loss Sum: 305.40591, accuracy : 0.51162, val loss: 23.25579, val accuracy: 0.61456
Final : 0.7458775416784528 [('val/ResNet50/monotone/f1-score', 0.8197879858657244), ('val/ResNet50/screenshot/f1-score', 0.7424892703862661), ('val/ResNet50/unknown/f1-score', 0.6817275747508306)]
---train finished---
Trying to save to /tmp/tmpio5__krr/model
Too long checkpoint name: ResNet50_64_[0.3, 0.2, 0.2, 0.3]_[3, 1]_1.0_9.999999999999999e-05_[1.00600004196167, 1.079699993133545, 1.0401999950408936, 1.2753000259399414]_Adamax_10_1_0 not saved
Done
ResNet50 Loaded!
{'batch_size': 64,
 'class_ratio': [0.3, 0.2, 0.2, 0.3],
 'epoch': [3, 1],
 'gamma': 0.1,
 'learning_rate': 1e-06,
 'loss_cls_weight': tensor([1.0060, 1.0797, 1.0402, 1.2753]),
 'optimizer': 'Adamax',
 'step_size': 10,
 'transforms': [1,
                Compose(
    ColorJitter(brightness=None, contrast=None, saturation=[0.95, 1.05], hue=[-0.05, 0.05])
    RandomHorizontalFlip(p=0.5)
    RandomRotation(degrees=(-20, 20), resample=2, expand=False)
    ToTensor()
    Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])
)],
 'weight_decay': 0.001}
Dataloader constructed!
Epoch: 0, batch loss: 1.34956 Loss Sum: 358.90818, accuracy : 0.19097, val loss: 27.69299, val accuracy: 0.32950
Final : 0.0 [('val/ResNet50/monotone/f1-score', 0.0), ('val/ResNet50/screenshot/f1-score', 0.15324675324675324), ('val/ResNet50/unknown/f1-score', 0.5068306010928961)]
Epoch: 1, batch loss: 1.34711 Loss Sum: 353.04555, accuracy : 0.23759, val loss: 26.84868, val accuracy: 0.40690
Final : 0.0 [('val/ResNet50/monotone/f1-score', 0.0), ('val/ResNet50/screenshot/f1-score', 0.10112359550561797), ('val/ResNet50/unknown/f1-score', 0.6142595978062156)]
Epoch: 2, batch loss: 1.34131 Loss Sum: 348.02672, accuracy : 0.28098, val loss: 26.25084, val accuracy: 0.44674
Final : 0.08201464963084588 [('val/ResNet50/monotone/f1-score', 0.015384615384615384), ('val/ResNet50/screenshot/f1-score', 0.05432098765432099), ('val/ResNet50/unknown/f1-score', 0.6601156069364162)]
Epoch: 3, batch loss: 1.04100 Loss Sum: 301.92070, accuracy : 0.51369, val loss: 22.39402, val accuracy: 0.66437
Final : 0.7680947560354895 [('val/ResNet50/monotone/f1-score', 0.8467153284671534), ('val/ResNet50/screenshot/f1-score', 0.7264573991031391), ('val/ResNet50/unknown/f1-score', 0.7367104440275173)]
---train finished---
Trying to save to /tmp/tmpgdsr45xp/model
Too long checkpoint name: ResNet50_64_[0.3, 0.2, 0.2, 0.3]_[3, 1]_1.0_9.999999999999999e-05_[1.00600004196167, 1.079699993133545, 1.0401999950408936, 1.2753000259399414]_Adamax_10_1_100.0 not saved
Done
ResNet50 Loaded!
{'batch_size': 64,
 'class_ratio': [0.3, 0.2, 0.2, 0.3],
 'epoch': [3, 1],
 'gamma': 0.1,
 'learning_rate': 1e-06,
 'loss_cls_weight': tensor([1.0060, 1.0797, 1.0402, 1.2753]),
 'optimizer': 'Adamax',
 'step_size': 10,
 'transforms': [2,
                Compose(
    RandomAffine(degrees=(0, 0), scale=(0.75, 1.25))
    RandomPerspective(p=0.4)
    RandomHorizontalFlip(p=0.5)
    ToTensor()
    Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])
)],
 'weight_decay': 0}
Dataloader constructed!
Epoch: 0, batch loss: 1.28816 Loss Sum: 353.76107, accuracy : 0.26667, val loss: 27.23732, val accuracy: 0.39847
Final : 0.0 [('val/ResNet50/monotone/f1-score', 0.0), ('val/ResNet50/screenshot/f1-score', 0.07885304659498209), ('val/ResNet50/unknown/f1-score', 0.6606099935107074)]
Epoch: 1, batch loss: 1.35483 Loss Sum: 348.77826, accuracy : 0.28633, val loss: 26.59287, val accuracy: 0.46360
Final : 0.0 [('val/ResNet50/monotone/f1-score', 0.0), ('val/ResNet50/screenshot/f1-score', 0.09352517985611511), ('val/ResNet50/unknown/f1-score', 0.7123947051744887)]
Epoch: 2, batch loss: 1.38160 Loss Sum: 345.11280, accuracy : 0.29576, val loss: 25.87019, val accuracy: 0.49349
Final : 0.0 [('val/ResNet50/monotone/f1-score', 0.0), ('val/ResNet50/screenshot/f1-score', 0.05072463768115942), ('val/ResNet50/unknown/f1-score', 0.7334484743811169)]
Epoch: 3, batch loss: 1.07359 Loss Sum: 307.60321, accuracy : 0.45576, val loss: 22.63826, val accuracy: 0.64215
Final : 0.688917565080365 [('val/ResNet50/monotone/f1-score', 0.6504854368932039), ('val/ResNet50/screenshot/f1-score', 0.6570048309178743), ('val/ResNet50/unknown/f1-score', 0.7650602409638553)]
---train finished---
Trying to save to /tmp/tmp3ujlmbu8/model
Too long checkpoint name: ResNet50_64_[0.3, 0.2, 0.2, 0.3]_[3, 1]_1.0_9.999999999999999e-05_[1.00600004196167, 1.079699993133545, 1.0401999950408936, 1.2753000259399414]_Adamax_10_2_0 not saved
Done
ResNet50 Loaded!
{'batch_size': 64,
 'class_ratio': [0.3, 0.2, 0.2, 0.3],
 'epoch': [3, 1],
 'gamma': 0.1,
 'learning_rate': 1e-06,
 'loss_cls_weight': tensor([1.0060, 1.0797, 1.0402, 1.2753]),
 'optimizer': 'Adamax',
 'step_size': 10,
 'transforms': [2,
                Compose(
    RandomAffine(degrees=(0, 0), scale=(0.75, 1.25))
    RandomPerspective(p=0.4)
    RandomHorizontalFlip(p=0.5)
    ToTensor()
    Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])
)],
 'weight_decay': 0.001}
Dataloader constructed!
Epoch: 0, batch loss: 1.37107 Loss Sum: 358.80177, accuracy : 0.24690, val loss: 28.18085, val accuracy: 0.28429
Final : 0.0 [('val/ResNet50/monotone/f1-score', 0.0), ('val/ResNet50/screenshot/f1-score', 0.1446280991735537), ('val/ResNet50/unknown/f1-score', 0.46473029045643155)]
Epoch: 1, batch loss: 1.34990 Loss Sum: 353.75197, accuracy : 0.27167, val loss: 27.39828, val accuracy: 0.34176
Final : 0.0 [('val/ResNet50/monotone/f1-score', 0.0), ('val/ResNet50/screenshot/f1-score', 0.08695652173913043), ('val/ResNet50/unknown/f1-score', 0.5430379746835443)]
Epoch: 2, batch loss: 1.39690 Loss Sum: 350.33698, accuracy : 0.28724, val loss: 26.68506, val accuracy: 0.40996
Final : 0.0 [('val/ResNet50/monotone/f1-score', 0.0), ('val/ResNet50/screenshot/f1-score', 0.08383233532934131), ('val/ResNet50/unknown/f1-score', 0.6154754873006497)]
Epoch: 3, batch loss: 1.11012 Loss Sum: 312.81436, accuracy : 0.42265, val loss: 23.55439, val accuracy: 0.54483
Final : 0.6455537600918332 [('val/ResNet50/monotone/f1-score', 0.6105263157894736), ('val/ResNet50/screenshot/f1-score', 0.6744186046511628), ('val/ResNet50/unknown/f1-score', 0.6533762057877814)]
---train finished---
Trying to save to /tmp/tmpli_vjuqg/model
Too long checkpoint name: ResNet50_64_[0.3, 0.2, 0.2, 0.3]_[3, 1]_1.0_9.999999999999999e-05_[1.00600004196167, 1.079699993133545, 1.0401999950408936, 1.2753000259399414]_Adamax_10_2_100.0 not saved
Done
ResNet50 Loaded!
{'batch_size': 64,
 'class_ratio': [0.3, 0.2, 0.2, 0.3],
 'epoch': [3, 1],
 'gamma': 0.1,
 'learning_rate': 1e-06,
 'loss_cls_weight': tensor([1.0060, 1.0797, 1.0402, 1.2753]),
 'optimizer': 'Adamax',
 'step_size': 2,
 'transforms': [1,
                Compose(
    ColorJitter(brightness=None, contrast=None, saturation=[0.95, 1.05], hue=[-0.05, 0.05])
    RandomHorizontalFlip(p=0.5)
    RandomRotation(degrees=(-20, 20), resample=2, expand=False)
    ToTensor()
    Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])
)],
 'weight_decay': 0}
Dataloader constructed!
Epoch: 0, batch loss: 1.37130 Loss Sum: 342.17397, accuracy : 0.31713, val loss: 26.79426, val accuracy: 0.33103
Final : 0.06249754639831986 [('val/ResNet50/monotone/f1-score', 0.014705882352941175), ('val/ResNet50/screenshot/f1-score', 0.030303030303030304), ('val/ResNet50/unknown/f1-score', 0.5477870429762669)]
Epoch: 1, batch loss: 1.37292 Loss Sum: 338.91185, accuracy : 0.32619, val loss: 26.09770, val accuracy: 0.40843
Final : 0.0 [('val/ResNet50/monotone/f1-score', 0.0), ('val/ResNet50/screenshot/f1-score', 0.007722007722007722), ('val/ResNet50/unknown/f1-score', 0.6236811254396248)]
Epoch: 2, batch loss: 1.25037 Loss Sum: 336.84169, accuracy : 0.32711, val loss: 25.98820, val accuracy: 0.40383
Final : 0.0 [('val/ResNet50/monotone/f1-score', 0.0), ('val/ResNet50/screenshot/f1-score', 0.007575757575757576), ('val/ResNet50/unknown/f1-score', 0.6213821618428824)]
Epoch: 3, batch loss: 1.18191 Loss Sum: 332.38734, accuracy : 0.33934, val loss: 25.50052, val accuracy: 0.42375
Final : 0.132783053283853 [('val/ResNet50/monotone/f1-score', 0.0704225352112676), ('val/ResNet50/screenshot/f1-score', 0.05263157894736842), ('val/ResNet50/unknown/f1-score', 0.6316403969643899)]
---train finished---
Trying to save to /tmp/tmpwxws6kpr/model
Too long checkpoint name: ResNet50_64_[0.3, 0.2, 0.2, 0.3]_[3, 1]_1.0_9.999999999999999e-05_[1.00600004196167, 1.079699993133545, 1.0401999950408936, 1.2753000259399414]_Adamax_2_1_0 not saved
Done
ResNet50 Loaded!
{'batch_size': 64,
 'class_ratio': [0.3, 0.2, 0.2, 0.3],
 'epoch': [3, 1],
 'gamma': 0.1,
 'learning_rate': 1e-06,
 'loss_cls_weight': tensor([1.0060, 1.0797, 1.0402, 1.2753]),
 'optimizer': 'Adamax',
 'step_size': 2,
 'transforms': [1,
                Compose(
    ColorJitter(brightness=None, contrast=None, saturation=[0.95, 1.05], hue=[-0.05, 0.05])
    RandomHorizontalFlip(p=0.5)
    RandomRotation(degrees=(-20, 20), resample=2, expand=False)
    ToTensor()
    Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])
)],
 'weight_decay': 0.001}
Dataloader constructed!
Epoch: 0, batch loss: 1.40795 Loss Sum: 366.93980, accuracy : 0.25688, val loss: 32.16517, val accuracy: 0.18314
Final : 0.1655954484599332 [('val/ResNet50/monotone/f1-score', 0.2677824267782427), ('val/ResNet50/screenshot/f1-score', 0.2980132450331126), ('val/ResNet50/unknown/f1-score', 0.05690200210748156)]
Epoch: 1, batch loss: 1.41216 Loss Sum: 355.16817, accuracy : 0.30215, val loss: 30.36360, val accuracy: 0.21379
Final : 0.25441418909304786 [('val/ResNet50/monotone/f1-score', 0.34285714285714286), ('val/ResNet50/screenshot/f1-score', 0.3213572854291417), ('val/ResNet50/unknown/f1-score', 0.14945919370698132)]
Epoch: 2, batch loss: 1.39200 Loss Sum: 349.76183, accuracy : 0.32571, val loss: 30.23754, val accuracy: 0.20920
Final : 0.25799139466547094 [('val/ResNet50/monotone/f1-score', 0.32900432900432897), ('val/ResNet50/screenshot/f1-score', 0.2986611740473738), ('val/ResNet50/unknown/f1-score', 0.17475728155339806)]
Epoch: 3, batch loss: 1.33164 Loss Sum: 344.21660, accuracy : 0.36630, val loss: 29.58742, val accuracy: 0.25211
Final : 0.3165512681651806 [('val/ResNet50/monotone/f1-score', 0.46332046332046334), ('val/ResNet50/screenshot/f1-score', 0.36152219873150104), ('val/ResNet50/unknown/f1-score', 0.1893719806763285)]
---train finished---
Trying to save to /tmp/tmpkuw_hf01/model
Too long checkpoint name: ResNet50_64_[0.3, 0.2, 0.2, 0.3]_[3, 1]_1.0_9.999999999999999e-05_[1.00600004196167, 1.079699993133545, 1.0401999950408936, 1.2753000259399414]_Adamax_2_1_100.0 not saved
Done
ResNet50 Loaded!
{'batch_size': 64,
 'class_ratio': [0.3, 0.2, 0.2, 0.3],
 'epoch': [3, 1],
 'gamma': 0.1,
 'learning_rate': 1e-06,
 'loss_cls_weight': tensor([1.0060, 1.0797, 1.0402, 1.2753]),
 'optimizer': 'Adamax',
 'step_size': 2,
 'transforms': [2,
                Compose(
    RandomAffine(degrees=(0, 0), scale=(0.75, 1.25))
    RandomPerspective(p=0.4)
    RandomHorizontalFlip(p=0.5)
    ToTensor()
    Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])
)],
 'weight_decay': 0}
Dataloader constructed!
Epoch: 0, batch loss: 1.38584 Loss Sum: 361.36824, accuracy : 0.25316, val loss: 28.59235, val accuracy: 0.29349
Final : 0.14633163851758896 [('val/ResNet50/monotone/f1-score', 0.1364452423698384), ('val/ResNet50/screenshot/f1-score', 0.04745762711864407), ('val/ResNet50/unknown/f1-score', 0.4838940586972082)]
Epoch: 1, batch loss: 1.39261 Loss Sum: 353.40352, accuracy : 0.28438, val loss: 27.59106, val accuracy: 0.39310
Final : 0.13978624900229608 [('val/ResNet50/monotone/f1-score', 0.15999999999999998), ('val/ResNet50/screenshot/f1-score', 0.02888086642599278), ('val/ResNet50/unknown/f1-score', 0.5911029859841561)]
Epoch: 2, batch loss: 1.35380 Loss Sum: 349.29882, accuracy : 0.30209, val loss: 27.46646, val accuracy: 0.40690
Final : 0.16961694297436633 [('val/ResNet50/monotone/f1-score', 0.15916955017301035), ('val/ResNet50/screenshot/f1-score', 0.05017921146953405), ('val/ResNet50/unknown/f1-score', 0.6109756097560974)]
Epoch: 3, batch loss: 1.34098 Loss Sum: 345.75271, accuracy : 0.31828, val loss: 27.13493, val accuracy: 0.42222
Final : 0.2238036719529319 [('val/ResNet50/monotone/f1-score', 0.2605633802816901), ('val/ResNet50/screenshot/f1-score', 0.07042253521126761), ('val/ResNet50/unknown/f1-score', 0.610909090909091)]
---train finished---
Trying to save to /tmp/tmp1kik8_2b/model
Too long checkpoint name: ResNet50_64_[0.3, 0.2, 0.2, 0.3]_[3, 1]_1.0_9.999999999999999e-05_[1.00600004196167, 1.079699993133545, 1.0401999950408936, 1.2753000259399414]_Adamax_2_2_0 not saved
Done
ResNet50 Loaded!
{'batch_size': 64,
 'class_ratio': [0.3, 0.2, 0.2, 0.3],
 'epoch': [3, 1],
 'gamma': 0.1,
 'learning_rate': 1e-06,
 'loss_cls_weight': tensor([1.0060, 1.0797, 1.0402, 1.2753]),
 'optimizer': 'Adamax',
 'step_size': 2,
 'transforms': [2,
                Compose(
    RandomAffine(degrees=(0, 0), scale=(0.75, 1.25))
    RandomPerspective(p=0.4)
    RandomHorizontalFlip(p=0.5)
    ToTensor()
    Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])
)],
 'weight_decay': 0.001}
Dataloader constructed!
Epoch: 0, batch loss: 1.35308 Loss Sum: 351.02634, accuracy : 0.28219, val loss: 27.39322, val accuracy: 0.37165
Final : 0.20593292794088594 [('val/ResNet50/monotone/f1-score', 0.1604696673189824), ('val/ResNet50/screenshot/f1-score', 0.09929078014184398), ('val/ResNet50/unknown/f1-score', 0.5481198215423837)]
Epoch: 1, batch loss: 1.28954 Loss Sum: 343.44379, accuracy : 0.31201, val loss: 26.47992, val accuracy: 0.48429
Final : 0.22464717654622268 [('val/ResNet50/monotone/f1-score', 0.21167883211678834), ('val/ResNet50/screenshot/f1-score', 0.08029197080291971), ('val/ResNet50/unknown/f1-score', 0.6670422535211267)]
Epoch: 2, batch loss: 1.32531 Loss Sum: 339.69141, accuracy : 0.32412, val loss: 26.37387, val accuracy: 0.47126
Final : 0.17565298039362165 [('val/ResNet50/monotone/f1-score', 0.18315018315018314), ('val/ResNet50/screenshot/f1-score', 0.0449438202247191), ('val/ResNet50/unknown/f1-score', 0.6583990980834273)]
Epoch: 3, batch loss: 1.27270 Loss Sum: 335.72016, accuracy : 0.33970, val loss: 26.05732, val accuracy: 0.50498
Final : 0.2832742338741217 [('val/ResNet50/monotone/f1-score', 0.26053639846743293), ('val/ResNet50/screenshot/f1-score', 0.12857142857142856), ('val/ResNet50/unknown/f1-score', 0.6785913918390163)]
---train finished---
Trying to save to /tmp/tmp2j5rrva6/model
Too long checkpoint name: ResNet50_64_[0.3, 0.2, 0.2, 0.3]_[3, 1]_1.0_9.999999999999999e-05_[1.00600004196167, 1.079699993133545, 1.0401999950408936, 1.2753000259399414]_Adamax_2_2_100.0 not saved
Done
ResNet50 Loaded!
{'batch_size': 64,
 'class_ratio': [0.3, 0.2, 0.2, 0.3],
 'epoch': [3, 1],
 'gamma': 0.1,
 'learning_rate': 1e-06,
 'loss_cls_weight': tensor([1.0060, 1.0797, 1.0402, 1.2753]),
 'optimizer': 'Adam',
 'step_size': 10,
 'transforms': [1,
                Compose(
    ColorJitter(brightness=None, contrast=None, saturation=[0.95, 1.05], hue=[-0.05, 0.05])
    RandomHorizontalFlip(p=0.5)
    RandomRotation(degrees=(-20, 20), resample=2, expand=False)
    ToTensor()
    Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])
)],
 'weight_decay': 0}
Dataloader constructed!
Epoch: 0, batch loss: 1.31690 Loss Sum: 354.38400, accuracy : 0.25931, val loss: 27.01606, val accuracy: 0.45287
Final : 0.08926587085437733 [('val/ResNet50/monotone/f1-score', 0.03478260869565217), ('val/ResNet50/screenshot/f1-score', 0.029850746268656716), ('val/ResNet50/unknown/f1-score', 0.6850763807285546)]
Epoch: 1, batch loss: 1.28359 Loss Sum: 344.96618, accuracy : 0.30039, val loss: 25.80475, val accuracy: 0.52184
Final : 0.0 [('val/ResNet50/monotone/f1-score', 0.0), ('val/ResNet50/screenshot/f1-score', 0.0373134328358209), ('val/ResNet50/unknown/f1-score', 0.7261009667024705)]
Epoch: 2, batch loss: 1.32721 Loss Sum: 338.69707, accuracy : 0.31323, val loss: 25.02121, val accuracy: 0.55096
Final : 0.07428173175584503 [('val/ResNet50/monotone/f1-score', 0.014814814814814815), ('val/ResNet50/screenshot/f1-score', 0.037037037037037035), ('val/ResNet50/unknown/f1-score', 0.7469879518072289)]
Epoch: 3, batch loss: 0.72768 Loss Sum: 257.88574, accuracy : 0.64630, val loss: 18.69929, val accuracy: 0.70575
Final : 0.8104909992225008 [('val/ResNet50/monotone/f1-score', 0.8476821192052979), ('val/ResNet50/screenshot/f1-score', 0.8278688524590164), ('val/ResNet50/unknown/f1-score', 0.7586649550706034)]
---train finished---
Trying to save to /tmp/tmpy76y5qv7/model
Too long checkpoint name: ResNet50_64_[0.3, 0.2, 0.2, 0.3]_[3, 1]_1.0_9.999999999999999e-05_[1.00600004196167, 1.079699993133545, 1.0401999950408936, 1.2753000259399414]_Adam_10_1_0 not saved
Done
ResNet50 Loaded!
{'batch_size': 64,
 'class_ratio': [0.3, 0.2, 0.2, 0.3],
 'epoch': [3, 1],
 'gamma': 0.1,
 'learning_rate': 1e-06,
 'loss_cls_weight': tensor([1.0060, 1.0797, 1.0402, 1.2753]),
 'optimizer': 'Adam',
 'step_size': 10,
 'transforms': [1,
                Compose(
    ColorJitter(brightness=None, contrast=None, saturation=[0.95, 1.05], hue=[-0.05, 0.05])
    RandomHorizontalFlip(p=0.5)
    RandomRotation(degrees=(-20, 20), resample=2, expand=False)
    ToTensor()
    Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])
)],
 'weight_decay': 0.001}
Dataloader constructed!
Epoch: 0, batch loss: 1.30390 Loss Sum: 347.94807, accuracy : 0.32443, val loss: 26.80251, val accuracy: 0.48123
Final : 0.11746746276578007 [('val/ResNet50/monotone/f1-score', 0.15714285714285714), ('val/ResNet50/screenshot/f1-score', 0.015267175572519083), ('val/ResNet50/unknown/f1-score', 0.6756152125279642)]
Epoch: 1, batch loss: 1.35861 Loss Sum: 338.68845, accuracy : 0.34457, val loss: 25.71517, val accuracy: 0.53716
Final : 0.10456325445252528 [('val/ResNet50/monotone/f1-score', 0.10465116279069768), ('val/ResNet50/screenshot/f1-score', 0.015151515151515152), ('val/ResNet50/unknown/f1-score', 0.7210031347962383)]
Epoch: 2, batch loss: 1.29166 Loss Sum: 331.93169, accuracy : 0.34883, val loss: 25.06179, val accuracy: 0.56398
Final : 0.08853028181955792 [('val/ResNet50/monotone/f1-score', 0.04054054054054054), ('val/ResNet50/screenshot/f1-score', 0.022988505747126436), ('val/ResNet50/unknown/f1-score', 0.744518103008669)]
Epoch: 3, batch loss: 0.65716 Loss Sum: 253.13873, accuracy : 0.65537, val loss: 18.71735, val accuracy: 0.68199
Final : 0.7738771884935123 [('val/ResNet50/monotone/f1-score', 0.7839506172839507), ('val/ResNet50/screenshot/f1-score', 0.7958333333333333), ('val/ResNet50/unknown/f1-score', 0.7428571428571429)]
---train finished---
Trying to save to /tmp/tmpdl0ii50n/model
Too long checkpoint name: ResNet50_64_[0.3, 0.2, 0.2, 0.3]_[3, 1]_1.0_9.999999999999999e-05_[1.00600004196167, 1.079699993133545, 1.0401999950408936, 1.2753000259399414]_Adam_10_1_100.0 not saved
Done
ResNet50 Loaded!
{'batch_size': 64,
 'class_ratio': [0.3, 0.2, 0.2, 0.3],
 'epoch': [3, 1],
 'gamma': 0.1,
 'learning_rate': 1e-06,
 'loss_cls_weight': tensor([1.0060, 1.0797, 1.0402, 1.2753]),
 'optimizer': 'Adam',
 'step_size': 10,
 'transforms': [2,
                Compose(
    RandomAffine(degrees=(0, 0), scale=(0.75, 1.25))
    RandomPerspective(p=0.4)
    RandomHorizontalFlip(p=0.5)
    ToTensor()
    Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])
)],
 'weight_decay': 0}
Dataloader constructed!
Epoch: 0, batch loss: 1.30999 Loss Sum: 352.95177, accuracy : 0.27842, val loss: 28.04702, val accuracy: 0.32567
Final : 0.18325057308903495 [('val/ResNet50/monotone/f1-score', 0.04), ('val/ResNet50/screenshot/f1-score', 0.42505592841163314), ('val/ResNet50/unknown/f1-score', 0.3619344773790951)]
Epoch: 1, batch loss: 1.37012 Loss Sum: 339.92976, accuracy : 0.33185, val loss: 26.39559, val accuracy: 0.41533
Final : 0.0 [('val/ResNet50/monotone/f1-score', 0.0), ('val/ResNet50/screenshot/f1-score', 0.3314285714285714), ('val/ResNet50/unknown/f1-score', 0.5610357583230579)]
Epoch: 2, batch loss: 1.30310 Loss Sum: 331.76660, accuracy : 0.33508, val loss: 25.55401, val accuracy: 0.45594
Final : 0.12052766119936247 [('val/ResNet50/monotone/f1-score', 0.01515151515151515), ('val/ResNet50/screenshot/f1-score', 0.18487394957983191), ('val/ResNet50/unknown/f1-score', 0.6250696378830084)]
Epoch: 3, batch loss: 0.79681 Loss Sum: 263.73245, accuracy : 0.65665, val loss: 19.54110, val accuracy: 0.67739
Final : 0.8017626103558122 [('val/ResNet50/monotone/f1-score', 0.8707482993197279), ('val/ResNet50/screenshot/f1-score', 0.809248554913295), ('val/ResNet50/unknown/f1-score', 0.7314132618888145)]
---train finished---
Trying to save to /tmp/tmpmhsgi_yc/model
Too long checkpoint name: ResNet50_64_[0.3, 0.2, 0.2, 0.3]_[3, 1]_1.0_9.999999999999999e-05_[1.00600004196167, 1.079699993133545, 1.0401999950408936, 1.2753000259399414]_Adam_10_2_0 not saved
Done
ResNet50 Loaded!
{'batch_size': 64,
 'class_ratio': [0.3, 0.2, 0.2, 0.3],
 'epoch': [3, 1],
 'gamma': 0.1,
 'learning_rate': 1e-06,
 'loss_cls_weight': tensor([1.0060, 1.0797, 1.0402, 1.2753]),
 'optimizer': 'Adam',
 'step_size': 10,
 'transforms': [2,
                Compose(
    RandomAffine(degrees=(0, 0), scale=(0.75, 1.25))
    RandomPerspective(p=0.4)
    RandomHorizontalFlip(p=0.5)
    ToTensor()
    Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])
)],
 'weight_decay': 0.001}
Dataloader constructed!
Epoch: 0, batch loss: 1.38682 Loss Sum: 367.78944, accuracy : 0.23777, val loss: 28.95055, val accuracy: 0.29042
Final : 0.25466002486309025 [('val/ResNet50/monotone/f1-score', 0.21846846846846846), ('val/ResNet50/screenshot/f1-score', 0.18808777429467083), ('val/ResNet50/unknown/f1-score', 0.4019138755980861)]
Epoch: 1, batch loss: 1.30145 Loss Sum: 350.68633, accuracy : 0.29144, val loss: 27.07248, val accuracy: 0.43755
Final : 0.26507156733125714 [('val/ResNet50/monotone/f1-score', 0.29464285714285715), ('val/ResNet50/screenshot/f1-score', 0.10204081632653061), ('val/ResNet50/unknown/f1-score', 0.6194690265486726)]
Epoch: 2, batch loss: 1.33891 Loss Sum: 340.34740, accuracy : 0.31500, val loss: 25.68256, val accuracy: 0.53487
Final : 0.33616894448222984 [('val/ResNet50/monotone/f1-score', 0.4085106382978724), ('val/ResNet50/screenshot/f1-score', 0.13013698630136988), ('val/ResNet50/unknown/f1-score', 0.7146092865232163)]
Epoch: 3, batch loss: 0.87944 Loss Sum: 266.08582, accuracy : 0.60717, val loss: 19.52345, val accuracy: 0.69195
Final : 0.7928908766201538 [('val/ResNet50/monotone/f1-score', 0.8075709779179809), ('val/ResNet50/screenshot/f1-score', 0.8277227722772277), ('val/ResNet50/unknown/f1-score', 0.7457180500658762)]
---train finished---
Trying to save to /tmp/tmp2n5xex1x/model
Too long checkpoint name: ResNet50_64_[0.3, 0.2, 0.2, 0.3]_[3, 1]_1.0_9.999999999999999e-05_[1.00600004196167, 1.079699993133545, 1.0401999950408936, 1.2753000259399414]_Adam_10_2_100.0 not saved
Done
ResNet50 Loaded!
{'batch_size': 64,
 'class_ratio': [0.3, 0.2, 0.2, 0.3],
 'epoch': [3, 1],
 'gamma': 0.1,
 'learning_rate': 1e-06,
 'loss_cls_weight': tensor([1.0060, 1.0797, 1.0402, 1.2753]),
 'optimizer': 'Adam',
 'step_size': 2,
 'transforms': [1,
                Compose(
    ColorJitter(brightness=None, contrast=None, saturation=[0.95, 1.05], hue=[-0.05, 0.05])
    RandomHorizontalFlip(p=0.5)
    RandomRotation(degrees=(-20, 20), resample=2, expand=False)
    ToTensor()
    Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])
)],
 'weight_decay': 0}
Dataloader constructed!
Epoch: 0, batch loss: 1.37164 Loss Sum: 362.41287, accuracy : 0.28700, val loss: 25.54709, val accuracy: 0.53870
Final : 0.367389552208021 [('val/ResNet50/monotone/f1-score', 0.2702702702702703), ('val/ResNet50/screenshot/f1-score', 0.27208480565371024), ('val/ResNet50/unknown/f1-score', 0.6743383199079402)]
Epoch: 1, batch loss: 1.33707 Loss Sum: 346.77966, accuracy : 0.32212, val loss: 24.68995, val accuracy: 0.64981
Final : 0.3028954693281303 [('val/ResNet50/monotone/f1-score', 0.20408163265306123), ('val/ResNet50/screenshot/f1-score', 0.17366946778711487), ('val/ResNet50/unknown/f1-score', 0.7840629611411708)]
Epoch: 2, batch loss: 1.36328 Loss Sum: 340.75119, accuracy : 0.33684, val loss: 24.65315, val accuracy: 0.66054
Final : 0.33228160017963315 [('val/ResNet50/monotone/f1-score', 0.24598930481283424), ('val/ResNet50/screenshot/f1-score', 0.18911174785100288), ('val/ResNet50/unknown/f1-score', 0.7886497064579256)]
Epoch: 3, batch loss: 1.17042 Loss Sum: 330.49301, accuracy : 0.38480, val loss: 23.74109, val accuracy: 0.73333
Final : 0.5770478505929202 [('val/ResNet50/monotone/f1-score', 0.6390041493775933), ('val/ResNet50/screenshot/f1-score', 0.36413043478260865), ('val/ResNet50/unknown/f1-score', 0.8257998984255966)]
---train finished---
Trying to save to /tmp/tmpbbuyztvr/model
Too long checkpoint name: ResNet50_64_[0.3, 0.2, 0.2, 0.3]_[3, 1]_1.0_9.999999999999999e-05_[1.00600004196167, 1.079699993133545, 1.0401999950408936, 1.2753000259399414]_Adam_2_1_0 not saved
Done
ResNet50 Loaded!
{'batch_size': 64,
 'class_ratio': [0.3, 0.2, 0.2, 0.3],
 'epoch': [3, 1],
 'gamma': 0.1,
 'learning_rate': 1e-06,
 'loss_cls_weight': tensor([1.0060, 1.0797, 1.0402, 1.2753]),
 'optimizer': 'Adam',
 'step_size': 2,
 'transforms': [1,
                Compose(
    ColorJitter(brightness=None, contrast=None, saturation=[0.95, 1.05], hue=[-0.05, 0.05])
    RandomHorizontalFlip(p=0.5)
    RandomRotation(degrees=(-20, 20), resample=2, expand=False)
    ToTensor()
    Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])
)],
 'weight_decay': 0.001}
Dataloader constructed!
Epoch: 0, batch loss: 1.30434 Loss Sum: 351.13079, accuracy : 0.31262, val loss: 26.12305, val accuracy: 0.53870
Final : 0.0 [('val/ResNet50/monotone/f1-score', 0.0879120879120879), ('val/ResNet50/screenshot/f1-score', 0.0), ('val/ResNet50/unknown/f1-score', 0.724713242961418)]
Epoch: 1, batch loss: 1.38488 Loss Sum: 343.06454, accuracy : 0.32930, val loss: 25.51752, val accuracy: 0.53563
Final : 0.0 [('val/ResNet50/monotone/f1-score', 0.07843137254901962), ('val/ResNet50/screenshot/f1-score', 0.0), ('val/ResNet50/unknown/f1-score', 0.7211238293444328)]
Epoch: 2, batch loss: 1.29923 Loss Sum: 339.26466, accuracy : 0.33417, val loss: 25.66963, val accuracy: 0.54406
Final : 0.0 [('val/ResNet50/monotone/f1-score', 0.0625), ('val/ResNet50/screenshot/f1-score', 0.0), ('val/ResNet50/unknown/f1-score', 0.7305699481865285)]
Epoch: 3, batch loss: 1.22123 Loss Sum: 329.80165, accuracy : 0.35656, val loss: 24.62995, val accuracy: 0.57395
Final : 0.0 [('val/ResNet50/monotone/f1-score', 0.4375), ('val/ResNet50/screenshot/f1-score', 0.0), ('val/ResNet50/unknown/f1-score', 0.7391531625718766)]
---train finished---
Trying to save to /tmp/tmp7b4ptvvz/model
Too long checkpoint name: ResNet50_64_[0.3, 0.2, 0.2, 0.3]_[3, 1]_1.0_9.999999999999999e-05_[1.00600004196167, 1.079699993133545, 1.0401999950408936, 1.2753000259399414]_Adam_2_1_100.0 not saved
Done
ResNet50 Loaded!
{'batch_size': 64,
 'class_ratio': [0.3, 0.2, 0.2, 0.3],
 'epoch': [3, 1],
 'gamma': 0.1,
 'learning_rate': 1e-06,
 'loss_cls_weight': tensor([1.0060, 1.0797, 1.0402, 1.2753]),
 'optimizer': 'Adam',
 'step_size': 2,
 'transforms': [2,
                Compose(
    RandomAffine(degrees=(0, 0), scale=(0.75, 1.25))
    RandomPerspective(p=0.4)
    RandomHorizontalFlip(p=0.5)
    ToTensor()
    Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])
)],
 'weight_decay': 0}
Dataloader constructed!
Epoch: 0, batch loss: 1.39552 Loss Sum: 351.04038, accuracy : 0.28919, val loss: 26.06445, val accuracy: 0.46437
Final : 0.0 [('val/ResNet50/monotone/f1-score', 0.0), ('val/ResNet50/screenshot/f1-score', 0.020689655172413793), ('val/ResNet50/unknown/f1-score', 0.6991304347826088)]
Epoch: 1, batch loss: 1.39071 Loss Sum: 344.69248, accuracy : 0.29899, val loss: 25.22385, val accuracy: 0.52414
Final : 0.0 [('val/ResNet50/monotone/f1-score', 0.0), ('val/ResNet50/screenshot/f1-score', 0.021818181818181816), ('val/ResNet50/unknown/f1-score', 0.7442622950819672)]
Epoch: 2, batch loss: 1.35570 Loss Sum: 342.13297, accuracy : 0.30623, val loss: 25.17947, val accuracy: 0.51034
Final : 0.0 [('val/ResNet50/monotone/f1-score', 0.015384615384615384), ('val/ResNet50/screenshot/f1-score', 0.0), ('val/ResNet50/unknown/f1-score', 0.7279693486590039)]
Epoch: 3, batch loss: 1.30035 Loss Sum: 333.72611, accuracy : 0.31597, val loss: 24.45986, val accuracy: 0.52720
Final : 0.0 [('val/ResNet50/monotone/f1-score', 0.0), ('val/ResNet50/screenshot/f1-score', 0.10309278350515463), ('val/ResNet50/unknown/f1-score', 0.7343153300600108)]
---train finished---
Trying to save to /tmp/tmp1pec1d5h/model
Too long checkpoint name: ResNet50_64_[0.3, 0.2, 0.2, 0.3]_[3, 1]_1.0_9.999999999999999e-05_[1.00600004196167, 1.079699993133545, 1.0401999950408936, 1.2753000259399414]_Adam_2_2_0 not saved
Done
ResNet50 Loaded!
{'batch_size': 64,
 'class_ratio': [0.3, 0.2, 0.2, 0.3],
 'epoch': [3, 1],
 'gamma': 0.1,
 'learning_rate': 1e-06,
 'loss_cls_weight': tensor([1.0060, 1.0797, 1.0402, 1.2753]),
 'optimizer': 'Adam',
 'step_size': 2,
 'transforms': [2,
                Compose(
    RandomAffine(degrees=(0, 0), scale=(0.75, 1.25))
    RandomPerspective(p=0.4)
    RandomHorizontalFlip(p=0.5)
    ToTensor()
    Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])
)],
 'weight_decay': 0.001}
Dataloader constructed!
Epoch: 0, batch loss: 1.31416 Loss Sum: 355.65312, accuracy : 0.28773, val loss: 28.45659, val accuracy: 0.16015
Final : 0.0 [('val/ResNet50/monotone/f1-score', 0.0), ('val/ResNet50/screenshot/f1-score', 0.061855670103092786), ('val/ResNet50/unknown/f1-score', 0.33812341504649196)]
Epoch: 1, batch loss: 1.27648 Loss Sum: 346.13893, accuracy : 0.28189, val loss: 26.42778, val accuracy: 0.35709
Final : 0.0 [('val/ResNet50/monotone/f1-score', 0.0), ('val/ResNet50/screenshot/f1-score', 0.05090909090909091), ('val/ResNet50/unknown/f1-score', 0.5941747572815534)]
Epoch: 2, batch loss: 1.26846 Loss Sum: 341.94510, accuracy : 0.28968, val loss: 26.27447, val accuracy: 0.36245
Final : 0.0 [('val/ResNet50/monotone/f1-score', 0.0), ('val/ResNet50/screenshot/f1-score', 0.0498220640569395), ('val/ResNet50/unknown/f1-score', 0.5982028241335045)]
Epoch: 3, batch loss: 1.36968 Loss Sum: 333.49421, accuracy : 0.30775, val loss: 25.52181, val accuracy: 0.40077
Final : 0.212997480264902 [('val/ResNet50/monotone/f1-score', 0.07407407407407408), ('val/ResNet50/screenshot/f1-score', 0.2119205298013245), ('val/ResNet50/unknown/f1-score', 0.6155794806839772)]
---train finished---
Trying to save to /tmp/tmp34h2c80v/model
Too long checkpoint name: ResNet50_64_[0.3, 0.2, 0.2, 0.3]_[3, 1]_1.0_9.999999999999999e-05_[1.00600004196167, 1.079699993133545, 1.0401999950408936, 1.2753000259399414]_Adam_2_2_100.0 not saved
Done
ResNet50 Loaded!
{'batch_size': 64,
 'class_ratio': [0.3, 0.2, 0.2, 0.3],
 'epoch': [3, 1],
 'gamma': 0.1,
 'learning_rate': 1e-06,
 'loss_cls_weight': tensor([1.0060, 1.0797, 1.0402, 1.2753]),
 'optimizer': 'SGD',
 'step_size': 10,
 'transforms': [1,
                Compose(
    ColorJitter(brightness=None, contrast=None, saturation=[0.95, 1.05], hue=[-0.05, 0.05])
    RandomHorizontalFlip(p=0.5)
    RandomRotation(degrees=(-20, 20), resample=2, expand=False)
    ToTensor()
    Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])
)],
 'weight_decay': 0}
Dataloader constructed!
Epoch: 0, batch loss: 1.44463 Loss Sum: 372.02528, accuracy : 0.23314, val loss: 33.21485, val accuracy: 0.08889
Final : 0.0517368180152881 [('val/ResNet50/monotone/f1-score', 0.025423728813559317), ('val/ResNet50/screenshot/f1-score', 0.2305084745762712), ('val/ResNet50/unknown/f1-score', 0.023630504833512353)]
Epoch: 1, batch loss: 1.46244 Loss Sum: 368.87851, accuracy : 0.24075, val loss: 32.57161, val accuracy: 0.09732
Final : 0.0 [('val/ResNet50/monotone/f1-score', 0.0), ('val/ResNet50/screenshot/f1-score', 0.25821596244131456), ('val/ResNet50/unknown/f1-score', 0.0362087326943557)]
Epoch: 2, batch loss: 1.39646 Loss Sum: 366.20559, accuracy : 0.24897, val loss: 32.04555, val accuracy: 0.11724
Final : 0.0841818489095193 [('val/ResNet50/monotone/f1-score', 0.028037383177570093), ('val/ResNet50/screenshot/f1-score', 0.28428927680798005), ('val/ResNet50/unknown/f1-score', 0.07484407484407486)]
Epoch: 3, batch loss: 1.40207 Loss Sum: 363.37341, accuracy : 0.26022, val loss: 31.53526, val accuracy: 0.11724
Final : 0.09206608205530656 [('val/ResNet50/monotone/f1-score', 0.03571428571428572), ('val/ResNet50/screenshot/f1-score', 0.27715355805243447), ('val/ResNet50/unknown/f1-score', 0.0788381742738589)]
---train finished---
Trying to save to /tmp/tmp2e2yh53f/model
Too long checkpoint name: ResNet50_64_[0.3, 0.2, 0.2, 0.3]_[3, 1]_1.0_9.999999999999999e-05_[1.00600004196167, 1.079699993133545, 1.0401999950408936, 1.2753000259399414]_SGD_10_1_0 not saved
Done
ResNet50 Loaded!
{'batch_size': 64,
 'class_ratio': [0.3, 0.2, 0.2, 0.3],
 'epoch': [3, 1],
 'gamma': 0.1,
 'learning_rate': 1e-06,
 'loss_cls_weight': tensor([1.0060, 1.0797, 1.0402, 1.2753]),
 'optimizer': 'SGD',
 'step_size': 10,
 'transforms': [1,
                Compose(
    ColorJitter(brightness=None, contrast=None, saturation=[0.95, 1.05], hue=[-0.05, 0.05])
    RandomHorizontalFlip(p=0.5)
    RandomRotation(degrees=(-20, 20), resample=2, expand=False)
    ToTensor()
    Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])
)],
 'weight_decay': 0.001}
Dataloader constructed!
Epoch: 0, batch loss: 1.35301 Loss Sum: 340.41133, accuracy : 0.33453, val loss: 23.63701, val accuracy: 0.68352
Final : 0.0 [('val/ResNet50/monotone/f1-score', 0.0), ('val/ResNet50/screenshot/f1-score', 0.33170731707317075), ('val/ResNet50/unknown/f1-score', 0.8039024390243903)]
Epoch: 1, batch loss: 1.32208 Loss Sum: 340.00255, accuracy : 0.33264, val loss: 23.62402, val accuracy: 0.67739
Final : 0.1963003083271767 [('val/ResNet50/monotone/f1-score', 0.02941176470588235), ('val/ResNet50/screenshot/f1-score', 0.3219512195121951), ('val/ResNet50/unknown/f1-score', 0.7988252569750368)]
Epoch: 2, batch loss: 1.25399 Loss Sum: 339.48353, accuracy : 0.33538, val loss: 23.60881, val accuracy: 0.66820
Final : 0.0 [('val/ResNet50/monotone/f1-score', 0.0), ('val/ResNet50/screenshot/f1-score', 0.30024213075060535), ('val/ResNet50/unknown/f1-score', 0.7925636007827788)]
Epoch: 3, batch loss: 1.37134 Loss Sum: 338.64911, accuracy : 0.33739, val loss: 23.67954, val accuracy: 0.68736
Final : 0.0 [('val/ResNet50/monotone/f1-score', 0.0), ('val/ResNet50/screenshot/f1-score', 0.3350253807106599), ('val/ResNet50/unknown/f1-score', 0.8095470043838284)]
---train finished---
Trying to save to /tmp/tmpu_iory3a/model
Too long checkpoint name: ResNet50_64_[0.3, 0.2, 0.2, 0.3]_[3, 1]_1.0_9.999999999999999e-05_[1.00600004196167, 1.079699993133545, 1.0401999950408936, 1.2753000259399414]_SGD_10_1_100.0 not saved
Done
ResNet50 Loaded!
{'batch_size': 64,
 'class_ratio': [0.3, 0.2, 0.2, 0.3],
 'epoch': [3, 1],
 'gamma': 0.1,
 'learning_rate': 1e-06,
 'loss_cls_weight': tensor([1.0060, 1.0797, 1.0402, 1.2753]),
 'optimizer': 'SGD',
 'step_size': 10,
 'transforms': [2,
                Compose(
    RandomAffine(degrees=(0, 0), scale=(0.75, 1.25))
    RandomPerspective(p=0.4)
    RandomHorizontalFlip(p=0.5)
    ToTensor()
    Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])
)],
 'weight_decay': 0}
Dataloader constructed!
Epoch: 0, batch loss: 1.25622 Loss Sum: 335.54572, accuracy : 0.33465, val loss: 23.31919, val accuracy: 0.60077
Final : 0.11595215514843234 [('val/ResNet50/monotone/f1-score', 0.13043478260869565), ('val/ResNet50/screenshot/f1-score', 0.015384615384615385), ('val/ResNet50/unknown/f1-score', 0.7768844221105528)]
Epoch: 1, batch loss: 1.20062 Loss Sum: 311.97824, accuracy : 0.36514, val loss: 23.50517, val accuracy: 0.54330
Final : 0.39518738271057435 [('val/ResNet50/monotone/f1-score', 0.36477987421383645), ('val/ResNet50/screenshot/f1-score', 0.23411371237458192), ('val/ResNet50/unknown/f1-score', 0.7226890756302521)]
Epoch: 2, batch loss: 1.15568 Loss Sum: 292.38274, accuracy : 0.47760, val loss: 22.61956, val accuracy: 0.61456
Final : 0.5863592870676413 [('val/ResNet50/monotone/f1-score', 0.7177033492822967), ('val/ResNet50/screenshot/f1-score', 0.3780487804878049), ('val/ResNet50/unknown/f1-score', 0.7430167597765364)]
Epoch: 3, batch loss: 1.00387 Loss Sum: 272.26745, accuracy : 0.58599, val loss: 21.45363, val accuracy: 0.65287
Final : 0.7299002303126012 [('val/ResNet50/monotone/f1-score', 0.8605577689243028), ('val/ResNet50/screenshot/f1-score', 0.6046511627906977), ('val/ResNet50/unknown/f1-score', 0.7473182359952324)]
---train finished---
Trying to save to /tmp/tmpxkuchzbt/model
Too long checkpoint name: ResNet50_64_[0.3, 0.2, 0.2, 0.3]_[3, 1]_1.0_9.999999999999999e-05_[1.00600004196167, 1.079699993133545, 1.0401999950408936, 1.2753000259399414]_SGD_10_2_0 not saved
Done
ResNet50 Loaded!
{'batch_size': 64,
 'class_ratio': [0.3, 0.2, 0.2, 0.3],
 'epoch': [3, 1],
 'gamma': 0.1,
 'learning_rate': 1e-06,
 'loss_cls_weight': tensor([1.0060, 1.0797, 1.0402, 1.2753]),
 'optimizer': 'SGD',
 'step_size': 10,
 'transforms': [2,
                Compose(
    RandomAffine(degrees=(0, 0), scale=(0.75, 1.25))
    RandomPerspective(p=0.4)
    RandomHorizontalFlip(p=0.5)
    ToTensor()
    Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])
)],
 'weight_decay': 0.001}
Dataloader constructed!
Epoch: 0, batch loss: 1.25554 Loss Sum: 353.59564, accuracy : 0.26734, val loss: 23.59142, val accuracy: 0.63525
Final : 0.0 [('val/ResNet50/monotone/f1-score', 0.0), ('val/ResNet50/screenshot/f1-score', 0.007751937984496124), ('val/ResNet50/unknown/f1-score', 0.7938638542665388)]
Epoch: 1, batch loss: 1.19907 Loss Sum: 325.63152, accuracy : 0.31226, val loss: 23.54882, val accuracy: 0.57088
Final : 0.22000771610130704 [('val/ResNet50/monotone/f1-score', 0.07462686567164178), ('val/ResNet50/screenshot/f1-score', 0.1901639344262295), ('val/ResNet50/unknown/f1-score', 0.7503957783641162)]
Epoch: 2, batch loss: 1.17157 Loss Sum: 304.09161, accuracy : 0.40640, val loss: 22.56341, val accuracy: 0.63065
Final : 0.5360796672769019 [('val/ResNet50/monotone/f1-score', 0.46428571428571425), ('val/ResNet50/screenshot/f1-score', 0.4347826086956521), ('val/ResNet50/unknown/f1-score', 0.7631862217438107)]
Epoch: 3, batch loss: 1.06249 Loss Sum: 282.60281, accuracy : 0.53785, val loss: 21.64462, val accuracy: 0.67893
Final : 0.7341182389319287 [('val/ResNet50/monotone/f1-score', 0.8326180257510729), ('val/ResNet50/screenshot/f1-score', 0.6131386861313868), ('val/ResNet50/unknown/f1-score', 0.7749853886616014)]
---train finished---
Trying to save to /tmp/tmp937idslg/model
Too long checkpoint name: ResNet50_64_[0.3, 0.2, 0.2, 0.3]_[3, 1]_1.0_9.999999999999999e-05_[1.00600004196167, 1.079699993133545, 1.0401999950408936, 1.2753000259399414]_SGD_10_2_100.0 not saved
Done
ResNet50 Loaded!
{'batch_size': 64,
 'class_ratio': [0.3, 0.2, 0.2, 0.3],
 'epoch': [3, 1],
 'gamma': 0.1,
 'learning_rate': 1e-06,
 'loss_cls_weight': tensor([1.0060, 1.0797, 1.0402, 1.2753]),
 'optimizer': 'SGD',
 'step_size': 2,
 'transforms': [1,
                Compose(
    ColorJitter(brightness=None, contrast=None, saturation=[0.95, 1.05], hue=[-0.05, 0.05])
    RandomHorizontalFlip(p=0.5)
    RandomRotation(degrees=(-20, 20), resample=2, expand=False)
    ToTensor()
    Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])
)],
 'weight_decay': 0}
Dataloader constructed!
Epoch: 0, batch loss: 1.38079 Loss Sum: 362.81790, accuracy : 0.28402, val loss: 26.76288, val accuracy: 0.49808
Final : 0.14198533437817398 [('val/ResNet50/monotone/f1-score', 0.3111888111888112), ('val/ResNet50/screenshot/f1-score', 0.013937282229965157), ('val/ResNet50/unknown/f1-score', 0.6599763872491144)]
Epoch: 1, batch loss: 1.34512 Loss Sum: 353.52323, accuracy : 0.32065, val loss: 26.00255, val accuracy: 0.57625
Final : 0.1498738469836598 [('val/ResNet50/monotone/f1-score', 0.33333333333333337), ('val/ResNet50/screenshot/f1-score', 0.013745704467353953), ('val/ResNet50/unknown/f1-score', 0.7347368421052631)]
Epoch: 2, batch loss: 1.32084 Loss Sum: 349.97588, accuracy : 0.31986, val loss: 25.97016, val accuracy: 0.58927
Final : 0.0 [('val/ResNet50/monotone/f1-score', 0.35135135135135137), ('val/ResNet50/screenshot/f1-score', 0.0), ('val/ResNet50/unknown/f1-score', 0.7472642001042209)]
Epoch: 3, batch loss: 1.34900 Loss Sum: 349.10016, accuracy : 0.32199, val loss: 25.96831, val accuracy: 0.58851
Final : 0.11352262124283627 [('val/ResNet50/monotone/f1-score', 0.275092936802974), ('val/ResNet50/screenshot/f1-score', 0.0070921985815602835), ('val/ResNet50/unknown/f1-score', 0.7498715973292244)]
---train finished---
Trying to save to /tmp/tmpnx_c2cz2/model
Too long checkpoint name: ResNet50_64_[0.3, 0.2, 0.2, 0.3]_[3, 1]_1.0_9.999999999999999e-05_[1.00600004196167, 1.079699993133545, 1.0401999950408936, 1.2753000259399414]_SGD_2_1_0 not saved
Done
ResNet50 Loaded!
{'batch_size': 64,
 'class_ratio': [0.3, 0.2, 0.2, 0.3],
 'epoch': [3, 1],
 'gamma': 0.1,
 'learning_rate': 1e-06,
 'loss_cls_weight': tensor([1.0060, 1.0797, 1.0402, 1.2753]),
 'optimizer': 'SGD',
 'step_size': 2,
 'transforms': [1,
                Compose(
    ColorJitter(brightness=None, contrast=None, saturation=[0.95, 1.05], hue=[-0.05, 0.05])
    RandomHorizontalFlip(p=0.5)
    RandomRotation(degrees=(-20, 20), resample=2, expand=False)
    ToTensor()
    Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])
)],
 'weight_decay': 0.001}
Dataloader constructed!
Epoch: 0, batch loss: 1.42566 Loss Sum: 370.21603, accuracy : 0.22864, val loss: 24.22401, val accuracy: 0.60690
Final : 0.0 [('val/ResNet50/monotone/f1-score', 0.0), ('val/ResNet50/screenshot/f1-score', 0.0), ('val/ResNet50/unknown/f1-score', 0.7730600292825769)]
Epoch: 1, batch loss: 1.20311 Loss Sum: 327.33424, accuracy : 0.32917, val loss: 24.03507, val accuracy: 0.53257
Final : 0.14770405548205354 [('val/ResNet50/monotone/f1-score', 0.07407407407407408), ('val/ResNet50/screenshot/f1-score', 0.06015037593984962), ('val/ResNet50/unknown/f1-score', 0.7232237539766703)]
Epoch: 2, batch loss: 1.25092 Loss Sum: 311.74872, accuracy : 0.37299, val loss: 23.86144, val accuracy: 0.54253
Final : 0.22524859404284495 [('val/ResNet50/monotone/f1-score', 0.14388489208633096), ('val/ResNet50/screenshot/f1-score', 0.1094890510948905), ('val/ResNet50/unknown/f1-score', 0.7254381306425917)]
Epoch: 3, batch loss: 1.18997 Loss Sum: 308.89802, accuracy : 0.38553, val loss: 23.80331, val accuracy: 0.54559
Final : 0.23644530100394257 [('val/ResNet50/monotone/f1-score', 0.11594202898550723), ('val/ResNet50/screenshot/f1-score', 0.15714285714285714), ('val/ResNet50/unknown/f1-score', 0.7255319148936171)]
---train finished---
Trying to save to /tmp/tmpojy6orgb/model
Too long checkpoint name: ResNet50_64_[0.3, 0.2, 0.2, 0.3]_[3, 1]_1.0_9.999999999999999e-05_[1.00600004196167, 1.079699993133545, 1.0401999950408936, 1.2753000259399414]_SGD_2_1_100.0 not saved
Done
ResNet50 Loaded!
{'batch_size': 64,
 'class_ratio': [0.3, 0.2, 0.2, 0.3],
 'epoch': [3, 1],
 'gamma': 0.1,
 'learning_rate': 1e-06,
 'loss_cls_weight': tensor([1.0060, 1.0797, 1.0402, 1.2753]),
 'optimizer': 'SGD',
 'step_size': 2,
 'transforms': [2,
                Compose(
    RandomAffine(degrees=(0, 0), scale=(0.75, 1.25))
    RandomPerspective(p=0.4)
    RandomHorizontalFlip(p=0.5)
    ToTensor()
    Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])
)],
 'weight_decay': 0}
Dataloader constructed!
Epoch: 0, batch loss: 1.49063 Loss Sum: 378.14562, accuracy : 0.16590, val loss: 31.62373, val accuracy: 0.11571
Final : 0.10486870109833173 [('val/ResNet50/monotone/f1-score', 0.11864406779661017), ('val/ResNet50/screenshot/f1-score', 0.06872852233676975), ('val/ResNet50/unknown/f1-score', 0.14143426294820716)]
Epoch: 1, batch loss: 1.51713 Loss Sum: 376.58193, accuracy : 0.16431, val loss: 31.38403, val accuracy: 0.13563
Final : 0.08843019998094692 [('val/ResNet50/monotone/f1-score', 0.13155555555555554), ('val/ResNet50/screenshot/f1-score', 0.0273972602739726), ('val/ResNet50/unknown/f1-score', 0.19186046511627908)]
Epoch: 2, batch loss: 1.45207 Loss Sum: 375.17492, accuracy : 0.16669, val loss: 31.41312, val accuracy: 0.11801
Final : 0.10121675884205866 [('val/ResNet50/monotone/f1-score', 0.09691629955947137), ('val/ResNet50/screenshot/f1-score', 0.061224489795918366), ('val/ResNet50/unknown/f1-score', 0.17475728155339806)]
Epoch: 3, batch loss: 1.43070 Loss Sum: 375.08477, accuracy : 0.16821, val loss: 31.31997, val accuracy: 0.12950
Final : 0.11285178698200773 [('val/ResNet50/monotone/f1-score', 0.11473962930273611), ('val/ResNet50/screenshot/f1-score', 0.0684931506849315), ('val/ResNet50/unknown/f1-score', 0.18287937743190663)]
---train finished---
Trying to save to /tmp/tmpx494jc3o/model
Too long checkpoint name: ResNet50_64_[0.3, 0.2, 0.2, 0.3]_[3, 1]_1.0_9.999999999999999e-05_[1.00600004196167, 1.079699993133545, 1.0401999950408936, 1.2753000259399414]_SGD_2_2_0 not saved
Done
ResNet50 Loaded!
{'batch_size': 64,
 'class_ratio': [0.3, 0.2, 0.2, 0.3],
 'epoch': [3, 1],
 'gamma': 0.1,
 'learning_rate': 1e-06,
 'loss_cls_weight': tensor([1.0060, 1.0797, 1.0402, 1.2753]),
 'optimizer': 'SGD',
 'step_size': 2,
 'transforms': [2,
                Compose(
    RandomAffine(degrees=(0, 0), scale=(0.75, 1.25))
    RandomPerspective(p=0.4)
    RandomHorizontalFlip(p=0.5)
    ToTensor()
    Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])
)],
 'weight_decay': 0.001}
Dataloader constructed!
Epoch: 0, batch loss: 1.40401 Loss Sum: 358.72878, accuracy : 0.26777, val loss: 30.60784, val accuracy: 0.20766
Final : 0.24426574719782163 [('val/ResNet50/monotone/f1-score', 0.43137254901960786), ('val/ResNet50/screenshot/f1-score', 0.31064237775647163), ('val/ResNet50/unknown/f1-score', 0.10876132930513596)]
Epoch: 1, batch loss: 1.35020 Loss Sum: 356.41864, accuracy : 0.27039, val loss: 30.34332, val accuracy: 0.20613
Final : 0.2554826698976339 [('val/ResNet50/monotone/f1-score', 0.40160642570281124), ('val/ResNet50/screenshot/f1-score', 0.2943548387096774), ('val/ResNet50/unknown/f1-score', 0.14106280193236714)]
Epoch: 2, batch loss: 1.38610 Loss Sum: 355.19799, accuracy : 0.26850, val loss: 30.23041, val accuracy: 0.21762
Final : 0.2763195574051479 [('val/ResNet50/monotone/f1-score', 0.42519685039370075), ('val/ResNet50/screenshot/f1-score', 0.29102167182662536), ('val/ResNet50/unknown/f1-score', 0.17049808429118773)]
Epoch: 3, batch loss: 1.34431 Loss Sum: 354.37014, accuracy : 0.27392, val loss: 30.16983, val accuracy: 0.20153
Final : 0.25481438188094035 [('val/ResNet50/monotone/f1-score', 0.42448979591836733), ('val/ResNet50/screenshot/f1-score', 0.28950050968399593), ('val/ResNet50/unknown/f1-score', 0.13463414634146342)]
---train finished---
Trying to save to /tmp/tmp3m9gpief/model
Too long checkpoint name: ResNet50_64_[0.3, 0.2, 0.2, 0.3]_[3, 1]_1.0_9.999999999999999e-05_[1.00600004196167, 1.079699993133545, 1.0401999950408936, 1.2753000259399414]_SGD_2_2_100.0 not saved
Done
ResNet50 Loaded!
{'batch_size': 64,
 'class_ratio': [0.3, 0.2, 0.2, 0.3],
 'epoch': [3, 1],
 'gamma': 0.1,
 'learning_rate': 1e-05,
 'loss_cls_weight': tensor([1., 1., 1., 1.]),
 'optimizer': 'Adamax',
 'step_size': 10,
 'transforms': [1,
                Compose(
    ColorJitter(brightness=None, contrast=None, saturation=[0.95, 1.05], hue=[-0.05, 0.05])
    RandomHorizontalFlip(p=0.5)
    RandomRotation(degrees=(-20, 20), resample=2, expand=False)
    ToTensor()
    Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])
)],
 'weight_decay': 0}
Dataloader constructed!
Epoch: 0, batch loss: 1.28241 Loss Sum: 344.84390, accuracy : 0.30946, val loss: 26.10168, val accuracy: 0.41456
Final : 0.22470306941641113 [('val/ResNet50/monotone/f1-score', 0.24675324675324675), ('val/ResNet50/screenshot/f1-score', 0.07220216606498195), ('val/ResNet50/unknown/f1-score', 0.63681592039801)]
Epoch: 1, batch loss: 1.18852 Loss Sum: 317.01943, accuracy : 0.39101, val loss: 24.94283, val accuracy: 0.45134
Final : 0.5380367365649376 [('val/ResNet50/monotone/f1-score', 0.6091370558375635), ('val/ResNet50/screenshot/f1-score', 0.4173913043478261), ('val/ResNet50/unknown/f1-score', 0.6126005361930296)]
Epoch: 2, batch loss: 1.13283 Loss Sum: 294.70014, accuracy : 0.53268, val loss: 24.06730, val accuracy: 0.50115
Final : 0.6702704319806728 [('val/ResNet50/monotone/f1-score', 0.8333333333333333), ('val/ResNet50/screenshot/f1-score', 0.6095717884130982), ('val/ResNet50/unknown/f1-score', 0.592797783933518)]
Epoch: 3, batch loss: 0.25373 Loss Sum: 128.55397, accuracy : 0.85449, val loss: 16.31630, val accuracy: 0.68352
Final : 0.8081086601574132 [('val/ResNet50/monotone/f1-score', 0.8205128205128205), ('val/ResNet50/screenshot/f1-score', 0.8913857677902621), ('val/ResNet50/unknown/f1-score', 0.7215363511659809)]
---train finished---
Trying to save to /tmp/tmpfp5ilwbg/model
Too long checkpoint name: ResNet50_64_[0.3, 0.2, 0.2, 0.3]_[3, 1]_1.0_0.001_[1.0, 1.0, 1.0, 1.0]_Adamax_10_1_0 not saved
Done
ResNet50 Loaded!
{'batch_size': 64,
 'class_ratio': [0.3, 0.2, 0.2, 0.3],
 'epoch': [3, 1],
 'gamma': 0.1,
 'learning_rate': 1e-05,
 'loss_cls_weight': tensor([1., 1., 1., 1.]),
 'optimizer': 'Adamax',
 'step_size': 10,
 'transforms': [1,
                Compose(
    ColorJitter(brightness=None, contrast=None, saturation=[0.95, 1.05], hue=[-0.05, 0.05])
    RandomHorizontalFlip(p=0.5)
    RandomRotation(degrees=(-20, 20), resample=2, expand=False)
    ToTensor()
    Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])
)],
 'weight_decay': 0.001}
Dataloader constructed!
Epoch: 0, batch loss: 1.33400 Loss Sum: 350.44683, accuracy : 0.28542, val loss: 26.84290, val accuracy: 0.35172
Final : 0.1493981929155326 [('val/ResNet50/monotone/f1-score', 0.0945945945945946), ('val/ResNet50/screenshot/f1-score', 0.058394160583941604), ('val/ResNet50/unknown/f1-score', 0.6036709721278043)]
Epoch: 1, batch loss: 1.22593 Loss Sum: 319.91065, accuracy : 0.39411, val loss: 25.27820, val accuracy: 0.42989
Final : 0.4188795740351188 [('val/ResNet50/monotone/f1-score', 0.384180790960452), ('val/ResNet50/screenshot/f1-score', 0.30573248407643316), ('val/ResNet50/unknown/f1-score', 0.6257348138471588)]
Epoch: 2, batch loss: 1.14154 Loss Sum: 296.71390, accuracy : 0.53012, val loss: 24.08202, val accuracy: 0.50575
Final : 0.6284510384897201 [('val/ResNet50/monotone/f1-score', 0.6204081632653061), ('val/ResNet50/screenshot/f1-score', 0.6469135802469135), ('val/ResNet50/unknown/f1-score', 0.6184300341296928)]
Epoch: 3, batch loss: 0.44351 Loss Sum: 127.56767, accuracy : 0.85741, val loss: 16.35028, val accuracy: 0.67203
Final : 0.8152563202906543 [('val/ResNet50/monotone/f1-score', 0.8431372549019608), ('val/ResNet50/screenshot/f1-score', 0.9118198874296435), ('val/ResNet50/unknown/f1-score', 0.7048150732728542)]
---train finished---
Trying to save to /tmp/tmpa1lzd_jr/model
Too long checkpoint name: ResNet50_64_[0.3, 0.2, 0.2, 0.3]_[3, 1]_1.0_0.001_[1.0, 1.0, 1.0, 1.0]_Adamax_10_1_100.0 not saved
Done
ResNet50 Loaded!
{'batch_size': 64,
 'class_ratio': [0.3, 0.2, 0.2, 0.3],
 'epoch': [3, 1],
 'gamma': 0.1,
 'learning_rate': 1e-05,
 'loss_cls_weight': tensor([1., 1., 1., 1.]),
 'optimizer': 'Adamax',
 'step_size': 10,
 'transforms': [2,
                Compose(
    RandomAffine(degrees=(0, 0), scale=(0.75, 1.25))
    RandomPerspective(p=0.4)
    RandomHorizontalFlip(p=0.5)
    ToTensor()
    Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])
)],
 'weight_decay': 0}
Dataloader constructed!
Epoch: 0, batch loss: 1.23621 Loss Sum: 332.43569, accuracy : 0.35741, val loss: 25.63076, val accuracy: 0.37088
Final : 0.28332775647636976 [('val/ResNet50/monotone/f1-score', 0.3333333333333333), ('val/ResNet50/screenshot/f1-score', 0.11604095563139934), ('val/ResNet50/unknown/f1-score', 0.5880000000000001)]
Epoch: 1, batch loss: 1.16477 Loss Sum: 308.13204, accuracy : 0.44194, val loss: 24.54038, val accuracy: 0.43142
Final : 0.5197052790999968 [('val/ResNet50/monotone/f1-score', 0.6387434554973822), ('val/ResNet50/screenshot/f1-score', 0.37037037037037035), ('val/ResNet50/unknown/f1-score', 0.593346911065852)]
Epoch: 2, batch loss: 1.05153 Loss Sum: 288.80943, accuracy : 0.55611, val loss: 23.74761, val accuracy: 0.49195
Final : 0.6565428986902851 [('val/ResNet50/monotone/f1-score', 0.776255707762557), ('val/ResNet50/screenshot/f1-score', 0.6015037593984962), ('val/ResNet50/unknown/f1-score', 0.6061026352288489)]
Epoch: 3, batch loss: 0.26290 Loss Sum: 136.18051, accuracy : 0.85273, val loss: 17.39684, val accuracy: 0.66973
Final : 0.8164805239358485 [('val/ResNet50/monotone/f1-score', 0.8686868686868687), ('val/ResNet50/screenshot/f1-score', 0.8884758364312267), ('val/ResNet50/unknown/f1-score', 0.7052264808362371)]
---train finished---
Trying to save to /tmp/tmpbxpu538p/model
Too long checkpoint name: ResNet50_64_[0.3, 0.2, 0.2, 0.3]_[3, 1]_1.0_0.001_[1.0, 1.0, 1.0, 1.0]_Adamax_10_2_0 not saved
Done
ResNet50 Loaded!
{'batch_size': 64,
 'class_ratio': [0.3, 0.2, 0.2, 0.3],
 'epoch': [3, 1],
 'gamma': 0.1,
 'learning_rate': 1e-05,
 'loss_cls_weight': tensor([1., 1., 1., 1.]),
 'optimizer': 'Adamax',
 'step_size': 10,
 'transforms': [2,
                Compose(
    RandomAffine(degrees=(0, 0), scale=(0.75, 1.25))
    RandomPerspective(p=0.4)
    RandomHorizontalFlip(p=0.5)
    ToTensor()
    Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])
)],
 'weight_decay': 0.001}
Dataloader constructed!
Epoch: 0, batch loss: 1.28084 Loss Sum: 342.35875, accuracy : 0.31560, val loss: 25.93280, val accuracy: 0.39310
Final : 0.0 [('val/ResNet50/monotone/f1-score', 0.0), ('val/ResNet50/screenshot/f1-score', 0.24918032786885247), ('val/ResNet50/unknown/f1-score', 0.5941213258286429)]
Epoch: 1, batch loss: 1.17884 Loss Sum: 317.93174, accuracy : 0.40476, val loss: 25.08282, val accuracy: 0.42682
Final : 0.36947694804585146 [('val/ResNet50/monotone/f1-score', 0.14388489208633096), ('val/ResNet50/screenshot/f1-score', 0.6089108910891089), ('val/ResNet50/unknown/f1-score', 0.5756958587915818)]
Epoch: 2, batch loss: 1.11369 Loss Sum: 297.66349, accuracy : 0.51235, val loss: 24.17244, val accuracy: 0.46360
Final : 0.6148777160735907 [('val/ResNet50/monotone/f1-score', 0.5913978494623656), ('val/ResNet50/screenshot/f1-score', 0.6968325791855203), ('val/ResNet50/unknown/f1-score', 0.5641025641025641)]
Epoch: 3, batch loss: 0.36752 Loss Sum: 137.08676, accuracy : 0.85108, val loss: 17.36880, val accuracy: 0.66207
Final : 0.8106311332665748 [('val/ResNet50/monotone/f1-score', 0.8561872909698997), ('val/ResNet50/screenshot/f1-score', 0.8913857677902621), ('val/ResNet50/unknown/f1-score', 0.6979677645409952)]
---train finished---
Trying to save to /tmp/tmpjevgima9/model
Too long checkpoint name: ResNet50_64_[0.3, 0.2, 0.2, 0.3]_[3, 1]_1.0_0.001_[1.0, 1.0, 1.0, 1.0]_Adamax_10_2_100.0 not saved
Done
ResNet50 Loaded!
{'batch_size': 64,
 'class_ratio': [0.3, 0.2, 0.2, 0.3],
 'epoch': [3, 1],
 'gamma': 0.1,
 'learning_rate': 1e-05,
 'loss_cls_weight': tensor([1., 1., 1., 1.]),
 'optimizer': 'Adamax',
 'step_size': 2,
 'transforms': [1,
                Compose(
    ColorJitter(brightness=None, contrast=None, saturation=[0.95, 1.05], hue=[-0.05, 0.05])
    RandomHorizontalFlip(p=0.5)
    RandomRotation(degrees=(-20, 20), resample=2, expand=False)
    ToTensor()
    Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])
)],
 'weight_decay': 0}
Dataloader constructed!
Epoch: 0, batch loss: 1.32503 Loss Sum: 351.07310, accuracy : 0.26929, val loss: 26.77697, val accuracy: 0.34866
Final : 0.1462128232789954 [('val/ResNet50/monotone/f1-score', 0.19178082191780824), ('val/ResNet50/screenshot/f1-score', 0.02952029520295203), ('val/ResNet50/unknown/f1-score', 0.5521162349968415)]
Epoch: 1, batch loss: 1.23309 Loss Sum: 323.38468, accuracy : 0.35120, val loss: 25.34730, val accuracy: 0.43065
Final : 0.4230542755031726 [('val/ResNet50/monotone/f1-score', 0.5303867403314917), ('val/ResNet50/screenshot/f1-score', 0.24161073825503354), ('val/ResNet50/unknown/f1-score', 0.5908529048207664)]
Epoch: 2, batch loss: 1.17038 Loss Sum: 310.33495, accuracy : 0.42539, val loss: 25.25386, val accuracy: 0.40996
Final : 0.460040484980666 [('val/ResNet50/monotone/f1-score', 0.6200000000000001), ('val/ResNet50/screenshot/f1-score', 0.2838709677419355), ('val/ResNet50/unknown/f1-score', 0.5531914893617021)]
Epoch: 3, batch loss: 0.93260 Loss Sum: 269.80623, accuracy : 0.64794, val loss: 21.87794, val accuracy: 0.54253
Final : 0.7179216722675655 [('val/ResNet50/monotone/f1-score', 0.8278145695364238), ('val/ResNet50/screenshot/f1-score', 0.755939524838013), ('val/ResNet50/unknown/f1-score', 0.591304347826087)]
---train finished---
Trying to save to /tmp/tmpmq0b5m0a/model
Too long checkpoint name: ResNet50_64_[0.3, 0.2, 0.2, 0.3]_[3, 1]_1.0_0.001_[1.0, 1.0, 1.0, 1.0]_Adamax_2_1_0 not saved
Done
ResNet50 Loaded!
{'batch_size': 64,
 'class_ratio': [0.3, 0.2, 0.2, 0.3],
 'epoch': [3, 1],
 'gamma': 0.1,
 'learning_rate': 1e-05,
 'loss_cls_weight': tensor([1., 1., 1., 1.]),
 'optimizer': 'Adamax',
 'step_size': 2,
 'transforms': [1,
                Compose(
    ColorJitter(brightness=None, contrast=None, saturation=[0.95, 1.05], hue=[-0.05, 0.05])
    RandomHorizontalFlip(p=0.5)
    RandomRotation(degrees=(-20, 20), resample=2, expand=False)
    ToTensor()
    Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])
)],
 'weight_decay': 0.001}
Dataloader constructed!
Epoch: 0, batch loss: 1.23052 Loss Sum: 347.39376, accuracy : 0.28554, val loss: 26.19180, val accuracy: 0.38851
Final : 0.0 [('val/ResNet50/monotone/f1-score', 0.0), ('val/ResNet50/screenshot/f1-score', 0.07220216606498195), ('val/ResNet50/unknown/f1-score', 0.6109403810694529)]
Epoch: 1, batch loss: 1.16759 Loss Sum: 319.98563, accuracy : 0.36088, val loss: 25.42518, val accuracy: 0.36092
Final : 0.36876819512142156 [('val/ResNet50/monotone/f1-score', 0.3431952662721893), ('val/ResNet50/screenshot/f1-score', 0.2736156351791531), ('val/ResNet50/unknown/f1-score', 0.5340453938584779)]
Epoch: 2, batch loss: 1.18482 Loss Sum: 306.52697, accuracy : 0.43081, val loss: 25.16575, val accuracy: 0.38084
Final : 0.4287877541025779 [('val/ResNet50/monotone/f1-score', 0.44571428571428573), ('val/ResNet50/screenshot/f1-score', 0.325), ('val/ResNet50/unknown/f1-score', 0.5442359249329759)]
Epoch: 3, batch loss: 0.94059 Loss Sum: 266.97010, accuracy : 0.65652, val loss: 21.89595, val accuracy: 0.53027
Final : 0.7154338058434598 [('val/ResNet50/monotone/f1-score', 0.8116883116883116), ('val/ResNet50/screenshot/f1-score', 0.8008474576271186), ('val/ResNet50/unknown/f1-score', 0.5633383010432191)]
---train finished---